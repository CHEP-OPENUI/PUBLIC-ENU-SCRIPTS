/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelApp.OfflineUtils)==="undefined"){SiebelJS.Namespace("SiebelApp.OfflineUtils");SiebelApp.OfflineUtils=(function(){var n=SiebelAppFacade.FacadeConstants;var w=SiebelApp.OfflineCacheConfig;var j=SiebelApp.Offlineconstants;var o=n.get("WEB_DB");var d=n.get("LOCAL_STORAGE");var a=window.localStorage;var q=SiebelApp.Utils;var g=SiebelApp.Constants;var b=j.get("ALL");var h=j.get("METADATA_EX");var m=j.get("LOG_EVT_METADATA_EX");var k=j.get("DATA_EX_BASIC");var s=j.get("LOG_EVT_DATA_EX_BASIC");var l=j.get("DATA_EX_DETAILED");var r=j.get("LOG_EVT_DATA_EX_DETAILED");var i=j.get("UPSYNC");var p=j.get("LOG_EVT_UPSYNC");var f=j.get("CLIENT_SYS");var c=j.get("LOG_EVT_CLIENT_SYS");var v=j.get("LOG_EVT_COMMON");var e=j.get("DM_LOG_CHAR_LIMIT");function t(){var x;y=function y(){return x};y.prototype=this;x=new y();x.constructor=y;return x}var u=new t();t.prototype.RefreshPage=function(){window.location.reload()};t.prototype.GetBrowserStorage=function(y){var x={};switch(y){case o:if(window.openDatabase){x=SiebelApp.WebDB}break;case d:x=SiebelApp.BrowserLocalStorage;break;default:if(window.openDatabase){x=SiebelApp.WebDB}else{x=SiebelApp.BrowserLocalStorage}break}return x};t.prototype.GetOfflineCacheConfig=function(B){var A={};A.dbName=w.get("OFFLINE_CACHE_DB_NAME");A.version=w.get("OFFLINE_CACHE_DB_VERSION");A.displayName=w.get("OFFLINE_CACHE_DB_DISP_NAME");A.maxSize=w.get("OFFLINE_CACHE_DB_MAXSIZE");A.tables=[w.get("REACTIVE_CACHE_TBL"),w.get("PRO_SYNCQUEUE_DB_TBL"),w.get("PRO_METADATASTORE_DB_TBL"),w.get("PRO_DB_PICKAPPLET_INFO_TBL"),w.get("PRO_DB_PICKFLD_MAP_TBL")];A.columns={};var y=w.get("REACTIVE_CACHE_TBL_COLS");A.columns[w.get("REACTIVE_CACHE_TBL")]=[];for(var E in y){if(y[E]){A.columns[w.get("REACTIVE_CACHE_TBL")].push(y[E])}}var D=w.get("PRO_SYNCQUEUE_DB_TBL_COLS");A.columns[w.get("PRO_SYNCQUEUE_DB_TBL")]=[];for(var x in D){if(D[x]){A.columns[w.get("PRO_SYNCQUEUE_DB_TBL")].push(D[x])}}var C=w.get("PRO_METADATASTORE_DB_TBL_COLS");var z="";A.columns[w.get("PRO_METADATASTORE_DB_TBL")]=[];for(z in C){if(C[z]){A.columns[w.get("PRO_METADATASTORE_DB_TBL")].push(C[z])}}C=w.get("PRO_DB_PICKAPPLET_INFO_TBL_COLS");A.columns[w.get("PRO_DB_PICKAPPLET_INFO_TBL")]=[];for(z in C){if(C[z]){A.columns[w.get("PRO_DB_PICKAPPLET_INFO_TBL")].push(C[z])}}C=w.get("PRO_DB_PICKFLD_MAP_TBL_COLS");A.columns[w.get("PRO_DB_PICKFLD_MAP_TBL")]=[];for(z in C){if(C[z]){A.columns[w.get("PRO_DB_PICKFLD_MAP_TBL")].push(C[z])}}return A};t.prototype.IsValidServerResponse=function(z){if(z){var x=z.indexOf("<!DOCTYPE");if(x===0){var y=z.indexOf("manifest");if(y===-1){return false}}return true}else{return false}};t.prototype.RemoveNonAlphaChars=function(x){x=x.replace(/\W/g,"");return x};t.prototype.eliminateDuplicates=function(y){var A,x=y.length;var z=[];var B={};for(A=0;A<x;A++){B[y[A]]=0}for(A in B){z.push(A)}return z};t.prototype.GetLogMsg=function(A,B){var z=SiebelApp.S_App.Model.GetDMLogMsg(A);if(typeof z!=="string"){return z}var x=0;if(B){x=B.length}if(x>1){B[0]=SiebelApp.S_App.Model.GetDMClassName(B[0]);B[1]=SiebelApp.S_App.Model.GetDMMethodName(B[1]);var y="";for(var C=0;C<x;C++){y="%"+(C+1);z=z.replace(y,B[C])}}return z};t.prototype.CcfLogEvent=function(B){var z=a.getItem("LogEvt");var D=B.length;if(!(D>=2)||!z){return}var x=B[0];var C=B[1];var F=false;if(q.IndexOf([z],b)!==-1){F=true}else{switch(x){case m:if(q.IndexOf([z],h)!==-1){F=true}break;case s:if(q.IndexOf([z],k)!==-1||q.IndexOf([z],l)!==-1){F=true}break;case r:if(q.IndexOf([z],l)!==-1){F=true}break;case p:if(q.IndexOf([z],i)!==-1){F=true}break;case c:if(q.IndexOf([z],f)!==-1){F=true}break;case v:F=true;break}}if(F){var y=[];var A={};A.c=C;B.splice(0,2);A.p=B;if(window.localStorage.getItem("AllLogs")){y=a.getItem("AllLogs");try{D=y.length;y=JSON.parse(y);if(D<e){y.push(A);a.setItem("AllLogs",JSON.stringify(y))}else{y=y.slice(3);y.push(A);a.setItem("AllLogs",JSON.stringify(y))}}catch(E){if(E==QUOTA_EXCEEDED_ERR){y.slice(3);y.push(A);a.setItem("AllLogs",JSON.stringify(y))}}}else{y.push(A);a.setItem("AllLogs",JSON.stringify(y))}}};t.prototype.GetPreference=function(B,A){var y=SiebelApp.S_App.NewPropertySet();y.SetProperty("Category",B);y.SetProperty("Name",A);y.SetProperty("Type","DM_LOG_EVTS");var E={};E.async=false;E.selfbusy=true;E.scope=this;E.opdecode=true;E.mask=true;var G=y.EncodeAsString();var D=CCFMiscUtil_CreatePropSet();var F=F||CCFMiscUtil_CreatePropSet();D.SetProperty(g.get("SWE_CMD_ARG"),g.get("SWE_CMD_INVOKE_METHOD_STR"));D.SetProperty(g.get("SWE_SERVICE"),"Web Engine UI Preferences");D.SetProperty(g.get("SWE_METHOD_STR"),"GetUserPreference");D.SetProperty(g.get("SWE_INPUT_PS"),G);SiebelApp.S_App.SetDefaultArgs(D);var z=q.EncodeToQueryString(D),C=new Date(),x=null;z=z+"&"+g.get("SWE_TIME_STAMP")+"="+C.getTime();x={url:SiebelApp.S_App.GetPageURL(),data:z.split(" ").join("%20"),type:"POST",async:false,contentType:"application/x-www-form-urlencoded",successfncallback:this.OnSuccessCallServer,errfncb:SiebelApp.S_App.OnFailureCallServer,context:{scope:SiebelApp.S_App,lp:E,outputPS:F,nPR:true}};SiebelApp.AjaxRequestMgr.Ajax(x);y=null};t.prototype.OnSuccessCallServer=function(A,x,D){var F=CCFMiscUtil_CreatePropSet();F.DecodeFromString(A);var z=F.GetProperty(g.get("SWE_RPC_PROP_RETURN_STATUS"));if(F.GetProperty("Status")!==g.get("SWE_RPC_PROP_STATUS_ERROR")){var B=F.GetChildCount();for(var y=0;y<B;y++){var C=F.GetChild(y);if(C!==null&&C.GetType()==="ResultSet"){var E=C.GetProperty("GetUserPreference");a.setItem("LogEvt",E)}}}else{F.SetPropertyStr(j.get("STATUS"),j.get("ACTION_RPC_COMPLETED"));A=F.EncodeAsString()}SiebelApp.S_App.OnSuccessCallServer.call(this,A,x,D)};t.prototype.Log=function(y){var x=false;if(IsOfflineModeEnabled()&&x){SiebelJS.Log(y+" "+SiebelApp.OfflineUtils.GetTS())}};t.prototype.GetRequestParam=function(y,A){var B="";var x=-1;x=y.indexOf(A);if(x!==-1){var z=y.substring(x,y.length);if(z.indexOf("&")===-1){z=z.substring(z.indexOf("=")+1,z.length)}else{z=z.substring(A.length,z.indexOf("&"))}B=z.replace(/%20/g," ")}return B};t.prototype.GetTS=function(){var y=new Date();var E=y.getMonth()+1;var x=y.getDate();var B=y.getFullYear();var D=("0"+E).slice(-2)+"/"+("0"+x).slice(-2)+"/"+B;var z=y.getHours();var C=y.getMinutes();var A=y.getSeconds();D+=" "+("0"+z).slice(-2)+":"+("0"+C).slice(-2)+":"+("0"+A).slice(-2)+" ";return D};t.prototype.ToTS=function(z,A){if(!z){return""}var y;if(A===true){var G=z.getTime()+(z.getTimezoneOffset()*60000);y=new Date(G)}else{y=z}var C=y.getMonth()+1;var F=y.getDate();var E=y.getFullYear();var D=("0"+C).slice(-2)+"/"+("0"+F).slice(-2)+"/"+E;var H=y.getHours();var x=y.getMinutes();var B=y.getSeconds();D+=" "+("0"+H).slice(-2)+":"+("0"+x).slice(-2)+":"+("0"+B).slice(-2);return D};t.prototype.UtcToLocal=function(x){if(!x){return null}var y=new Date(x+" UTC");return y};t.prototype.GetToday=function(){var y=new Date();var E=y.getMonth()+1;var x=y.getDate();var B=y.getFullYear();var D=E+"/"+x+"/"+B;var z=0;var C=0;var A=0;D+=" "+("0"+z).slice(-2)+":"+("0"+C).slice(-2)+":"+("0"+A).slice(-2)+" ";
return D};t.prototype.GetDate=function(){var y=new Date();var B=y.getMonth()+1;var x=y.getDate();var z=y.getFullYear();var A=B+"/"+x+"/"+z;return A};t.prototype.RTrim=function(x,y){if(x===undefined||y===undefined){return""}if(x.substring((x.length-y.length),(x.length))===y){x=x.substring(0,(x.length-(y.length)))}return x};t.prototype.StripQuotes=function(y){var x;x=y.charAt(0);if((x==='"'||x==="'")&&(y.length>1&&y.charAt(y.length-1)===x)){y=y.substring(1,(y.length-1))}return y};t.prototype.NotifyValueArray=function(C){var z=C;var B="";var y=C.length;for(var A=0;A<y;A++){var x=C[A].length;x=x.toString();B=B+x.concat("*",C[A])}return B};t.prototype.ProcessDPS=function(B,y,x,A,C){if(!A){A=x.length}for(var z=0;z<A;z++){var D=y.GetProperty(x[z]);if(!SiebelApp.Utils.IsEmpty(D)){if(C){B.SetPropertyStr(x[z],D)}else{B.SetPropertyStr(x[z],D);y.RemoveProperty(x[z])}}}};t.prototype.GetDate=function(){var y=new Date();var B=y.getMonth()+1;var x=y.getDate();var z=y.getFullYear();var A=B+"/"+x+"/"+z;return A};t.prototype.ConverttoUTCDate=function(D){var F;var A=+D.substring(0,2);var x=+D.substring(3,5);var C=+D.substring(6,10);var E=+D.substring(11,13);var y=+D.substring(14,16);var z=+D.substring(17,19);var B=D.substring(20,22);F=new SiebelApp.S_App.DatumUTCDateTimeObject();F.SetDateTime(C,A,x,E,y,z);return F};t.prototype.JsonRecordSet=function(x){var y=SiebelJS.Dependency("SiebelApp.Utils").DecodeFromQueryString(x);var B={};B.Request=x;B.RecordSet={};B.FieldValue=[];B.SweCommands={};var C;var A;for(var z=true;(prop=y.EnumProperties(z))!==null;z=false){if(prop.search("OF_")!==-1){C=prop.split("OF_")[1];A=unescape(y.GetPropertyAsStr(prop));B.RecordSet[C]=A;B.FieldValue.push([C,A])}else{B.SweCommands[prop]=unescape(y.GetPropertyAsStr(prop))}}return B};t.prototype.GetTempId=function(){var y=((new Date()).getTime());y=(y).toString(36);if(y.length>6){y=y.substring(y.length-6)}var z=(Math.round((Math.random()*46655))).toString(36);var x=(Math.round((Math.random()*46655))).toString(36);var A=(y.concat(":",z,x)).toUpperCase();return A};t.prototype.GetTempRowId=function(){var y=((new Date()).getTime());y=(y).toString(36);var x=Math.floor(Math.random()*5);if(y.length>6){y=y.substring(y.length-6);y=y.substring(0,x).concat(y.substring(x+1,6))}var z=(Math.round((Math.random()*46655))).toString(36);var A=(z.concat("-",y)).toUpperCase();return A};t.prototype.Truncate=function(y,x){if(!y){return""}y=String(y);return y.length>x?y.slice(0,x)+"...":y};t.prototype.TimerFactory=function(E,z){z=z||{};var y=z.interval||60*1000;var D=z.timeout||30*60*1000;var A=z.onTimeout||function(){};var B,G;function F(){if(G){return}G=setTimeout(function(){C();A()},D)}function x(){if(B){return}B=setInterval(E,y);if(G){clearTimeout(G)}F()}function C(){clearInterval(B);B=null;clearTimeout(G);G=null}x();return{start:x,stop:C,restart:function(){C();x()},isRunning:function(){return !!B}}};return u}())};