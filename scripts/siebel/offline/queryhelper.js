/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelApp.QueryHelper)==="undefined"){Namespace("SiebelApp.QueryHelper");SiebelApp.QueryHelper=(function(){var i=SiebelApp.Utils;function d(){var j;k=function k(){return j};k.prototype=this;j=new k();j.constructor=k;return j}var e=new d();var b;var f;var h;var g;var c;d.prototype.SetContext=function(j,k,l){b=j;g=k;c=l};d.prototype.GetContext=function(j){return b};d.prototype.GetValue=function(j){return g};d.prototype.DeleteContext=function(){b=""};d.prototype.EvaluateConstantNode=function(j){var k=j.value.replace(/['"]/g,"");return k};d.prototype.EvaluateConstantFunctionNode=function(j){var k="";switch(j.value.toUpperCase()){case"PARENTBCNAME":var l=SiebelApp.QueryHelper.GetContext();if(l){k=l.GetParentBusComp()?l.GetParentBusComp().GetName():""}break;case"TIMESTAMP":k=SiebelApp.OfflineUtils.GetTS();break;case"TODAY":k=new SiebelApp.S_App.DatumUTCDateTimeObject();k.SetToNow();break;case"LANGUAGE":k=SiebelApp.S_App.Model.GetLanguage();break;case"POSITIONID":k=SiebelApp.S_App.Model.GetPositionId();break;case"LOGINID":k=SiebelApp.S_App.Model.GetLoginId();break;case"LOGINNAME":k=SiebelApp.S_App.Model.GetLoginName();break}return k};d.prototype.EvaluateIdentifierNode=function(j){return j.value};d.prototype.EvaluateConstantNumberNode=function(j){var k=j.value.replace(/['"]/g,"");return +k};d.prototype.EvaluateFieldNameNode=function(u){var A=u.arguments;var l="";var k="";var t;for(var x=0;x<A.length;x++){l+=A[x].evaluate();k+=A[x].evaluate()+" "}var j=SiebelApp.QueryHelper.GetContext();var m;if(!c){m=j.GetWS()[j.GetActiveRow()]}else{m=c}var z="";var p="";t=m[l];try{z=j.GetFieldDefn(k.substring(0,k.length-1))}catch(n){return""}if(z!==null||z!==""){switch(z.DataType){case"1":p=i.IsEmpty(t)?"":t;break;case"2":p=i.IsEmpty(t)?"":t;break;case"3":p=new SiebelApp.S_App.DatumPhoneObject();p.SetAsString(t);break;case"4":p=i.IsEmpty(t)?"":t;break;case"5":p=i.IsEmpty(t)?"":t;break;case"6":p=i.IsEmpty(t)?"":t;break;case"7":break;case"8":p=new SiebelApp.S_App.DatumBoolObject();p.SetValue(t);break;case"9":if(i.IsEmpty(t)){p="";break}p=+t;break;case"10":if(i.IsEmpty(t)){p="";break}var D=+t.substring(0,2);var C=+t.substring(3,5);var q=+t.substring(6,10);p=new SiebelApp.S_App.DatumDateObject();p.SetDate(q,D,C);break;case"11":p=new SiebelApp.S_App.DatumTimeObject();var y=+t.substring(0,2);var w=+t.substring(3,5);var r=+t.substring(6,8);var o=(60*w+60*60*y+r);p.SetValue(o);break;case"12":break;case"13":if(i.IsEmpty(t)){p="";break}var D=+t.substring(0,2);var C=+t.substring(3,5);var q=+t.substring(6,10);var E=+t.substring(11,13);var v=+t.substring(14,16);var B=+t.substring(17,19);var s=t.substring(20,22);if(s.toUpperCase()==="PM"){E=E+12}p=new SiebelApp.S_App.DatumUTCDateTimeObject();p.SetDateTime(q,D,C,E,v,B);break;case"14":break;case"15":break;default:break}}return p};d.prototype.EvaluateUnaryNotNode=function(l){var k=l.evaluate();var j=k===true?false:true;return j};d.prototype.EvaluateUnaryIsNullNode=function(k){var j=k.evaluate();if(i.IsEmpty(j)){return true}return false};d.prototype.EvaluateIfNullNode=function(k){var m=k.args.parameters[0];var l=k.args.parameters[1];var j=m.evaluate();if(i.IsEmpty(j)){j=l.evaluate()}return j};d.prototype.EvaluateUnaryIsNotNullNode=function(k){var j=k.evaluate();if(i.IsEmpty(j)){return false}return true};d.prototype.EvaluateIIFNode=function(j){var m=j.args.parameters[0];var l=j.args.parameters[1];var k=j.args.parameters[2];if(m.evaluate()){return l.evaluate()}else{return k.evaluate()}};d.prototype.EvaluateRowIdToRowIdNumNode=function(k){var q=k.args.parameters[0].evaluate();if(typeof(q)=="object"){q=q.GetId()}var j=q.length;var p=0;var m=0;var o="";do{var n=q.charAt(m);var l=n.charCodeAt(0);if(!isNaN(parseInt(n))){if(n>=0&&n<=9){p=p*36+parseInt(n)}}else{if(l>="A".charCodeAt(0)&&l<"Z".charCodeAt(0)){p=p*36+parseInt((l-"A".charCodeAt(0)+10))}else{o+=p.toString();p=0;if(n){o+=n}}}m++}while(m<=j);return o};d.prototype.EvaluateParentFieldValueNode=function(j,k){return false};d.prototype.EvaluateFieldValueNode=function(j,k){return false};d.prototype.EvaluateLookupValueNode=function(j){var n=j.args.parameters[0].param;var m=j.args.parameters[1].param;var l=n.evaluate();var k=m.evaluate();return SiebelApp.S_App.Model.GetLovNameVal(k,l)};d.prototype.EvaluateLookupNameNode=function(j){var n=j.args.parameters[0].param;var m=j.args.parameters[1].param;var l=n.evaluate();var k=m.evaluate();return SiebelApp.S_App.Model.GetLovValName(k,l)};d.prototype.EvaluateIsNullNode=function(j){var m=j.args[0];var l=j.args[1];var k=m.evaluate();if(!i.IsEmpty(k)){return k}else{return l.evaluate()}};d.prototype.EvaluateLeftNode=function(j){var n=j.args[0];var m=j.args[1];var k=n.evaluate();var l=m.evaluate();return k.substring(0,l)};d.prototype.EvaluateRightNode=function(k){var n=k.args[0];var m=k.args[1];var l=n.evaluate();var j=m.evaluate();return l.substring(l.length-j)};d.prototype.EvaluateMidNode=function(j){var o=j.args[0];var n=j.args[1];var m=j.args[2];var l=o.evaluate();var p=n.evaluate();var k=m.evaluate();return l.substring(p,k)};d.prototype.EvaluateBinaryOpNode=function(k){var n=(k.left==="NULL")?SiebelApp.QueryHelper.GetValue().body.evaluate():k.left.evaluate();var m=(k.right==="NULL")?SiebelApp.QueryHelper.GetValue().body.evaluate():k.right.evaluate();var l=k.type;var j;switch(l){case"BINOPNODE_APLUS":if(typeof n.add==="function"&&typeof m.add==="function"){j=n.add(m)}else{if(typeof n.add==="function"&&(typeof m.add!=="function")){j=n.add(m)}else{if((typeof n.add!=="function")&&typeof m.add==="function"){j=m.add(n)}else{j=n+m}}}break;case"BINOPNODE_AMINUS":if(typeof n.subtract==="function"&&(typeof m.subtract!=="function")){j=n.subtract(m)}else{if((typeof n.subtract!=="function")&&typeof m.subtract==="function"){j=m.subtract(n)}else{j=n-m}}break;case"BINOPNODE_AMULTIPLY":j=n*m;break;case"BINOPNODE_ADIVIDE":if(typeof n.divide==="function"&&typeof m.divide==="function"){j=n.divide(m)}else{j=n/m}break;case"BINOPNODE_APOWER":j=Math.pow(n,m);break;case"EQUAL":j=(n===m)?true:false;break;case"BINOPNODE_OR":if(n||m){j=true}else{j=false}break;case"BINOPNODE_AND":if(n&&m){j=true}else{j=false}break;case"BINOPNODE_CEQ":if(n===m){j=true}else{j=false}break;case"BINOPNODE_CNE":case"NOT_EQUAL":j=(n!==m)?true:false;break;case"BINOPNODE_CLE":if(n<=m){j=true}else{j=false}break;case"BINOPNODE_CGE":if(n>=m){j=true}else{j=false}break;case"BINOPNODE_CLT":if(typeof n.less==="function"&&typeof m.less==="function"){j=n.less(m)}else{if(n<m){j=true}else{j=false}}break;case"BINOPNODE_CGT":if(typeof n.greater==="function"&&typeof m.greater==="function"){j=n.greater(m)}else{if(n>m){j=true}else{j=false}}break}return j};d.prototype.EvaluateParentFieldValueNode=function(j){var m=j.args.parameters[0].evaluate();var l=SiebelApp.QueryHelper.GetContext();var k;if(i.IsEmpty(l.GetParentBusComp().GetWS()[0][m])){k=""}else{k=l.GetParentBusComp().GetWS()[0][m]}return k};d.prototype.BinaryOpNodeBoldQuery=function(o){var j=o.left;var F=o.right;var r=o.type;var s=" ";var A;var C;if(r!=="BINOPNODE_OR"&&r!=="BINOPNODE_AND"){switch(r){case"BINOPNODE_CEQ":q="=";
break;case"BINOPNODE_CNE":q="<>";break;case"BINOPNODE_CLT":q="<";break;case"BINOPNODE_CGT":q=">";break;case"BINOPNODE_CLE":q="<=";break;case"BINOPNODE_CGE":q=">=";break;case"BINOPNODE_CLIKE":q="LIKE";break}C=F.evaluate();A=j.BoldQuery();if(C&&typeof C.GetAsFormattedString==="function"){var u;var t;var l;u=new Date(C.m_nYear,C.m_nMonth-1,C.m_nDay);l=u.getTimezoneOffset();u.setMinutes(u.getMinutes()+l);t=new Date(u.getFullYear(),u.getMonth(),u.getDate(),u.getHours(),u.getMinutes(),0,0);t.setHours(t.getHours()+24);var w=u.getDate()<10?"0"+u.getDate():""+u.getDate();var m=u.getHours()<10?"0"+u.getHours():""+u.getHours();var y=u.getMinutes()<10?"0"+u.getMinutes():""+u.getMinutes();var p=u.getMonth()+1;var B=p<10?("0"+p).slice(-2):""+p;var v=t.getDate()<10?"0"+t.getDate():""+t.getDate();var k=t.getHours()<10?"0"+t.getHours():""+t.getHours();var x=t.getMinutes()<10?"0"+t.getMinutes():""+t.getMinutes();var n=t.getMonth()+1;var z=n<10?("0"+n).slice(-2):""+n;var E=u.getFullYear()+""+B+""+w+""+m+""+y;var D=t.getFullYear()+""+z+""+v+""+k+""+x;s=A+' >  "'+E+'"  AND '+A+' <  "'+D+'" ';return"("+s+")"}C='"'+C+'"';s+="("+A+" "+q+" "+C+")";return s}if(r==="BINOPNODE_OR"||r==="BINOPNODE_AND"){A=j.BoldQuery();C=F.BoldQuery();var q=(r==="BINOPNODE_OR")?"OR":"AND";s="("+A+" "+q+" "+C+")";return s}};d.prototype.BoldQueryFieldNameNode=function(l){var s=l.arguments;var k="";var r="";var o="";var q=SiebelApp.QueryHelper.GetContext();var m=false;var w=SiebelApp.OfflineUtils.RemoveNonAlphaChars(q.GetName());var v=q.GetParentBusComp();if(v){var p=q.GetLinkDef();if(p.interTableName){m=true}}for(var n=0;n<s.length;n++){k+=s[n].evaluate()}var r=SiebelApp.OfflineUtils.RemoveNonAlphaChars(k);if(!(SiebelApp.BrowserCacheMgr.DoesFieldExist(w,r))){SiebelJS.Log("Field"+r+"from the BC "+w+" not found")}var o=a.call(this,r,q);if(m){if(q.GetDefn().InterFieldInfo.InterFieldArr.indexOf(o)!==-1){var u=q.GetDefn().Fields[o].ColName;if(SiebelApp.BrowserCacheMgr.DoesFieldExist(p.interTableName,u)){r=SiebelApp.OfflineUtils.RemoveNonAlphaChars(p.interTableName)+"."+u}else{SiebelJS.Log("Column"+u+"from the intertable "+p.interTableName+" not found")}}else{r=w+"."+r}}var j=null;if(o){j=q.GetDefn().Fields[o]}if(j&&(j.DataType==="10"||j.DataType==="12"||j.DataType==="13")){var t;t=q.DateFormatConverter(t,k);return t}return r};function a(j,l){var m=l.GetDefn().Fields;for(var k in m){if(m[k]){if(SiebelApp.OfflineUtils.RemoveNonAlphaChars(k)===j){return k}}}return null}d.prototype.BoldQueryUnaryIsNullNode=function(k){var j=k.BoldQuery();var l="";l+=j+' = ""';return l};d.prototype.BoldQueryUnaryIsNotNullNode=function(k){var j=k.BoldQuery();var l="";l+=j+' <> ""';return l};d.prototype.BoldQueryBracesNode=function(j){var k="";k=" ("+j.body.BoldQuery()+") ";return k};d.prototype.BoldQueryFunctionNode=function(j){var k="";switch(j.name){case"EXISTS":k="1=1"}return k};d.prototype.BoldQueryParameterListNode=function(k){var l="";for(var j=0;j<k.parameters.length;j++){l=l+k.parameters[j].BoldQuery()}return l};d.prototype.BoldQueryParameterNode=function(j){var k="";k=j.param.BoldQuery();return k};return e}())};