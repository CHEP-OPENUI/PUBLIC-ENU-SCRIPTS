/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelApp.S_App.BusComp)){define("siebel/offline/buscomp",["siebel/offline/model"],function(){(function(){var al=SiebelApp.S_App.BusComp;var am=SiebelApp.S_App.BusComp.prototype;var q=SiebelApp.S_App.BusComp;var ao=SiebelApp.Utils;var b=SiebelApp.S_App;var k=SiebelApp.OfflineUtils;var D=SiebelApp.Offlineconstants;var J=D.get("LOG_EVT_CLIENT_SYS");var M=true;var I=SiebelApp.BrowserCacheMgr;var W=SiebelApp.S_App.Model;var ac=SiebelApp.AjaxRequestMgr;SiebelApp.S_App.BusComp=function(){q.call(this);var aQ={};var aH=true;var aM=true;var aY=true;var bf=[];var aJ=[];var bm=[];var bc=0;var av=-1;var ba=-1;var a9=true;var bg={};var a5={};var bk=[];var a8=null;var bn=true;var aI=true;var bb=0;var aE=0;var aO=[0,1];var aX=D.get("INSMODE_NORMAL");var aT="";var bo=false;var aW=[];var a1={};var aN=false;var aV=false;var aL=[];var at=[];var aZ=false;var a0;var a7=false;var a4;var be;var a6=false;var a3="";var aD="";var aG="";var ay=[];var aS=[];var aB=10;var aC=false;var aF=false;var aw=false;var aP=[];var aK=[];var aq=[];var au=[];var aA=null;var bj="";var bd="";var bh="";var az="";var bi;var bl=[];var aU=false;var a2=null;var ap=null;var ar=null;this.GetAssocList=function(){if(!bi){if(this.GetLinkDef()&&this.GetLinkDef().interTableName){var bp=this.GetBusObj();var br=this.GetName();var bq=bp.GetBCPS(br,true);bi=new SiebelApp.S_App.BusComp();bi.ProcessObjectInfo(bq)}}return bi};this.SetAssocList=function(bp){bi=bp};this.SetPickSrcIdFName=function(bp){a2=bp};this.GetPickSrcIdFName=function(){return a2};this.GetPickAppletSrcInfo=function(){return az};this.SetPickAppletSrcInfo=function(bp){az=bp};this.GetIsPopup=function(){return bh};this.SetIsPopup=function(bp){bh=bp};this.GetViewMode=function(){return bd};this.SetViewMode=function(bp){bd=bp};this.GetInterface=function(){if(!aA){aA=new SiebelApp.S_App.OfflineBCInterface(this)}return aA};this.ResetInterface=function(){if(aA){aA.EndLife()}aA=null};this.GetOnUpdSrcFldArray=function(){return aP};this.GetOnUpdDstFldArray=function(){return aK};this.GetOnUpdExprArray=function(){return aq};this.GetOnUpdConditionArray=function(){return au};this.IsLoadOnFldUpdSet=function(){return aF};this.SetLoadOnFldUpd=function(bp){aF=bp};this.IsOnFieldUpdDisabled=function(){return aw};this.DisableOnFieldUpd=function(){aw=true};this.GetWSSize=function(){return aB};this.SetWSSize=function(bp){aB=bp};this.GetOldFNm=function(){return ay};this.SetOldFNm=function(bp){if(ay.indexOf(bp)<0){ay.push(bp)}};this.SetEmptyFNm=function(){ay=[];aS=[]};this.GetOldfVal=function(){return aS};this.SetOldFVal=function(bw,bq){var bv=this.GetOldFNm();var bp=bv.indexOf(bw);if(bp<0){aS.push(bq)}else{if(!aS[bp]){aS[bp]=bq}else{var bt=aS[bp].split("|");var bu=bq.split("|");var br=bt[0];var bs=bu[1];aS[bp]=br+"|"+bs}}};this.GetNewTxn=function(){return a3};this.SetNewTxn=function(bp){a3=bp};this.GetOpType=function(){return aG};this.SetOpType=function(bp){aG=bp};this.GetTxnId=function(){return aD};this.SetTxnId=function(bp){aD=bp};this.IsNotifyEnabled=function(){return aM};this.SetNotifyEnabled=function(bp){aM=bp};this.IsNotifySysEnabled=function(){return aY};this.SetNotifySysEnabled=function(bp){aY=bp};this.SetWorkSet=function(bp){bf=bp};this.GetWorkSet=function(){return bf};this.GetNotifyInfoArray=function(){return aJ};this.AddNotifyInfoArray=function(bp){aJ.push(bp)};this.ResetNotifyArr=function(){aJ=[]};this.GetRef=function(){return bc};this.AddRef=function(){return ++bc};this.RemoveRef=function(){return bc--};this.GetExtObj=function(){return aQ};this.SetExtObjProp=function(bq,bp){this.GetExtObj()[bq]=bp};this.GetExtObjProp=function(bp){if(!((this.GetExtObj()).hasOwnProperty(bp))){this.GetExtObj()[bp]=null}return(this.GetExtObj()[bp])};this.IsInExecution=function(){return aH};this.SetExecutionState=function(bp){aH=bp};var aR=this.IsInsertPending;this.IsInsertPending=function(){if(SiebelApp.OfflineAppSettings.GetMode()===true){return this.insertPending}else{return aR}};var ax=this.SetSearchSpec;this.SetSearchSpec=function(bs){if(SiebelApp.OfflineAppSettings.GetMode()===true){if(window.localStorage.getItem("contextArray")){var bq=JSON.parse(window.localStorage.getItem("contextArray"));var bp=bq.length;var bt;for(var br=0;br<bp;br++){bt=bq[br].bc;if(this.GetName&&(this.GetName()===bt)){bq[br].ss=bs;window.localStorage.setItem("contextArray",JSON.stringify(bq));break}}}}return ax.call(this,bs)};this.GetMultiSelectMode=function(){return bo};this.SetMultiSelectMode=function(bp){if(this.GetMultiSelectMode()===bp){return}bo=bp;this.NotifyStateChanged("bInMultiSelMode",bo)};this.GetExplicitCommit=function(){return aV};this.SetExplicitCommit=function(bp){aV=bp};this.GetSelRowIdArray=function(){return aW};this.SetSelRowIdArray=function(bp){aW=bp};this.SetBCTableUpdateState=function(bp){a9=bp};this.GetBCTableUpdateState=function(){return a9};this.SetCursor=function(bp){aO=bp};this.GetCursor=function(){return aO};this.SetQuerySearchSpec=function(bp){bg=bp};this.GetQuerySearchSpec=function(){return bg};this.SetAppletSearchSpec=function(bp){bl=bp};this.GetAppletSearchSpec=function(){return bl};this.SetQuerySortSpec=function(bp){a5=bp};this.GetQuerySortSpec=function(){return a5};this.SetQueryFieldList=function(bp){bk=bp};this.GetQueryFieldList=function(){return bk};this.SetPrevActiveRow=function(bp){ba=bp};this.GetPrevActiveRow=function(){return ba};this.SetQueryOrder=function(bp){a8=bp};this.GetQueryOrder=function(){return a8};this.SetPriorSet=function(bp){bn=bp};this.GetPriorSet=function(){return bn};this.SetNextSet=function(bp){aI=bp};this.GetNextSet=function(){return aI};this.SetRecordCount=function(bp){bb=bp};this.GetRecordCount=function(){return bb};this.SetScrollCount=function(br){aE=br;if(window.localStorage.getItem("contextArray")){var bq=JSON.parse(window.localStorage.getItem("contextArray"));var bp=bq.length;for(var bs=0;bs<bp;bs++){var bt=bq[bs].bc;if(this.GetName()===bt){bq[bs].sc=br;break}}window.localStorage.setItem("contextArray",JSON.stringify(bq))}};this.GetScrollCount=function(){return aE};this.SetBCTableInsertState=function(bp){aX=bp};this.GetBCTableInsertState=function(){return aX};this.SetInsertStatement=function(bp){aT=bp};this.GetInsertStatement=function(){return aT};this.SetIsRelatedBC=function(bp){aU=bp};this.GetIsRelatedBC=function(){return aU};this.GetWS=function(){return bm};this.AddWS=function(bp){this.GetWS().push(bp)};this.EmptyWS=function(){bm=[]};this.SetFieldValueWS=function(br,bq,bp){bm[bp][br]=bq};this.GetBCState=function(){return a1};this.SetBCState=function(bp){a1=bp};this.GetInverseSelection=function(){return aN};this.SetInverseSelection=function(bp){aN=bp};this.GetActivatedFieldList=function(){var bs=this.GetFieldMap();var bt;for(var br in bs){if(bs[br]){bt=SiebelApp.S_App.LookupStringCache(bs[br].GetName());if(aL.indexOf(bt)===-1){aL.push(bt)}}}var bp=this.GetActFieldList();for(var bq in bp){if(bp[bq]){bt=SiebelApp.S_App.LookupStringCache(bp[bq]);if(aL.indexOf(bt)===-1){aL.push(bt)}}}return aL};this.ResetActivatedFieldList=function(){aL=[]};this.GetSavedFieldArray=function(){return at
};this.SetSavedFieldArray=function(bp){at=bp};this.IsDeleteRecordPending=function(){return(aZ)};this.SetDeleteRecordPending=function(bp){aZ=bp};this.SetAdminNoDelete=function(bp){a7=bp};this.GetAdminNoDelete=function(bp){a7=false;return a7};this.SetAspectBCReadFld=function(bp){a4=bp};this.GetAspectBCReadFld=function(bp){return a4};this.SetAdminMode=function(bp){a6=bp};this.GetAdminMode=function(bp){a6=false;return a6};this.SetFldNoDelete=function(bp){be=bp};this.GetFldNoDelete=function(bp){return be};this.IsBCFldsActivated=function(){return aC};this.SetBCFldsActivated=function(bp){aC=bp};this.SetOrigRecVal=function(bp){bj=bp};this.GetOrigRecVal=function(){return(bj)};this.SetMasterBC=function(bp){ap=bp};this.GetMasterBC=function(){return(ap)};this.SetPickSrcField=function(bp){ar=bp};this.GetPickSrcField=function(){return(ar)}};SiebelApp.S_App.BusComp.prototype=am;SiebelApp.S_App.BusComp.prototype.constructor=SiebelApp.S_App.BusComp;var j={};j.EndLife=al.prototype.EndLife;j.ProcessObjectInfo=al.prototype.ProcessObjectInfo;j.PositionById=al.prototype.PositionById;j.SetSortSpec=al.prototype.SetSortSpec;j.CanInsert=al.prototype.CanInsert;j.WriteRecord=al.prototype.WriteRecord;j.UndoRecord=al.prototype.UndoRecord;j.NewRecord=al.prototype.NewRecord;j.SetInQueryState=al.prototype.SetInQueryState;var D=SiebelApp.Offlineconstants;var ae=SiebelApp.OfflineCacheConfig;var p=D.get("IS_DYNAMIC");var i;var V=false;var ah=null;var B=SiebelApp.Constants;var Z=B.get("SWE_ARG_EQUAL");var n=B.get("SWE_PROP_NAME");var N=D.get("DOUIREG_OBJ_NAME");var u=D.get("DOUIREG_OBJ_TYPE");var A=D.get("DOUIREG_OBJ_TYPEBUSCOMP");var R=D.get("DOUIREG_OBJ_MTHD");var an=D.get("DOUIREG_EXT_TYPE");var o=D.get("DOUIREG_EXT_TYPEOVERRIDE");var a=D.get("DOUIREG_EXT_TYPEPRE");var r=D.get("DOUIREG_EXT_TYPEPOST");var f=D.get("DOUIREG_EXT_CONTEXT");var c=D.get("SWE_ARG_NOT_EQUAL");var x=D.get("SSA_PRIMARY_FIELD");var aa=D.get("SAVE_BC_STATE_ALL");var ad=D.get("SAVE_BC_STATE_NONE");var af=D.get("DTYPE_UTCDATETIME");var g="[~]";var F=SiebelApp.OfflineAppSettings;al.prototype.GetActiveRow=function(){return(e.call(this))};al.prototype.ProcessObjectInfo=function(aD,aC){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.ProcessObjectInfo")}if(F.GetMode()){if(!(aD.GetProperty(p))){var aq=B.get("SWE_PST_BUSOBJ_INFO");var at;var aA=aD.GetValue();var ar=B.get("SWE_PROP_NAME");var ap=CCFMiscUtil_CreatePropSet();var ay=aD.GetProperty(D.get("STAND_ALONE_INST"));var aB=(!ao.IsTrue(ay));this.GetUIState=function(){return aB};if(ao.IsTrue(ay)){at=CCFMiscUtil_CreatePropSet();at.SetType(aq);at.SetValue("");at.SetProperty(p,true)}else{at=SiebelApp.S_App.Model.GetDyncPS(aq,false);ap.SetType(aD.GetType());ap.SetValue(aA);ap.SetProperty(p,true);ap.SetProperty(p,true);SiebelApp.OfflineUtils.ProcessDPS(ap,aD,[ar],1,true);var ax=B.get("SWE_PST_REC_LIST");var az=[n];SiebelApp.OfflineUtils.ProcessDPS(ap,aD,az,1,true);var aw=aD.FindChildPosition(ax);aD.RemoveChild(aw);at.AddChild(ap);SiebelApp.S_App.Model.SetDyncPS([aq],[at],1);if(aC){if(aA!==this.GetVarName()){this.GetVarName=function(){return aA}}var av=aD.GetProperty("pi");if(av){av=av.toString()}if(this.GetParentId()){if(this.GetParentId()!==av){this.GetParentId=function(){return av}}}else{if(av){this.GetParentId=function(){return av}}}var au=aD.GetChildByType(B.get("SWE_PST_FIELD_LIST"));if(au){this.ProcessNFLObjectInfo(au)}return}}this.SetSearchSpec("");this.SetSortSpec("")}}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.ProcessObjectInfo")}return(j.ProcessObjectInfo.call(this,aD))};al.prototype.ProcessNFLObjectInfo=function(au){var aq=SiebelApp.S_App.BCField;var ap=au.EnumChildren(true);do{var at=ap.GetProperty(B.get("SWE_PROP_NAME"));at=SiebelApp.S_App.LookupStringCache(at);if(SiebelApp.OfflineAppSettings.GetMode()===true&&!this.GetDefn().Fields[at]){continue}if(!this.GetFieldMap()[SiebelApp.S_App.LookupStringCache(at)]){var ar=new aq();ar.SetBusComp(this);ar.ProcessObjectInfo(ap);this.AddField(ar)}}while(ap=au.EnumChildren(false))};al.prototype.GetActFieldList=function(){if(!this.GetExtObjProp("m_mapActFields")){this.SetExtObjProp("m_mapActFields",{})}return(this.GetExtObjProp("m_mapActFields"))};al.prototype.GetDeActableFieldList=function(){if(!this.GetExtObjProp("m_arDeActableFields")){this.SetExtObjProp("m_arDeActableFields",[])}return(this.GetExtObjProp("m_arDeActableFields"))};function m(){return false}al.prototype.AddActField=function(ap){var at;var ar=ap;ap=this.GetFieldDefn(ap);if(ap){if(ar){var aw=this.GetFieldMap()[ar];if(aw){aw.SetActivated(true)}else{var aq=SiebelApp.S_App.LookupSCMap(ar);if(aq){at=aq}else{var av=[];av=[ar];var au=CCFMiscUtil_ArrayToString(av);SiebelApp.S_App.AppendToStrCache(au);at=SiebelApp.S_App.LookupSCMap(ar)}this.GetActFieldList()[ar]=at}}}};al.prototype.InvokeMethodX=function(ap,au){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.InvokeMethodX ")}var at;var aq={};var ar=[];if(!ap){ar.push(ap);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrUnknownBCMethod",ar,"","","",4,11);$.setReturnValue({err:"SSAOMErrUnknownBCMethod",retVal:""});return}aq[N]=this.GetName();aq[u]=A;aq[R]="DoInvokeMethod";aq[f]=this;if(!au){au=CCFMiscUtil_CreatePropSet()}au.SetProperty("MethodName",ap);aq[an]=a;SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(av){if(!av.err){at=av.retVal;if((at.Outputargs)&&(at.Outputargs).GetProperty("Invoked")&&(at.Outputargs).GetProperty("Invoked").toString()==="true"){$.setReturnValue({err:av.err,retVal:at.Outputargs});return}if(at.Outputargs&&au){(at.Outputargs).SetType(a);au.AddChild(at.Outputargs)}ai.call(this,ap,au);$.callback(this,function(ax){if(!ax.err){var aw=ax.retVal;if(aw){ar.push(ap);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrUnknownBCMethod",ar,"","","",4,11);$.setReturnValue({err:"SSAOMErrUnknownBCMethod",retVal:""});return}au.SetProperty("RetVal",aw);aq[an]=r;SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(ay){if(!ay.err){if(ay.retVal.Outputargs){$.setReturnValue({err:false,retVal:ay.retVal.Outputargs})}else{$.setReturnValue({err:false,retVal:true})}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.InvokeMethodX ")}}else{$.setReturnValue(ay)}})}else{$.setReturnValue(ax)}})}else{$.setReturnValue(av)}})};al.prototype.CanInvokeMethodX=function(ap){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.CanInvokeMethodX")}var aq={};var at;if(!ap){$.setReturnValue({err:true,retVal:false})}aq[N]=this.GetName();aq[u]=A;aq[R]="DoCanInvokeMethod";aq[an]=a;aq[f]=this;var au=CCFMiscUtil_CreatePropSet();var ar;au.SetProperty("MethodName",ap);SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(av){err=av.err;if(err){$.setReturnValue({err:err,retVal:at.Outputargs});return}if(!av.err){at=av.retVal;if(at.Outputargs){if((at.Outputargs).GetPropertyAsStr("Invoked")==="true"){$.setReturnValue({err:err,retVal:(at.Outputargs).GetProperty("RetVal").toString()});
return}}aq[an]=r;if(this.IsNamedMethod(ap)){this.CanInvokeNamedMethod(ap);$.callback(this,function(ay){SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(az){ar=h.call(this,az);$.setReturnValue({err:false,retVal:ar})})})}else{if(ap==="RefreshBusComp"){SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(ay){ar=h.call(this,ay);$.setReturnValue({err:false,retVal:ar})})}else{if(ap==="Merge"){var ax;var aw=false;ax=this.GetNumSelected();if(aw||(ax<2)){$.setReturnValue({err:false,retVal:true});return}$.setReturnValue({err:false,retVal:this.CanMergeRecords()})}else{if((ap==="GetFieldLength")||(ap==="GetFieldDataType")||(ap==="MergeRecords")||(ap==="IsFieldReadOnly")||(ap==="CanDeleteRecords")||(ap==="CanInsertRecords")||(ap==="CanMergeRecords")||(ap==="CanUpdateRecords")||(ap==="EnableNotify")||(ap==="EnableHierarchy")||(ap==="IsExecuted")||(ap==="IsFieldActive")||(ap==="UpdateLinks")){SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(ay){ar=h.call(this,ay);$.setReturnValue({err:false,retVal:ar})})}else{SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(ay){at=ay.retVal;ar=h.call(this,ay);$.setReturnValue({err:false,retVal:ar})})}}}}}else{$.setReturnValue(av)}});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.CanInvokeMethodX")}};function h(ar){var aq=ar.retVal;var ap=false;if(aq.Outputargs){ap=(aq.Outputargs).GetProperty("RetVal").toString();if(ap==="true"){ap=true;return ap}else{return ap}}else{return ap}}al.prototype.IsNamedMethod=function(ap){return(false)};al.prototype.CanInvokeNamedMethod=function(ap){return(false)};function ai(ap,ar){if(!ap){$.setReturnValue({err:true,retVal:false});return}var aq={};if(ar.GetProperty("Request")){aq.request=ar.GetProperty("Request").toString()}if(ap==="NewRecord"){this.NewRecord(aq);$.callback(this,function(at){if(at.err){$.setReturnValue(at)}else{$.setReturnValue({err:false,retVal:false})}});return}if(ap==="EditRecord"){this.EditRecord(aq);$.callback(this,function(at){if(at.err){$.setReturnValue(at)}else{$.setReturnValue({err:false,retVal:false})}});return}if(ap==="WriteRecord"){this.WriteRecord();$.callback(this,function(at){if(at.err){$.setReturnValue(at)}else{$.setReturnValue({err:false,retVal:false})}});return}if(ap==="GetQuickPickInfo"){$.setReturnValue({err:false,retVal:false})}if(ap==="AddRecord"){this.OnActionAddRecord();$.callback(this,function(at){if(at.err){$.setReturnValue(at)}else{$.setReturnValue({err:false,retVal:false})}});return}if(ap==="UndoRecord"){this.UndoRecord(aq);$.callback(this,function(at){if(at.err){$.setReturnValue(at)}else{$.setReturnValue({err:false,retVal:false})}});return}if(ap==="RefreshRecord"){this.RefreshRecord();$.callback(this,function(at){if(at.err){$.setReturnValue(at)}else{$.setReturnValue({err:false,retVal:false})}});return}if(ap==="RefreshBusComp"){this.RefreshBusComp();$.callback(this,function(at){if(at.err){$.setReturnValue(at)}else{$.setReturnValue({err:false,retVal:false})}});return}$.setReturnValue({err:false,retVal:true})}al.prototype.CoreMethod=function(ap){switch(ap){case D.get("DELETERECORD"):case B.get("SWE_GET_PICK_INFO"):case D.get("SWE_POST_CHANGES"):case D.get("DELETERECORD"):case D.get("SWE_CLOSE_APPLET"):case D.get("POSITION_ON_ROW"):case D.get("PICKRECORD"):case D.get("WRITERECORD"):case D.get("NEWRECORD"):case D.get("ADDRECORD"):case D.get("EDIT_FIELD"):case D.get("UNDORECORD"):case D.get("REFRESH_BUSCOMP"):case D.get("REFRESH_RECORD"):return true;default:return false}};function L(ap){switch(ap){case"1":case"2":case"4":case"5":case"14":return"text";case"3":return"phone";case"6":return"number";case"7":return"currency";case"8":return"bool";case"9":return"integer";case"10":return"date";case"11":return"time";case"12":return"datetime";case"13":return"utcdatetime";default:return""}}function d(at){if(at){var ax=this.GetFieldMap()[at];if(!ax){var ar=this.GetFieldDefn(at);if(ar){var au=SiebelApp.S_App.LookupSCMap(at);var av=Object.keys(this.GetFieldMap()).length;var aw=new SiebelApp.S_App.BCField();var aq=CCFMiscUtil_CreatePropSet();aq.SetType(B.get("SWE_PST_FIELD"));aq.SetPropertyStr(B.get("SWE_PROP_NAME"),au);aq.SetPropertyStr(B.get("SWE_PROP_TYPE"),L.call(this,ar.DataType));aq.SetPropertyStr(B.get("SWE_PROP_IS_CALC"),ar.IsCalculated);aq.SetPropertyStr(B.get("SWE_PROP_IS_HIDDEN"),ar.Hidden);if(ar.ReadOnly){aq.SetPropertyStr(B.get("SWE_PROP_IS_READONLY"),ar.ReadOnly)}if(ar.Required){aq.SetPropertyStr(B.get("SWE_PROP_IS_REQ"),ar.Required)}aq.SetPropertyStr(B.get("SWE_PROP_SCALE"),ar.Scale);aq.SetPropertyStr(B.get("SWE_PROP_LENGTH"),ar.OldTextLen);if(ao.IsTrue(ar.ImPostChg)){aq.SetPropertyStr(B.get("SWE_PROP_IS_POST_CHANGES"),ar.ImPostChg)}aq.SetPropertyStr(B.get("CALCEXPR"),ar.CalExpr);aq.SetPropertyStr(B.get("COLUMN_NAME"),ar.ColName);aq.SetPropertyStr(B.get("DISABLE_SEARCH"),ar.DisableSearch);aq.SetPropertyStr(B.get("DISABLE_SORT"),ar.DisableSort);aq.SetPropertyStr(B.get("FORCE_ACTIVE"),ar.ForceActive);aq.SetPropertyStr(B.get("FORCE_CASE"),ar.ForceCase);aq.SetPropertyStr(B.get("LINKNAME"),ar.LinkName);aq.SetPropertyStr(B.get("NOCOPY"),ar.NoCopy);aq.SetPropertyStr(B.get("PICKLISTNAME"),ar.PickListName);aq.SetPropertyStr(B.get("POSTDEFAULT"),ar.PostDefault);aq.SetPropertyStr(B.get("PREDEFAULT"),ar.PreDefault);aq.SetPropertyStr(B.get("PRECISION"),ar.Precision);aq.SetPropertyStr(B.get("VALIDATIONSPEC"),ar.ValidationSpec);aq.SetPropertyStr(B.get("PRECISION"),ar.Precision);aq.SetPropertyStr("fDeps",ar.fDepArray);aw.SetBusComp(this);aw.SetName(au);aw.index=av;aw.ProcessObjectInfo(aq,true);aw.SetActivated(true);this.GetFieldMap()[at]=aw}}else{var ap=ax.IsActivated();if(!(ap)){if(ax){ax.SetActivated(true)}}}}}function ag(ap){if(!this.GetExtObjProp("m_wsActiveRow")){this.SetExtObjProp("m_wsActiveRow",-1)}this.SetExtObjProp("m_wsActiveRow",ap)}function e(){if(ao.IsEmpty(this.GetExtObjProp("m_wsActiveRow"))){this.SetExtObjProp("m_wsActiveRow",-1)}return this.GetExtObjProp("m_wsActiveRow")}this.RemoveAllFields=function(){this.SetExtObjProp("m_mapActFields",{})};al.prototype.SetActiveRow=function(aq,au){if(au===undefined){au=false}var at;var ar=false;if(e.call(this)>=0&&e.call(this)!==aq){this.FinishRecord();ar=true}if(aq<0||aq>=this.GetWS().length){this.NotifyNewActiveRow();if(!this.GetMultiSelectMode()){this.NotifyNewSelection(true)}this.SetCurrCursor(aq);$.setReturnValue({err:false});return}var ap=function(){var ay=false;var az=0;var aA=this.GetNotifyInfoArray();if(az<aA.length){var aw=aA[az];if(aw&&aq!==-1){var av=aw.GetBegRow();if(aq<av){aw.SetBegRow(aq)}else{if(!this.IsVBC()&&!this.GetIsRelatedBC()&&(aq>(av+aw.GetSize()-1))){aw.SetBegRow(aq)}}}}if(aq===this.GetWS().length){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("BCErrNoActiveRow","","","","",0,72);this.NotifyNewActiveRow();if(!this.GetMultiSelectMode()){this.NotifyNewSelection(true)}$.setReturnValue({err:"BCErrNoActiveRow"});return}this.SetCurrCursor(aq);ag.call(this,aq);if(!au){this.OnActiveRowChanged()}else{at=this.FindWorkSet(this.GetSelection());
if(at){this.FieldValue(B.get("SWE_ROW_ID_FIELD"),at);ay=true;$.callback(this,function(aB){if(retobj.err){$.setreturnValue(aB);return}else{var aC=aB.retVal;this.PositionById(aC);$.callback(this,function(aD){if(aD.err){$.setreturnValue(aD);return}else{ax.call(this)}})}})}}var ax=function(){this.NotifyNewActiveRow();if(!au){this.UpdateLinks(false);$.callback(this,function(aB){if(!aB.err){if(!this.GetMultiSelectMode()){this.NotifyNewSelection(true)}$.setReturnValue({err:false})}else{$.setReturnValue(aB)}})}else{$.setReturnValue({err:false})}};if(!ay){ax.call(this)}};if(ar){$.callback(this,function(av){if(av.err){$.setReturnValue(av)}else{ap.call(this)}})}else{ap.call(this)}};al.prototype.GetBusCompType=function(){return M};al.prototype.SetBusCompType=function(ap){M=ap};al.prototype.SetCurrCursor=function(ap){var ar=ac.GetActiveRequestObj();if(ar&&ar.SweCommands&&ar.SweCommands.SWEMethod&&this.IsPagination(ar.SweCommands.SWEMethod)){var at=this.GetCursor();var aq=this.GetScrollCount();if(ap<0){ap=this.GetActiveRow()}if(aq){at[0]=aq+ap}else{at[0]=ap}this.SetCursor(at)}};al.prototype.PositionById=function(ap){if(F.GetMode()===true){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.PositionById")}var at=false;var ar=false;var ax=ap;var aq=-1;var av;var au;var aw=this.GetWS().length;if(this.IsExecuted()){this.FinishRecord();$.callback(this,function(aB){if(aB.err){$.setReturnValue(aB)}else{var ay=0;var aA=false;av=this.FindWorkSet(ay);this.FieldValue(B.get("SWE_ROW_ID_FIELD"),av);var az=function(aC){au=aC.retVal;if(au===ax){aq=ay;at=true;aA=true}ay++;if(!aA&&ay<aw){av=this.FindWorkSet(ay);this.FieldValue(B.get("SWE_ROW_ID_FIELD"),av);$.callback(this,az)}};$.callback(this,az);$.callback(this,function(){if(aq===-1){ag.call(this,-1);S.call(this,ap);$.callback(this,function(aC){if(!aC.err){av=aC.retVal;this.InsertWorkSet(0,av);$.callback(this,function(){y.call(this,at,ar);$.callback(this,function(aD){$.setReturnValue(aD)})})}else{$.setReturnValue(aC);return}})}else{ar=true;av=null;this.SetActiveRow(aq);$.callback(this,function(aC){if(!aC.err){y.call(this,at,ar);$.callback(this,function(aD){$.setReturnValue(aD)})}else{$.setReturnValue(aC)}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.PositionById ")}})}})}})}}else{return(j.PositionById.call(ap))}};function y(aq,ap){if(!aq){w.call(this);$.callback(this,function(ar){if(ar.err){$.setReturnValue({err:true});return}})}$.callback(this,function(ar){if(!ar.err){if(!ap){this.UpdateLinks(false);$.callback(this,function(at){$.setReturnValue(at)})}else{$.setReturnValue({err:false})}}})}function w(){var aq=this.GetWS().length;var ap=this.GetWorkSetSize();var at=0;ag.call(this,-1);var au;var ar=false;$.callback(this,function(){var av=function(){this.GetNextRecord();$.callback(this,function(aw){au=aw.retVal;ar=aw.err;this.InsertWorkSet(aq,au);aq++;if(aq<this.GetWorkSetSize()&&!ar){av.call(this)}})};if(aq<this.GetWorkSetSize()){av.call(this)}$.callback(this,function(ay){if(ar){aq--;this.DeleteWorkSet(aq);ar=false}var aw=this.GetWS().length;if(aw>0&&aw<this.GetWorkSetSize()){var az=this.FindWorkSet(0,az);if(az){var ax=function(){at++;this.GetPriorRecord(az);$.callback(this,function(aA){az=aA.retVal;ar=aA.err;this.InsertWorkSet(0,az);if(this.GetWS().length<this.GetWorkSetSize()&&!ar){ax.call(this)}})};if(aw<this.GetWorkSetSize()){ax.call(this)}}$.callback(this,function(){if(ar){at--;this.DeleteWorkSet(0)}})}$.callback(this,function(){this.SetActiveRow((this.GetWS().length>0)?at:-1);$.callback(this,function(){var aD=this.GetNotifyInfoArray();var aA=aD.length;for(var aB=0;aB<aA;aB++){pni=aD[aB];if(pni){var aC=this.GetActiveRow();if(aC===-1||aC===0||(this.GetWS().length<pni.GetSize())){pni.SetBegRow(0)}else{if((aC+pni.GetSize())<=this.GetWS().length){pni.SetBegRow(aC)}else{pni.SetBegRow(this.GetWS().length-pni.GetSize())}}pni.SetCurrRow(pni.GetBegRow())}}this.NotifyNewData()})})})})}function S(ap){var ar=this.GetActivatedFieldList();var av=ar.length;var az=SiebelApp.OfflineUtils.RemoveNonAlphaChars(this.GetName());var ax=[];var au=0;for(var ay=0;ay<av;ay++){var aq=ar[ay];aq=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aq);if(I.DoesFieldExist(az,aq)){ax[au]=aq;au++}}var at={};at.FieldName=B.get("SWE_ROW_ID_FIELD");at.Oper=B.get("SWE_ARG_EQUAL");at.Val=ap;var aw=SiebelApp.SqlBuilder.SelectRecord(az,[at],ax);I.SelectRecord(aw,true);$.callback(this,function(aA){if(aA.err){$.setReturnValue(aA)}else{$.setReturnValue({err:false,retVal:(aA.retVal)[0]})}})}al.prototype.SetFullSearchSpec=function(aq){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.SetSearchSpec ")}var ap=null;if(!ao.IsEmpty(this.GetSearchSpec())||!ao.IsEmpty(this.GetDefn().searchSpec)){ap=ao.IsEmpty(this.GetDefn().searchSpec)?"":this.GetDefn().searchSpec;if(ao.IsEmpty(this.GetDefn().searchSpec)){ap+=this.GetSearchSpec();ap=SiebelApp.Query.GetSearchSpec(ap,this)}else{var ar=this.GetSearchSpec();ap=SiebelApp.Query.GetSearchSpec(ap,this);if(!ao.IsEmpty(ar)){ar=SiebelApp.Query.GetSearchSpec(this.GetSearchSpec(),this);if(!ao.IsEmpty(ap)){ap=[ap];ap.push(ar)}else{if(!ao.IsEmpty(ar)){ap=ar}}}}}return((ao.IsEmpty(ap))?[]:ap)};al.prototype.SetFldSearchSpec=function(ar,ap){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.SetFldSearchSpec ")}var au;var at="";var aq;if((ar===D.get("SSA_PRIMARY_FIELD"))&&this.GetLinkDef()&&(!ao.IsEmpty(this.GetLinkDef().primeIdFieldName))&&this.GetParentBusComp()){if(!ao.IsEmpty(ap)){if(ap==="Y"){au=Z}else{au=c}if(!ao.IsEmpty(au)){ar=B.get("SWE_ROW_ID_FIELD");this.GetParentBusComp().FieldValue(this.GetLinkDef().primeIdFieldName);$.callback(this,function(){au+=at;ap=au;aq=this.GetFieldMap()[ar];if(aq){if(!ao.IsEmpty(ap)){aq.SetSearchSpec(ap)}}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.SetFldSearchSpec ")}})}}}else{aq=this.GetFieldMap()[ar];if(aq){aq.SetSearchSpec(ap)}}this.NotifyNewQuerySpec(ar)};al.prototype.GetFldSearchSpec=function(ap){var aq=(this.GetFieldMap())[ap];if(aq){return(aq.GetSearchSpec())}};al.prototype.GetSearchExpr=function(){return(this.GetSearchSpec())};al.prototype.SetSearchExpr=function(ap){this.SetSearchSpec(ap)};al.prototype.NotifyNewQuerySpec=function(ar){var at;if(this.IsNotifyEnabled()){var av=this.GetNotifyInfoArray();var ap=av.length;for(var aq=0;aq<ap;aq++){at=av[aq];if(at){var au=at.GetBusCompNotify();if(au){au.NotifyNewQuerySpec(ar)}}}}};al.prototype.EmptyWorkSet=function(){var ap=this.GetWS();for(var aq=(ap.length-1);aq>=0;aq--){this.DeleteWorkSet(aq)}};al.prototype.SetSortSpecification=function(){var au=this.GetDefn().SortSpec;if(ao.IsEmpty(au)){return[]}au=au.split(",");var at;var ap;var ar;for(var aq=0;aq<au.length;aq++){at="";if(au[aq].indexOf("(")!==-1){at=au[aq].substr(0,au[aq].indexOf("(")).trim()}else{at=au[aq].trim()}if(this.GetDefn().Fields[at].DataType==="10"||this.GetDefn().Fields[at].DataType==="12"||this.GetDefn().Fields[at].DataType==="13"){ap=at.replace(/\s+/g,"");
ar="";ar=this.DateFormatConverter(ar,ap);au[aq]=au[aq].replace(at,ar);au[aq]=au[aq].trim()}else{au[aq]=SiebelApp.OfflineUtils.RemoveNonAlphaChars(au[aq])}au[aq]=au[aq].replace("(DESCENDING)"," DESC");au[aq]=au[aq].replace("(DESC)"," DESC");au[aq]=au[aq].replace("DESCENDING"," DESC");au[aq]=au[aq].replace("DESC"," DESC");au[aq]=au[aq].replace("(ASCENDING)"," ASC");au[aq]=au[aq].replace("(ASC)"," ASC");au[aq]=au[aq].replace("ASCENDING"," ASC");au[aq]=au[aq].replace("ASC"," ASC")}return au};al.prototype.DateFormatConverter=function(aq,ap){return"substr("+ap+",7,4)||substr("+ap+",1,2)||substr("+ap+",4,2)||substr("+ap+",12,2)||substr("+ap+",15,2)||substr("+ap+",18,2)"};al.prototype.WSHomeX=function(ar,ap){var at=this.GetNotifyInfoArray();var aq=at[ar];if(ar>=at.length||ao.IsEmpty(aq)){return}aq.SetCurrRow(aq.GetBegRow(ap),ap);this.CheckActiveRow()};al.prototype.SetWorkSetSizeX=function(aM,ap,aq,aH){var aI=this.IsNotifyEnabled();var ay=false;var aC=e.call(this);var aK=this.GetNotifyInfoArray();var aw=aK[aM];var aE=null;var aD=aK.length;var ax=0;var aJ=-1;var aF=false;var aL;var aB;var az=this.GetCursor();var aA=this.GetWorkSetSize();aq=(aq===undefined)?true:aq;if(aM>=aD||aK[aM]===null){alert("SSAOMErrNotifyInfo");if(!aq&&aI){this.EnableNotify()}return}if(!aq&&aI){this.DisableNotify()}ay=this.CheckActivation();if(ap>aA){if(aC!==-1){aL=this.FindWorkSet(this.GetWS().length-1)}var av=az[0];var aG=this.GetPrevActiveRow();if(aG<=0){if(az[0]>=(D.get("PAGE_SIZE")-1)){aG=D.get("PAGE_SIZE")-1}else{aG=az[0]-1}}if(aG>0){var au=this.GetRecordCount();if(av<0){av=0}var at=this.GetScrollCount();if(au>0&&(au-at)<=D.get("PAGE_SIZE")){az[0]=au-D.get("PAGE_SIZE");if(az[0]<0){az[0]=0}az[0]--;this.SetCursor(az);this.DeleteWorkSet(this.GetWS().length-1);this.SetScrollCount(az[0]+1)}else{if(au>0){at=at+aG;if((au-at)<=D.get("PAGE_SIZE")){at=au-D.get("PAGE_SIZE");az[0]=at-1;this.SetCursor(az);this.DeleteWorkSet(this.GetWS().length-1)}this.SetScrollCount(at)}}}var ar=function(){this.GetNextRecord();$.callback(this,function(aO){aL=aO.retVal;var aN=aO.err;this.InsertWorkSet(this.GetWS().length,aL);if(aO.err||!aL){this.DeleteWorkSet(this.GetWS().length-1)}if(e.call(this)!==-1&&!aN&&this.GetWS().length<ap){ar.call(this)}})};if(aC!==-1&&this.GetWS().length<ap){ar.call(this)}$.callback(this,function(){if(av!==undefined){az[0]=av;this.SetCursor(az)}aC=e.call(this);if(aC!==-1&&this.GetWS().length>0&&this.GetWS().length<ap){aL=this.FindWorkSet(0);if(aB){this.SetActiveRow(aC+aB);$.callback(this,function(){aC=e.call(this);aF=true})}}$.callback(this,function(){aw.SetSize(ap);this.SetWSSize(ap);aA=ap})})}else{if(ap<aA&&aw.GetSize()===aA){aw.SetSize(ap);ax=0;for(aJ=0;aJ<aD;aJ++){aE=aK[aJ];if(aE){if(aE.GetSize()>ax){ax=aE.GetSize()}}}}else{ax=aA}if(ax<aA){while(this.GetWS().length>aC+1&&this.GetWS().length>ax){this.DeleteWorkSet(this.GetWS().length-1)}while(this.GetWS().length>ax){this.DeleteWorkSet(0)}if(ax<=aC){ag.call(this,this.GetWS().length-1);aC=e.call(this);aF=true}this.SetWSSize(ax);aA=ax;aw.SetBegRow(0,aH);aw.SetCurrRow(0,aH);aw.SetSize(ap);if(this.IsNotifyEnabled()&&aw.GetBusCompNotify()){aw.GetBusCompNotify().NotifyNewData()}}else{aw.SetSize(ap)}}$.callback(this,function(){for(aJ=0;aJ<aD;aJ++){var aN=false;aE=aK[aJ];if(!aE){continue}if(aC!==-1&&(aC<aE.GetBegRow()||aC>=(aE.GetBegRow()+aE.GetSize()))){if(this.GetWS().length<aE.GetSize()){aE.SetBegRow(0)}else{if(aC+aE.GetSize()<=this.GetWS().length){aE.SetBegRow(aC)}else{aE.SetBegRow(this.GetWS().length-aE.GetSize())}}aE.SetCurrRow(aE.GetBegRow());aN=true}if((aE.GetBegRow()+aE.GetSize()>aA)&&(aA>=aE.GetSize())){aE.SetBegRow(aA-aE.GetSize());aE.SetCurrRow(aE.GetBegRow());aN=true}if(aE.GetBusCompNotify()&&!ay&&(aq?true:aw!==aE)){if(aN){aE.GetBusCompNotify().NotifyNewData()}else{if(aF){aE.GetBusCompNotify().NotifyNewActiveRow()}}}}if(aC!==-1){aL=this.FindWorkSet(aC)}if(aF){this.OnActiveRowChanged()}if(!aq&&aI){this.EnableNotify()}})};al.prototype.AddReference=function(){this.AddRef();this.GetRef()};al.prototype.EndLife=function(){if(!SiebelApp.OfflineAppSettings.GetMode()){return j.EndLife.call(this)}var at=this.GetNotifyInfoArray();var ap=this.GetNotifyInfoArray().length;for(var ar=0;ar<ap;ar++){var aq=at[ar];if(aq){this.UnRegNotifyObj(ar)}}this.ResetNotifyArr();this.ResetInterface();j.EndLife.call(this)};al.prototype.UnRegNotifyObj=function(at){var ap;var ar=this.GetNotifyInfoArray();if(at<ar.length){ap=ar[at];if(ap){var aq=ap.GetBusCompNotify();if(aq){aq.Remove(this,at)}ap=null}ar.splice(at,1)}};al.prototype.RegNotifyObj=function(ap){var ar;var at;ar=new SiebelApp.S_App.NotifyInfo();ar.SetBusCompNotify(ap);var aq=this.GetActiveRow();if(aq>=0){ar.SetBegRow(0);ar.SetCurrRow(aq)}ar.SetSize(this.GetWorkSetSize());at=this.GetNotifyInfoArray().length;this.AddNotifyInfoArray(ar);if(ap){ap.Add(this,at)}return at};al.prototype.DeactivateFields=function(){var au=this.GetDeActableFieldList();var ap=au.length;var at=this.GetActFieldList();var ar=this.GetActivatedFieldList();var aw=this.GetFieldMap();var aq=this.GetFieldList();for(var av=0;av<ap;av++){if(at[au[av]]){aq.splice(aq.indexOf(at[au[av]]),1);delete at[au[av]]}if(ar.indexOf(au[av])!==-1){ar.splice(ar.indexOf(au[av]),1)}if(aw[au[av]]){delete aw[au[av]]}}};al.prototype.UpdateDeactivateableFldList=function(ar){var aq=this.GetDeActableFieldList();if(ar){var ap=ar.length;var au=this.GetFieldMap();for(var at=0;at<ap;at++){if(aq.indexOf(ar[at])===-1&&!au[ar[at]]){aq.push(ar[at])}}}};al.prototype.ActivateFields=function(){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.ActivateFields ")}var ar=this.GetSearchSpec();var aC=[];var au=[];var ay=this.GetSortSpec();var aK=[];var ap=[];var at=[];var av=[];var aA=[];var aw=[];var aq=[];var aF=0;var aG={};var aD=[];if(!this.IsBCFldsActivated()){this.SetBCFldsActivated(true);if(ao.IsTrue(this.GetDefn().ForceActive)){var az=this.GetDefn().Fields;for(var aJ in az){if(az[aJ]){aK[aF++]=aJ}}this.ActivateFieldList(aK)}else{at=this.GetFieldList();aK=at;var aH=aK.length;if(aH>0){for(var aE=0;aE<aH;aE++){ap[aE]=SiebelApp.S_App.LookupStringCache(aK[aE])}this.ActivateFieldList(ap)}aA=SiebelApp.S_App.Model.GetSystemFields();if(aA){this.ActivateFieldList(aA)}var ax=this.GetReqFieldsHasDefault();if(ax){this.ActivateFieldList(ax)}if(aw){this.ActivateFieldList(aw)}aq=this.GetAdminFields();if(aq.length>0){this.ActivateFieldList(aq)}var aB=this.GetLinkDef();if(aB){if(aB.primeIdFieldName){this.ActivateField(aB.primeIdFieldName)}}aF=0;aG=this.GetDefn();for(var aI in aG.Fields){if(ao.IsTrue(aG.Fields[aI].ForceActive)){aD[aF++]=aI}}if(aD.length>0){this.ActivateFieldList(aD)}}}};al.prototype.ActivateField=function(ap){var aq=[];if(ap instanceof Array){this.ActivateFieldList(ap)}else{aq=[ap];this.ActivateFieldList(aq)}};al.prototype.ActivateFieldList=function(au,aB){if(au){var aG=au.length;if(aG>0){for(var aF=0;aF<aG;aF++){var ar=au[aF];var aD=this.GetFieldDefn(ar);if(aD){if(!(this.GetFieldMap()[ar])){this.AddActField(ar)}else{var aI=this.GetFieldMap()[ar].IsActivated();
if(!(aI)){this.AddActField(ar)}}if(!aB){var aA=aD.pickMap;if(aA){var aE=aD.pickMap.length;var aL=[];var aK;for(var az=0;az<aE;az++){aK=[aA[az].FldName][0];if(aK!==ar&&aK!=="{"&&aK!==""){aL=aL.concat([aA[az].FldName])}}this.ActivateFieldList(aL,true)}}if(aD.IsCalculated){var av=aD.CalExpr;if(!ao.IsEmpty(av)){var at=SiebelApp.Query.GetFieldsFromExp("Calc",av);if(at){if(at.indexOf(ar)!==-1){at.splice(at.indexOf(ar),1)}this.ActivateFieldList(at)}}}var aw=aD.PreDefault;if(!ao.IsEmpty(aw)){var aO=SiebelApp.Query.GetFieldsFromExp("Pre",aw);if(aO[0]!==undefined){if(aO[0]!==ar&&(this.GetActivatedFieldList().indexOf(aO[0])===-1)){this.ActivateFieldList(aO)}}}var aq=aD.PostDefault;if(!ao.IsEmpty(aq)){var aH=SiebelApp.Query.GetFieldsFromExp("Post",aq);if(aH[0]!==undefined){if(aH[0]!==ar&&(this.GetActivatedFieldList().indexOf(aH[0])===-1)){this.ActivateFieldList(aH)}}}if(aD.bDepArray.length>0){var aN=[];for(var aM=0;aM<aD.bDepArray.length;aM++){if((this.GetActivatedFieldList().indexOf(aD.bDepArray[aM])===-1)&&aD.bDepArray[aM]!==ar){aN.push(aD.bDepArray[aM])}}if(aN.length>0){this.ActivateFieldList(aN)}}if(aD.fDepArray.length>0){var ay=[];for(var aJ=0;aJ<aD.fDepArray.length;aJ++){if((this.GetActivatedFieldList().indexOf(aD.fDepArray[aJ])===-1)&&(aD.fDepArray[aJ]!==ar)){ay.push(aD.fDepArray[aJ])}}if(ay.length>0){this.ActivateFieldList(ay)}}}else{k.CcfLogEvent([J,52,0,27,ar,this.GetName()])}}}var ap=this.GetActFieldList();var aC=this.GetFieldList();for(var ax in ap){if(ap[ax]){if(aC.indexOf(ap[ax])===-1){aC.push(ap[ax])}d.call(this,ax)}}}};al.prototype.ExprParser=function(ap){};al.prototype.GetAdminFields=function(ap){var aq=[];return aq};al.prototype.InterpolateBCState=function(ap){G.call(this);$.callback(this,function(ar){var aq=ar.retVal;ap.AddChild(aq)})};al.prototype.CanWriteRecord=function(){};al.prototype.CanUpdateRecord=function(){};al.prototype.CanAssociate=function(){return true};al.prototype.CanQuery=function(){return true};al.prototype.CanMergeRecords=function(){return true};al.prototype.CanDelete=function(){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.CanDelete ")}var ap=false;var at;var aq=false,ar=false;if(this.GetAspectBCReadFld()){this.FieldValue(this.GetAspectBCReadFld());$.callback(this,function(av){at=av.retVal;if(at){if(at==="Y"){$.setReturnValue({err:false,retVal:false});var au=true;return}}})}$.callback(this,function(){if(!aq){if(!this.CheckActiveRow()){$.setReturnValue({err:false,retVal:false});return}if(this.IsNewRecordPending()){$.setReturnValue({err:false,retVal:true});return}var aA=this.GetLinkDef();var az=e.call(this);if(!this.IsNewRecordPending()){if(!this.IsLocked()){$.setReturnValue({err:false,retVal:false});return}if((this.GetAdminMode()&&this.m_bAdminNoDelete)){if(!aA||aA.interTableName||aA.InterChildDelete){$.setReturnValue({err:false,retVal:false});return}}if(this.GetFldNoDelete()){var ax;var ay=null;ay=this.FindWorkSet(az);this.FieldValue(ay,this.GetFldNoDelete());ar=true;$.callback(this,function(aD){if(aD.err){$.setReturnValue(aD)}else{var aC=aD.retVal;if(aC==="Y"&&(!aA||aA.interTableName)){$.setReturnValue({err:false,retVal:false});return}}})}}if(!ar){if(!this.IsExecuted()||az<0){$.setReturnValue({err:false,retVal:ap});return}if(!this.GetAdminMode()&&(this.IsBCReadOnlyFieldSet()||this.IsParentReadOnlyFieldSet())){$.setReturnValue({err:false,retVal:ap});return}var av=this.GetParentBusComp();if(this.m_busCompType===(SiebelApp.Offlineconstants.get("BCTYPE_PICKLIST"))){var aw=SiebelApp.S_App.Applet.ActiveControl().GetPickApplet();var au=SiebelApp.Metadata.GetPickListDef(aw);ap=(!(au.NoDelete())&&!av.IsInQueryState());$.setReturnValue({err:false,retVal:ap});return}var aB=this.GetLinkSrcFieldName();if(av&&aB&&aB==="Id"){if(m.call(av,this.GetName())){$.setReturnValue({err:false,retVal:ap});return}}if((aA&&aA.NoDelete)){ap=this.GetAdminMode()&&!aA.interTableName&&!aA.NoInterDelete}else{ap=true}if(ap){ap=this.GetAdminMode()||!(this.GetDefn().NoUpdate)||(aA&&!aA.interTableName)}if(!ap||this.GetAdminMode()){$.setReturnValue({err:false,retVal:ap});return}if(aA&&aA.interTableName&&!aA.NoInterDelete){$.setReturnValue({err:false,retVal:ap});return}if(this.GetDefn().OwnerDel){$.setReturnValue({err:"",retVal:false});return}else{$.setReturnValue({err:false,retVal:ap});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.CanDelete ")}}}}})};al.prototype.IsLocked=function(){return true};al.prototype.CanDeleteX=function(){return true};al.prototype.CanDeferDelete=function(){return false};al.prototype.HasAssocList=function(){return false};al.prototype.CanUpdateField=function(ax){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.CanUpdateField ")}var aq;var aw;var av;var au;var at;var ar=false;if(this.CanInsert()&&this.IsInsertPending()){au=true}else{this.CanUpdateX(true);$.callback(this,function(ay){au=ay.retVal})}var ap=function(){if(!au){$.setReturnValue({err:false,retVal:false});return}aq=this.GetFieldMap()[ax];if(!aq){$.setReturnValue({err:false,retVal:au});return}this.IsFieldReadOnly(aq);$.callback(this,function(ay){if(ay.retVal){au=false;$.setReturnValue({err:false,retVal:au});return}else{$.setReturnValue({err:false,retVal:au});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.CanUpdateField ")}}})};$.callback(this,function(){ap.call(this)})};al.prototype.FinishRecord=function(){};al.prototype.CheckActiveRow=function(){var ap=e.call(this);if(ap>=0){return(true)}else{return(false)}};al.prototype.UndoRecord=function(){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.UndoRecord ")}if(F.GetMode()===true){var ap;this.GetIdValueX();this.SetNewTxn("");this.SetTxnId("");this.SetEmptyFNm();this.SetOpType("");$.callback(this,function(ar){if(!ar.err){var au=ar.retVal;if(!this.IsCommitPending()&&!this.IsDeletePending()){return}if(this.IsDeletePending()){this.WriteRecord();$.callback(this,function(av){this.ClearUpdate();$.setReturnValue(av)});return}if(this.IsInsertPending()){this.DeleteRecordX(au);$.callback(this,function(av){$.setReturnValue(av);return})}var aq=function(){var av=this.GetOrigRecVal();if(av){var ax=this.GetWS();var aw=this.GetActiveRow();if(ax&&ax[aw].Id===av.Id){ax[aw]=av}this.SetOrigRecVal("")}this.SetCommitPending(false);this.SetNewRecPending(false);this.OnActiveRowChanged();this.EventChangeRecord();this.NotifyNewRecordData()};var at;at=this.GetParentBusComp();if(at&&at.IsInsertPending()){at.UndoRecord();$.callback(this,aq)}else{aq.call(this)}}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.UndoRecord ")}})}else{return(j.UndoRecord.call(this))}};al.prototype.FindWorkSet=function(ar){var aq={};var ap=this.GetWS();if(ar<ap.length){aq=ap[ar]}else{aq=null}return aq};al.prototype.SQLUpdateRecord=function(){};al.prototype.SQLCommitPending=function(){};al.prototype.FieldValue=function(av,au){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.FieldValue")
}var at=CCFMiscUtil_CreatePropSet();at.SetProperty("inputParam1",av);var ap={};ap[N]=this.GetName();ap[u]=A;ap[R]="FieldValue";ap[f]=this;at.SetProperty("FieldName",av);at.SetProperty("inputParam2",au);var ar={};var aq=[];ap[an]=a;SiebelApp.S_App.Model.InvokeRegisteredSvc(ap,at);$.callback(this,function(aC){if(!aC.err){ar=aC.retVal;if(ar.Outputargs&&(ar.Outputargs).GetProperty("Invoked")&&(ar.Outputargs).GetProperty("Invoked").toString()==="true"){var aJ=(ar.Outputargs).GetProperty("RetVal");if(aJ){$.setReturnValue({err:err,retVal:aJ})}else{$.setReturnValue({err:err,retVal:""})}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.FieldValue")}return}if(ar.Outputargs&&at){(ar.Outputargs).SetType(a);at.AddChild(ar.Outputargs)}var az=null;if(!au&&this.CheckActiveRow()){var aA=e.call(this);au=this.FindWorkSet(aA)}if(au){var aI=false;var ay=av;var aH={};aH=this.GetFieldMap()[ay];if(aH){if(this.IsActiveFieldListDirty()&&!this.IsInsertPending()&&!aH.IsCalc()&&!(aH.IsSystemField())&&this.GetDefn().Dstnct){aI=true}}else{if(this.IsActiveFieldListDirty()&&!this.IsInsertPending()){aI=true}}if(!aI){if(av==="SSA Primary Field"){if(!this.GetLinkDef()||this.GetLinkDef().primeIdFieldName===null){az=null}else{var aB;var ax=function(){this.FieldValue(B.get("SWE_ROW_ID_FIELD"),au);$.callback(this,function(aL){var aK=aL.retVal;az=(aK===aB)?"Y":"N"})};if(this.GetParentBusComp()){this.GetParentBusComp().FieldValue(this.GetLinkDef().primeIdFieldName);$.callback(this,function(aK){aB=aK.retVal;ax.call(this)})}else{ax.call(this)}}}else{var aw;var aG=null;var aF;if(!au){if(ah){var aE;aG=this.GetFieldDefn(B.get("SWE_ROW_ID_FIELD"));this.FieldValue(aG.GetName());$.callback(this,function(aL){var aK=aL.retVal;this.FieldValue(B.get("SWE_ROW_ID_FIELD"),ah);$.callback(this,function(aM){var aN=aM.retVal;if(aK===aN){au=ah}})})}}$.callback(this,function(){if(!aH||aH.IsInactive(1)){aq.push(av);aq.push(this.GetName());SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrFieldInActive",aq,"","","",0,73);$.setReturnValue({err:"SSAOMErrFieldInActive",retVal:""});return}if(au){az=au[SiebelApp.OfflineUtils.RemoveNonAlphaChars(av)]}if(!az){if(aH.IsCalc()&&this.GetFieldDefn(av).CalExpr){if(!this.GetFieldDefn(av).CalcQuery){var aK=SiebelApp.Query.Parse(this.GetFieldDefn(av).CalExpr);this.GetFieldDefn(av).CalcQuery=aK}az=SiebelApp.Query.Evaluate(this.GetFieldDefn(av).CalcQuery,this,null,au);if(au&&av==="SSA Primary Field"){au[SiebelApp.OfflineUtils.RemoveNonAlphaChars(av)]=az}else{if(!au){this.GetFieldValue(av)}}}}})}}else{aq.push(av);aq.push(this.GetName());SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrFieldInActive",aq,"","","",0,73);$.setReturnValue({err:"SSAOMErrFieldInActive",retVal:""});return}}else{SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("BCErrNoActiveRow","","","","",0,73);if(!ao.IsEmpty(av)&&!ao.IsEmpty(this.GetFieldDefn(av))){az=SiebelApp.Query.Parse(this.GetFieldDefn(av).CalExpr,au)}$.setReturnValue({err:true,retVal:""});return}var aD=function(){ap[an]=r;at.SetProperty("RetVal",az);SiebelApp.S_App.Model.InvokeRegisteredSvc(ap,at);$.callback(this,function(aK){ar=aK.retVal;if((ar.Outputargs)&&(ar.Outputargs).GetProperty("Invoked")&&(ar.Outputargs).GetProperty("Invoked").toString()==="true"){az=(ar.Outputargs).GetPropertyAsStr("RetVal");if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.FieldValue")}}$.setReturnValue({err:false,retVal:az})})};$.callback(this,aD)}else{$.setReturnValue(aC)}})};al.prototype.IsInInsertMode=function(){return true};al.prototype.Evaluate=function(at,ar,aq,ap){return true};al.prototype.IsActiveFieldListDirty=function(){var ap=this.GetExtObjProp("m_bActiveFieldListDirty");if(!ap){this.SetExtObjProp("m_bActiveFieldListDirty",true)}return(this.GetExtObjProp("m_bActiveFieldListDirty"))};al.prototype.SetActiveFieldListDirty=function(ap){this.SetExtObjProp("m_bActiveFieldListDirty",ap)};al.prototype.SetFieldValueX=function(ay,aq,ax,ap,ar){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.SetFieldValueX")}if(!this.GetFieldDefn(ay)){k.CcfLogEvent([J,55,0,9,ay,this.GetName()]);var aw=[];aw.push(ay);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("BCErrNoSuchField",aw,"","","",0,9);$.setReturnValue({err:"BCErrNoSuchField",retVal:false});return}if(ax===undefined||ax===null){ax=false}if(ap===undefined||ap===null){ap=false}if(ar===undefined||ar===null){ar=false}var av;var au=CCFMiscUtil_CreatePropSet();var at={};var aw=[];au.SetProperty("inputParam1",ay);au.SetProperty("inputParam2",aq);au.SetProperty("inputParam3",ax);au.SetProperty("inputParam4",ap);au.SetProperty("inputParam5",ar);at[N]=this.GetName();at[u]=A;at[R]="SetFieldValue";at[f]=this;at[an]=a;SiebelApp.S_App.Model.InvokeRegisteredSvc(at,au);$.callback(this,function(aD){if(!aD.err){av=aD.retVal;if(av.Outputargs){if((av.Outputargs).GetPropertyAsStr("Invoked")==="true"){$.setReturnValue({err:aD.err,retVal:av.Outputargs});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.SetFieldValueX")}return}(av.Outputargs).SetType(a);au.AddChild(av.Outputargs)}if(!this.CheckActiveRow()){P.call(this,ay);$.setReturnValue({err:true,retVal:false});return}var aA=null,aC=false,aE=null;aA=this.ValidateFieldDef(ay);if(!aA){P.call(this,ay);$.setReturnValue({err:true,retVal:false});return}var az=this.GetFieldMap()[ay];if(!az){k.CcfLogEvent([J,55,0,9,ay,this.GetName()])}if(az.IsInactive(1)){$.setReturnValue({err:false,retVal:false});var aB=[];aB.push(ay);aB.push(this.GetName());SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrFieldInActive",aB,"","","",0,9);$.setReturnValue({err:"SSAOMErrFieldInActive",retVal:false});Y.call(this,aC,ay);return}if(!ao.IsEmpty(aq)){aE=$.trim(aq);aq=aE}else{aE=""}if(!az.IsCalc()&&!ax&&!ao.IsEmpty(aE)){if(aE.length>az.GetLength()){aB.push(ay);aB.push(az.GetLength());SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrDataTooLong",aB,"","","",0,9);P.call(this,ay);$.setReturnValue({err:"SSAOMErrDataTooLong",retVal:false});return}}this.FieldValue(ay);$.callback(this,function(aH){if(!aH.err){var aG=aH.retVal;if(!az.AreValuesEqual(aq,aG)){Y.call(this,aC,ay);$.setReturnValue({err:false,retVal:false});return}var aF=true;if(!ax){U.call(this,az,ay,aE,aq,aC);$.callback(this,function(aJ){aJ=aJ.retVal;var aI=aJ.bContinue;if(aI){aC=aJ.bPicked;E.call(this,ay,aC,aq);$.callback(this,function(aK){if(!aK.err){ak.call(this,ay,aC,at,au);$.callback(this,function(aL){$.setReturnValue(aL)})}else{$.setReturnValue(aK)}})}else{$.setReturnValue(aJ.retObj)}})}else{if(this.IsDeletePending()){this.WriteRecord();$.callback(this,function(aI){if(aI.err){$.setReturnValue(aI)}else{E.call(this,ay,aC,aq)}})}else{E.call(this,ay,aC,aq)}$.callback(this,function(aI){if(!aI.err){ak.call(this,ay,aC,at,au);$.callback(this,function(aJ){$.setReturnValue(aJ)})}else{$.setReturnValue(aI)}})}}else{$.setReturnValue(aH)}})}else{$.setReturnValue(aD)}})};function ak(at,aq,ap,ar){this.OnSetFieldValue(at);Y.call(this,aq,at);
ap[an]=r;ar.SetProperty("RetVal",true);SiebelApp.S_App.Model.InvokeRegisteredSvc(ap,ar);$.callback(this,function(av){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.SetFieldValueX ")}var au=av.err?av.retVal:true;$.setReturnValue({err:false,retVal:au})})}function U(ap,aw,av,aq,at){var ar={};ar.bContinue=true;ar.bPicked=at;var au;if(this.IsFieldReadOnly(ap)){errParamArray.push(aw);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrFieldReadOnly",errParamArray,"","","",0,9);P.call(this,aw);au={err:"SSASqlErrFieldReadOnly",retVal:false};ar.bContinue=false;ar.retObj=au;$.setReturnValue({err:true,retVal:ar});return}this.ValidatePickValue(aw,av);$.callback(this,function(ax){if(ax.err){P.call(this,aw);ar.bContinue=false;ar.retObj=ax;ar.bPicked=at;$.setReturnValue({err:true,retVal:ar})}else{at=ax.retVal;if(at){Y.call(this,at,aw);ar.bContinue=false;ar.retObj=ax;ar.bPicked=at;$.setReturnValue({err:false,retVal:ar})}else{at=this.ValidateAssocValue(aw,av);if(at){Y.call(this,at,aw);ar.bContinue=false;ar.retObj={err:false,retVal:false};ar.bPicked=at;$.setReturnValue({err:false,retVal:ar})}else{ar.bContinue=true;ar.retObj={err:false,retVal:false};ar.bPicked=at;$.setReturnValue({err:false,retVal:ar})}}}})}function E(ax,at,aq){var ap;var ay;var au=null;var av=[];if(ax==="SSA Primary Field"){au=this.GetLinkDef();ay=au.primeIdFieldName;if(au===null||ao.IsEmpty(ay)){errParamArray.push(ax);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("BCErrNoSuchField",errParamArray,"","","",0,9);P.call(this,at,ax);$.setReturnValue({err:"BCErrNoSuchField",retVal:false})}else{this.GetIdValueX();$.callback(this,function(aA){if(!aA.err){ap=aA.retVal;var az=this.GetParentBusComp();if(!az.IsCommitPending()){az.UpdateRecordX();$.callback(this,function(){commitParentPrimary=true})}$.callback(this,function(){az.SetFieldValueX(ay,ap,false,true)})}})}}else{var ar=this.GetFieldMap()[ax];if(ar){if(!ar.IsSystemField()&&!ar.IsCalc()&&(ar.GetTableName()==="m_pSqlBCDef_m_tableName")){var aw;this.FieldValue(ax);$.callback(this,function(aA){if(!aA.err){aw=aA.retVal;if(!aw||(aq!==aw)){var az=true;this.SetUpdated(az)}}})}}else{k.CcfLogEvent([J,55,0,9,ax,this.GetName()])}$.callback(this,function(){bDeferFieldValidations=!ar.IsConstrainingField()&&!ar.IsPostChanges();av.push(ar);if(ar.IsCalc()&&!ao.IsEmpty(ar.GetCalcExpr())&&!ao.IsEmpty(ar.GetPickList())){errParamArray.push(ax);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrFieldReadOnly",errParamArray,"","","",0,9);$.setReturnValue({err:"SSASqlErrFieldReadOnly",retVal:false})}else{t.call(this,ax,aq);$.callback(this,function(aA){var az=aA.retVal;Q.call(this,ax,az);$.setReturnValue(aA)})}})}}function t(au,at){var ar=this.GetFieldMap()[au].GetName();var aB;var aH=this.GetFieldList();var aF=this.GetWS();var aA=e.call(this);var aw={};for(var aC=0;aC<aH.length;aC++){aB=aH[aC];var aG=SiebelApp.S_App.LookupStringCache(aB);aw[SiebelApp.OfflineUtils.RemoveNonAlphaChars(aG)]=aF[aA][SiebelApp.OfflineUtils.RemoveNonAlphaChars(aG)]}for(var av=0;av<aH.length;av++){aB=aH[av];var ax=SiebelApp.S_App.LookupStringCache(aB);var aD;aw[SiebelApp.OfflineUtils.RemoveNonAlphaChars(ax)]=aF[aA][SiebelApp.OfflineUtils.RemoveNonAlphaChars(ax)];ar=ar.toString();if(ar===aB.toString()){aD=aw[SiebelApp.OfflineUtils.RemoveNonAlphaChars(ax)];if(ao.IsEmpty(aD)){aD=""}if(ao.IsEmpty(at)){at=""}aw[SiebelApp.OfflineUtils.RemoveNonAlphaChars(ax)]=at;aF[aA]=aw;var aq=SiebelApp.AjaxRequestMgr.GetActiveRequestObj();var aI=this.GetFieldDefn(au);if(aq&&aD!==at&&aI.IsCalculated!=="T"&&!aI.ReadOnly){if(this.GetNewTxn()!==""){aD=""}var ay;var az;at=at.replace(/\\/g,"\\3").replace(/\|/g,"\\0").replace(/\^/g,"\\1").replace(/\~/g,"\\2").replace(/&/g,"\\4");aD=aD.replace(/\\/g,"\\3").replace(/\|/g,"\\0").replace(/\^/g,"\\1").replace(/\~/g,"\\2").replace(/&/g,"\\4");var aE=this.GetFieldDefn(au);var ap=(aE.JoinInfo&&aE.JoinInfo.JoinType==="J"&&!(ao.IsTrue(aE.Required)));if(!ap){ay=URLEncode(H.call(this,au,at));az=URLEncode(H.call(this,au,aD));aD=az+"|"+ay;aD=this.ReplaceAmp(aD);this.SetOldFNm(au);this.SetOldFVal(au,aD)}}break}else{continue}}v.call(this,au,this.GetWS()[this.GetActiveRow()]);$.callback(this,function(aJ){aJ.retVal=aw;$.setReturnValue(aJ)})}function Q(av,au){if(!au){return}var at=this.GetDefn().Fields[av].fDepArray;if(at){var aq=0;var ap=at.length;var ar=function(){if(this.GetDefn().Fields[at[aq]].IsCalculated==="T"){t.call(this,at[aq],"");$.callback(this,function(aw){aq++;if(aq<ap){ar.call(this)}})}else{aq++;if(aq<ap){ar.call(this)}}};if(aq<ap){ar.call(this)}}}al.prototype.ValidateFieldDef=function(ar){var aq;var ap=[];aq=this.GetFieldMap()[ar];if(aq===undefined){ap.push(ar);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("BCErrNoSuchField",ap,"","","",0,74);return(false)}else{return(true)}};function Y(aq,ap){if(!aq){this.NotifyNewData(ap)}else{this.NotifyNewData(ap)}}function P(ap){if(this.GetActiveRow()>=0){this.NotifyNewData(ap)}}al.prototype.ValidateAssocValue=function(aq,ap){};al.prototype.IsUndoRedoInProgress=function(){return(false)};al.prototype.AddUndo=function(ap){};al.prototype.SetUpdated=function(ar){var ap=false;var aq=false;if(ah){if(ah!==ar){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrUpdMode","","","","",0,75);$.setReturnValue({err:false,retVal:false});return}}else{this.UpdateRecordX(ar);$.callback(this,function(){ap=true})}$.callback(this,function(){var at=true;if(ap){if((aq=this.WriteRecord())==="SSASqlErrWriteConflict"){aq=this.WriteRecord()}if(!aq){$.setReturnValue({err:false,retVal:false});return}}$.setReturnValue({err:true,retVal:false})})};al.prototype.UpdateParentRecord=function(ap){if(ap===null||ap===undefined){ap=false}if(!this.IsExecuted()){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrNotExecuted","","","","",0,76);$.setReturnValue({err:"SSASqlErrNotExecuted",retVal:false})}if(!ap&&!(this.CanUpdateParent())){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrNoUpdate","","","","",0,76);$.setReturnValue({err:"SSAOMErrNoUpdate",retVal:false})}this.UpdateRecordX();$.callback(this,function(){this.SetCommitPending(true);this.m_redoRecordAction="REDO_RECORD_NONE";$.setReturnValue({err:false,retVal:true})})};al.prototype.CanUpdateParent=function(av){var ar=false;var at=null;var aq;aq=this.GetParentBusComp();if(av===null||av===undefined){av=true}if(av&&(this.GetSelection())<0){return ar}if(this.IsNewRecordPending()){ar=true;return ar}if(av&&!V&&(this.IsBCReadOnlyFieldSet()||this.IsParentReadOnlyFieldSet())){return ar}if(this.GetBusCompType()===(SiebelApp.Offlineconstants.get("BCTYPE_PICKLIST"))){var au=SiebelApp.S_App.Applet.ActiveControl().GetPickApplet();var ap=SiebelApp.Metadata.GetPickListDef(au);ar=(!(ap.NoUpdate())&&!aq.IsInQueryState());return ar}var aw=this.GetLinkSrcFieldName();if(av&&aq&&aw==="Id"&&aw){if(m.call(aq,this.GetName())){return ar}}at=this.GetLinkDef();ar=!(at&&at.NoUpdate);if(ar){ar=(V||!(this.GetDefn().NoUpdate))}return ar};al.prototype.UpdateRecordX=function(aq){if(aq===null||aq===undefined){aq=true
}if(!this.IsExecuted()){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrNotExecuted","","","","",0,68);$.setReturnValue({err:"SSASqlErrNotExecuted",retVal:false});return}var ap=function(){this.SetCommitPending(true);this.FinishRecord();if(this.CheckActiveRow()){var ar=this.GetSelection();var at=this.FindWorkSet(ar,at)}this.SetExtObjProp("IsEditRecord",false);$.setReturnValue({err:false,retVal:true})};if(!aq){this.CanUpdateX();$.callback(this,function(ar){if(!ar.retVal){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrNoUpdate","","","","",0,68);$.setReturnValue({err:"SSAOMErrNoUpdate",retVal:false})}else{ap.call(this)}})}else{ap.call(this)}};al.prototype.GetBatchMode=function(){var ap;return(ap)};al.prototype.IsVBC=function(){if(this.GetDefn().TableName===""){return true}return false};al.prototype.CanUpdateX=function(aq,au){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.CanUpdateX ")}var ar;var at=CCFMiscUtil_CreatePropSet();var ap={};at.SetProperty("inputParam1",aq);at.SetProperty("inputParam2",au);ap[N]=this.GetName();ap[u]=A;ap[R]="CanUpdateX";ap[f]=this;ap[an]=a;SiebelApp.S_App.Model.InvokeRegisteredSvc(ap,at);$.callback(this,function(aA){ar=aA.retVal;if(ar.Outputargs&&(ar.Outputargs).GetProperty("Invoked")&&(ar.Outputargs).GetProperty("Invoked").toString()==="true"){var aD=ar.Outputargs.GetProperty("RetVal");var aw=false;if(ao.IsTrue(aD)){aw=true}else{aw=false}$.setReturnValue({err:aA.err,retVal:aw});return}if(!aA.err){ar=aA.retVal;if(ar.Outputargs){(ar.Outputargs).SetType(a);at.AddChild(ar.Outputargs)}var aE=this.GetPickAppletSrcInfo();if(this.GetIsPopup()){if(!aE&&!this.IsVBC()){$.setReturnValue({err:false,retVal:false});return}}if(au!==undefined){this.CanUpdateField(au);$.callback(this,function(aG){$.setReturnValue(aG)})}else{var aC=false;var aF=this.GetParentBusComp();if(aq===null||aq===undefined){aq=true}if(aq&&(e.call(this))<0){$.setReturnValue({err:false,retVal:aC});return}if(this.IsNewRecordPending()){aC=true;$.setReturnValue({err:false,retVal:aC});return}if(aq&&!V&&(this.IsBCReadOnlyFieldSet()||this.IsParentReadOnlyFieldSet())){$.setReturnValue({err:false,retVal:aC});return}if(this.GetIsPopup()){if(aE&&!this.IsVBC()){var ay=aE.SrcApplet;var av=aE.SrcAppletFld;ay=SiebelApp.S_App.GetActiveView().GetApplet(ay);var az=ay.GetBusComp();var ax=az.GetDefn().Fields[av].PickListName;if(ax){ax=SiebelApp.Metadata.GetPickListDef(ax);$.setReturnValue({err:false,retVal:(!ax.NoUpdate&&!az.IsInQueryState())});return}}}var aB=this.GetLinkSrcFieldName();if(aq&&aF&&aB){if(m.call(this,this.GetName())){$.setReturnValue({err:false,retVal:aC});return}}aC=!(this.GetLinkDef()&&this.GetLinkDef().NoUpdate);if(!this.GetLinkDef()){aC=true}if(aC){aC=V||!(this.GetDefn().NoUpdate)}$.setReturnValue({err:false,retVal:aC});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.CanUpdateX ")}}}else{$.setReturnValue(aA)}})};al.prototype.IsBCReadOnlyFieldSet=function(){var ap=false;return ap};al.prototype.IsParentReadOnlyFieldSet=function(){var ap=false;return ap};al.prototype.GetLinkSrcFieldName=function(){if(this.GetLinkDef()){return(this.GetLinkDef().srcFieldName)}else{return null}};al.prototype.IsFieldReadOnly=function(aq){var ap=false;if(aq){ap=ao.IsTrue(aq.IsReadOnly());if(!ap){var ar=this.GetParentBusComp();var au=SiebelApp.S_App.LookupStringCache(aq.GetName()),at;if(au==="SSA Primary Field"&&ar){at=ar.CanInsert(au);if(!at){ar.CanUpdateField(au);$.callback(this,function(av){$.setReturnValue({err:false,retVal:!(av.retVal)})})}else{$.setReturnValue({err:false,retVal:false})}}else{at=this.CanInsert(au);if(!at){this.CanUpdateField(au);$.callback(this,function(av){$.setReturnValue({err:false,retVal:!(av.retVal)})})}else{$.setReturnValue({err:false,retVal:false})}}}else{$.setReturnValue({err:false,retVal:ap})}}else{$.setReturnValue({err:false,retVal:true})}$.setReturnValue({err:false,retVal:ap})};al.prototype.CanInsert=function(au){if(F.GetMode()===true){var aq=false;var at=this.GetParentBusComp();if(au===null||au===undefined){au=true}if(au&&(this.IsParentReadOnlyFieldSet())){return aq}if(this.GetBusCompType()===(SiebelApp.Offlineconstants.get("BCTYPE_PICKLIST"))){var ar=SiebelApp.S_App.Applet.ActiveControl().GetPickApplet();var ap=SiebelApp.Metadata.GetPickListDef(ar);aq=(!(ap.NoUpdate())&&!at.IsInQueryState());return aq}if(au){if(!this.IsExecuted()){return aq}var av=this.GetLinkSrcFieldName();if(au&&at&&av){if(m.call(this,this.GetName())){return aq}}}if(this.GetDefn().NoUpdate){return false}return true}else{return(j.CanInsert.call(this,au))}};al.prototype.ValidateFieldValue=function(){};al.prototype.OnSetFieldValue=function(ap){if(ap===x){this.NotifyBeginLongOp();this.NotifyNewPrimary(ap);this.NotifyNewData(ap);this.NotifyEndLongOp()}};al.prototype.NotifyBeginLongOp=function(ap){};al.prototype.NotifyEndLongOp=function(ap){};al.prototype.NotifyNewPrimary=function(ap){};al.prototype.NotifyNewData=function(ar){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.NotifyNewData ")}var ap="";var aq={};aq[N]=this.GetName();aq[u]=A;aq[R]="NotifyNewData";aq[f]=this;var au=CCFMiscUtil_CreatePropSet();au.SetProperty("inputParam1",ar);var at;aq[an]=a;at=SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(ay){if(!ay.err){at=ay.retVal;if((at.Outputargs)&&(at.Outputargs).GetProperty("Invoked")&&(at.Outputargs).GetProperty("Invoked").toString()==="true"){$.setReturnValue({err:ay.err,retVal:at.Outputargs});return}if(at.Outputargs&&au){(at.Outputargs).SetType(a);au.AddChild(at.Outputargs)}if(!ar){ar=null}else{if(!(this.IsNotifySysEnabled())){return}this.NotifyNewDataWS(ar)}var aD;var aE;var av=this.GetNotifyInfoArray();var aF=av.length;if(this.IsNotifyEnabled()){for(var az=0;az<aF;az++){aD=av[az];if(aD){var aG=aD.GetBusCompNotify();if(aG){aG.NotifyNewData(ar);if(!ar&&this.GetMultiSelectMode()){aG.NotifyChangeSelection()}}}}}if(ar&&this.GetFieldDefn(ar)&&this.GetFieldDefn(ar).fDepArray){var aC=this.GetFieldDefn(ar).fDepArray;var ax=aC.length;var aB=0;var aH;var aA;var aw=function(){if(this.GetDefn().Fields[aC[aB]].IsCalculated==="T"){aH=e.call(this);t.call(this,aC[aB],"");$.callback(this,function(aI){aA=this.FindWorkSet(aH);this.FieldValue(aC[aB],aA);$.callback(this,function(aJ){if(!aJ.err){t.call(this,aC[aB],aJ.retVal);$.callback(this,function(aK){if(!aK.err){this.NotifyNewData(aC[aB]);aB++;if(ax>aB){aw.call(this)}}})}})})}};if(ax){aw.call(this)}}aq[an]=r;SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(aI){$.setReturnValue(aI);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.NotifyNewData ")}})}else{$.setReturnValue(ay)}})};al.prototype.NotifyNewDataWS=function(ar){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.NotifyNewDataWS ")}var ap="";var aq={};aq[N]=this.GetName();aq[u]=A;aq[R]="NotifyNewData";aq[f]=this;var au=CCFMiscUtil_CreatePropSet();au.SetProperty("inputParam1",ar);
var at;aq[an]=a;SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(ay){if(!ay.err){at=ay.retVal;if((at.Outputargs)&&(at.Outputargs).GetProperty("Invoked")&&(at.Outputargs).GetProperty("Invoked").toString()==="true"){$.setReturnValue({err:ay.err,retVal:at.Outputargs});return}if(at.Outputargs&&au){(at.Outputargs).SetType(a);au.AddChild(at.Outputargs)}var ax;if(!ar){return}var aA=this.GetNotifyInfoArray();var av=aA.length;for(var aw=0;aw<av;aw++){ax=aA[aw];if(ax){var az=ax.GetBusCompNotify();if(az){az.NotifyNewDataWS(ar)}}}aq[an]=r;SiebelApp.S_App.Model.InvokeRegisteredSvc(aq,au);$.callback(this,function(aB){$.setReturnValue(aB);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.NotifyNewDataWS ")}})}else{$.setReturnValue(ay)}})};al.prototype.NotifySelModeChange=function(at){var ar;if(this.IsNotifyEnabled()){var av=this.GetNotifyInfoArray();var ap=av.length;for(var aq=0;aq<ap;aq++){ar=av[aq];if(ar){var au=ar.GetBusCompNotify();if(au){au.NotifySelModeChange(at)}}}}};al.prototype.NotifyNewSelIds=function(){var at;var ar=this.GetSelRowIdArray();if(this.IsNotifyEnabled()){var av=this.GetNotifyInfoArray();var ap=av.length;for(var aq=0;aq<ap;aq++){at=av[aq];if(at){var au=at.GetBusCompNotify();if(au){au.NotifyNewSelIds(ar)}}}}};al.prototype.NotifyChangeSelection=function(){var ar;if(this.IsNotifyEnabled()){var au=this.GetNotifyInfoArray();var ap=au.length;for(var aq=0;aq<ap;aq++){ar=au[aq];if(ar){var at=ar.GetBusCompNotify();if(at){at.NotifyChangeSelection()}}}}};al.prototype.NotifyScrollData=function(at,aq){var au;if(this.IsNotifyEnabled()){var aw=this.GetNotifyInfoArray();var ap=aw.length;for(var ar=0;ar<ap;ar++){au=aw[ar];if(au){var av=au.GetBusCompNotify();if(av){av.NotifyScrollData(at,aq)}}}}};al.prototype.NotifyNewSelection=function(at){var ar;if(this.IsNotifyEnabled()){var av=this.GetNotifyInfoArray();var ap=av.length;for(var aq=0;aq<ap;aq++){ar=av[aq];if(ar){var au=ar.GetBusCompNotify();if(au){au.NotifyNewSelection(at)}}}}else{this.NotifyStateChanged("activeRow",e.call(this))}};al.prototype.NotifyStateChanged=function(ar,au){var ax=false;var at;if(!this.IsNotifySysEnabled()){if(ar==="activeRow"||ar==="bExecuted"||ar==="bNewRecPending"||ar==="bCommitPending"){return ax}}var aw=this.GetNotifyInfoArray();var ap=aw.length;for(var aq=0;aq<ap;aq++){at=aw[aq];if(at){var av=at.GetBusCompNotify();if(av){av.NotifyStateChanged(ar,au)}}ax=true}return ax};al.prototype.NotifyNewActiveRow=function(){var ar;if(this.IsNotifyEnabled()){var au=this.GetNotifyInfoArray();var ap=au.length;for(var aq=0;aq<ap;aq++){ar=au[aq];if(ar){var at=ar.GetBusCompNotify();if(at){at.NotifyNewActiveRow()}}}}};al.prototype.WriteRecord=function(aA){if(SiebelApp.OfflineAppSettings.GetMode()===true){var ar;var aB=[];var ap=[];var ax=[];var av;var aC;var aq;var aw;var au=CCFMiscUtil_CreatePropSet();var ay=this.GetBCTableInsertState();var at={};var az;at[N]=this.GetName();at[u]=A;at[R]="WriteRecord";at[f]=this;if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.WriteRecord")}at[an]=a;SiebelApp.S_App.Model.InvokeRegisteredSvc(at,au);$.callback(this,function(aJ){aw=aJ.retVal;var aG=aJ.err;if(aG){$.setReturnValue({err:aG,retVal:aw});return}if(aw.Outputargs){if((aw.Outputargs).GetPropertyAsStr("Invoked")==="true"){this.SetCommitPending(false);this.SetNewRecPending(false);this.NotifyNewRecordData();$.setReturnValue({err:aG,retVal:aw.Outputargs});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.WriteRecord")}return}(aw.Outputargs).SetType(a);au.AddChild(aw.Outputargs);var aD=aw.Outputargs.GetPropertyAsStr("bAddSyncQ");if(!ao.IsEmpty(aD)){aA=aD}}if(this.IsVBC()){this.SetCommitPending(false);this.SetNewRecPending(false);this.NotifyNewRecordData();return}if(ay===D.get("INSMODE_ASSOCONLY")){var aE=this.GetInsertStatement();SiebelApp.BrowserCacheMgr.Execute(aE.insertquery,aE.values)}else{if(!this.IsCommitPending()){$.setReturnValue({err:true});return}if(!this.CheckActiveRow()){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("BCErrNoActiveRow","","","","",0,78);$.setReturnValue({err:"BCErrNoActiveRow",retVal:false});return}if(this.IsDeletePending()){$.setReturnValue({err:true});return}aC=e.call(this);av=this.FindWorkSet(aC);ar=av.Id;aB=this.GetFieldList();aq=this.GetName();var aI=(this.GetParentBusComp())?true:false;var aF=false;this.SetDefaultValues(false);$.callback(this,function(aR){var aZ=0;var aN=aB.length;var aM=[];var aS=function(){aM[aZ]=SiebelApp.S_App.LookupStringCache(aB[aZ]);if(aI&&(!this.GetExtObjProp("m_pCurLinkQueryDef").Defn.interTableName)&&aM[aZ]===this.GetExtObjProp("m_pCurLinkQueryDef").Defn.destFieldName){aF=true;ap[aZ]=this.GetExtObjProp("m_pCurLinkQueryDef").Defn.SrcFieldValue;ax[aZ]=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aM[aZ]);aZ++;if(aZ<aN){aS.call(this)}}else{this.FieldValue(aM[aZ]);$.callback(this,function(a4){ap[aZ]=a4.retVal;ax[aZ]=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aM[aZ]);aZ++;if(aZ<aN){aS.call(this)}})}};aS.call(this);var aX=this.CheckRequiredFields(aB,ap);if(aX.err){$.setReturnValue({err:aX.err,retVal:aX.retVal});return}var aL=this.GetParentBusComp();var aQ;if(aL){aQ=this.GetExtObjProp("m_pCurLinkQueryDef").Defn.interTableName}if(aI&&(!aQ)&&!aF){ax[aZ]=SiebelApp.OfflineUtils.RemoveNonAlphaChars(this.GetExtObjProp("m_pCurLinkQueryDef").Defn.destFieldName);aM[aZ]=this.GetExtObjProp("m_pCurLinkQueryDef").Defn.destFieldName;ap[aZ]=this.GetExtObjProp("m_pCurLinkQueryDef").Defn.SrcFieldValue;aZ++}var a1=false;var a2=this.GetDefn().Fields;var aP=[];var aV=[];var aU=[];var aY=[];if(aL&&aQ){for(var a0=0;a0<aZ;a0++){var aW=a2[aM[a0]];if(aW.Join&&aW.JoinInfo.JoinType==="X"){var aT=aW.ColName;if(I.DoesFieldExist(aQ,aT)){aV.push(aT);aY.push(ap[a0]);a1=true}else{aP.push(ax[a0]);aU.push(ap[a0])}}else{aP.push(ax[a0]);aU.push(ap[a0])}}}var aK;var aX=this.FieldValidation(aB,ap);if(aX.retVal===true){$.setReturnValue(aX);return}C.call(this,aB,ap);if(this.IsInsertPending()){if(!a1){az=SiebelApp.SqlBuilder.InsertRecord(aq,ax,ap);aK=this.GetRecordCount();this.SetRecordCount(++aK);k.CcfLogEvent([J,34,0,0,"Table: ",this.GetName(),az.insertquery]);k.CcfLogEvent([J,44,0,0,"Bind variables",az.values]);SiebelApp.BrowserCacheMgr.Execute(az.insertquery,az.values)}else{var a3=X.call(this,this.GetExtObjProp("m_pCurLinkQueryDef").Defn.SrcFieldValue,ar);az=SiebelApp.SqlBuilder.InsertRecord(aq,aP,aU);aV.push(B.get("SWE_ROW_ID_FIELD"));aY.push(a3);var aO=SiebelApp.SqlBuilder.InsertRecord(aQ,aV,aY);aK=this.GetRecordCount();this.SetRecordCount(++aK);k.CcfLogEvent([J,34,0,0,"Table: ",this.GetName(),az.insertquery]);k.CcfLogEvent([J,44,0,0,"Bind variables",az.values]);SiebelApp.BrowserCacheMgr.Execute(az.insertquery,az.values);$.callback(this,function(){k.CcfLogEvent([J,34,0,0,"Inter Table: ",aQ,aO.insertquery]);k.CcfLogEvent([J,44,0,0,"Bind variables",az.values]);SiebelApp.BrowserCacheMgr.Execute(aO.insertquery,aO.values)})}}else{if(!a1){az=SiebelApp.SqlBuilder.UpdateRecord(aq,ax,ap,B.get("SWE_ROW_ID_FIELD"),ar);k.CcfLogEvent([J,34,0,51,"Table: ",this.GetName(),az]);
k.CcfLogEvent([J,44,0,51,"Bind variables",ar]);SiebelApp.BrowserCacheMgr.UpdateRecord(az,ar)}else{az=SiebelApp.SqlBuilder.UpdateRecord(aq,aP,aU,B.get("SWE_ROW_ID_FIELD"),ar);SiebelApp.BrowserCacheMgr.UpdateRecord(az,ar);k.CcfLogEvent([J,34,0,51,"Table: ",this.GetName(),az]);k.CcfLogEvent([J,44,0,51,"Bind variables",ar]);$.callback(this,function(){var a4=X.call(this,this.GetExtObjProp("m_pCurLinkQueryDef").Defn.SrcFieldValue,ar);az=SiebelApp.SqlBuilder.UpdateRecord(aQ,aV,aY,B.get("SWE_ROW_ID_FIELD"),a4);k.CcfLogEvent([J,34,0,51,"Inter Table: ",aQ,az]);k.CcfLogEvent([J,44,0,51,"Bind variables",a4]);SiebelApp.BrowserCacheMgr.UpdateRecord(az,a4)})}}})}var aH=function(){this.SetCommitPending(false);this.SetNewRecPending(false);this.OnWriteRecord();if(this.GetParentBusComp()){this.GetParentBusComp().WriteRecord();this.SetParCommitPen(false)}$.callback(this,function(){if(ay!==D.get("INSMODE_ASSOCONLY")){this.NotifyNewRecordData();this.SetOpType(D.get("WRITERECORD"))}aA=ao.IsEmpty(aA)?true:aA;if(ao.IsTrue(aA)){this.UpdateSync(aB,ap,ar)}else{this.SetNewTxn("");this.SetTxnId("");this.SetEmptyFNm();this.SetOpType("")}$.callback(this,function(){at[an]=r;SiebelApp.S_App.Model.InvokeRegisteredSvc(at,au);$.callback(this,function(aL){aw=aL.retVal;var aK=aL.err;if(aK){$.setReturnValue({err:aK,retVal:aw});return}this.SetOrigRecVal("");if(ay===D.get("INSMODE_ASSOCONLY")){this.SetBCTableInsertState(D.get("INSMODE_NORMAL"));this.SetInsertStatement("")}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.WriteRecord")}})})})};$.callback(this,function(aK){if(!aK.err){aH.call(this)}else{if(aK.retVal.code===6){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrDupConflict","","","","",0,77);$.setReturnValue({err:"SSASqlErrDupConflict",retVal:""})}else{if(aK.retVal.message){if(aK.retVal.code===1&&(aK.retVal.message==="constraint failed"||aK.retVal.message.indexOf("not unique")>-1)){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrDupConflict","","","","",0,77);$.setReturnValue({err:"SSASqlErrDupConflict",retVal:""})}else{SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrEndTrx","","","","",0,77);$.setReturnValue({err:"SSASqlErrEndTrx",retVal:""});SiebelJS.Log(aK.retVal.message)}}else{$.setReturnValue({err:aK.err,retVal:""})}}return}})})}else{return(j.WriteRecord.call(this))}};al.prototype.ReplaceAmp=function(ap){if(ap.indexOf("&")!==-1){ap=ap.replace("&",";amp;")}return ap};al.prototype.SyncQRec=function(at){var ap=this.GetTxnId();if(ap===""){ap=k.GetTempId();this.SetTxnId(ap)}var au=B.get("SWE_PST_BUSOBJ_INFO")+"="+this.GetBusObj().GetName()+"&";var ar=this.GetName();ar=this.ReplaceAmp(ar);au=au+B.get("SWE_PST_BUSCOMP_INFO")+"="+ar+"&";au=au+B.get("SWE_METHOD_STR")+"="+this.GetOpType()+"&";if(this.GetBusObj().GetUIState()===false){au=au+B.get("SWE_VIEW_ARG")+"=&"}else{au=au+B.get("SWE_VIEW_ARG")+"="+SiebelApp.S_App.GetActiveView().GetName()+"&"}au=au+B.get("SWE_ROW_ID_STR")+"="+at+"&";au=au+"TxnId="+ap;if(this.GetParentBusComp()){var aq=this.GetParentBusComp().FindWorkSet(this.GetParentBusComp().GetSelection());this.GetParentBusComp().FieldValue(B.get("SWE_ROW_ID_FIELD"),aq);$.callback(this,function(av){if(av.err){$.setReturnValue(av)}else{au=au+"&"+B.get("SWE_ROW_IDS_STR")+"="+av.retVal;$.setReturnValue({err:false,retVal:au})}})}else{$.setReturnValue({err:false,retVal:au})}};function O(aq){var ap=function(){if(this.IsNotifyEnabled()&&!aq.bAfterNotify){this.EnableNotify()}if(aq.bAddUndo){this.EndUndo(false)}};if(aq.bRecordCreated){if(this.IsNotifyEnabled()&&!aq.bAfterNotify){this.DisableNotify()}this.UndoRecordX();$.callback(this,ap)}else{ap.call(this)}}al.prototype.NewRecordX=function(aw,ax,aA){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.NewRecordX")}var aB=null;var av;var ap=false;var az=null;var au=null;var at={};at.bAddUndo=false;at.bAfterNotify=false;at.bNewRecordInsertedInWorkSet=false;at.bSetPrimary=false;at.bInsertBefore=aw;var ay,aq={};aq[N]=this.GetName();aq[u]=A;aq[R]="NewRecord";aq[f]=this;var ar=CCFMiscUtil_CreatePropSet();ar.SetPropertyStr("InsertBefore",aw);ar.SetPropertyStr("Internal",ax);ar.SetPropertyStr("IdValue",aA);aq[an]=a;W.InvokeRegisteredSvc(aq,ar);$.callback(this,function(aD){ay=aD.retVal;err=aD.err;if(ay.Outputargs&&(ay.Outputargs).GetProperty("Invoked")&&(ay.Outputargs).GetProperty("Invoked").toString()==="true"){var aC=(ay.Outputargs).GetProperty("RetVal").toString();$.setReturnValue({err:err,retVal:aC});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("Applet.NewRecord")}O.call(this,at);return}if(ay.Outputargs&&ar){(ay.Outputargs).SetType(a);ar.AddChild(ay.Outputargs)}ap=this.IsExecuted();if(!ap){O.call(this,at);return}if(!ax&&!this.CanInsert()){alert("SSAOMErrNoInsert");O.call(this,at);return}aB=e.call(this);au=this.FindWorkSet(aB);if(au){}if(aB===-1){av=0}else{av=(!at.bInsertBefore)?(aB+1):aB}this.InsertWorkSet(av,az,true);aB=av;ag.call(this,aB);if(au&&this.GetWS().length>this.GetWorkSetSize()){if(!this.IsVBC()&&!this.GetIsRelatedBC()){if(aw||aB!==this.GetWS().length-1){this.DeleteWorkSet(this.GetWS().length-1)}else{this.DeleteWorkSet(0);ag.call(this,--aB)}}else{ag.call(this,aB)}}this.SetCommitPending(true);this.SetNewRecPending(true);at.bRecordCreated=true;K.call(this,at);$.callback(this,function(){this.SetDefaultValues(true);$.callback(this,function(aE){this.SetOpType(D.get("NEWRECORD"));this.SyncQRec("rowId");$.callback(this,function(aF){var aG=aF.retVal;this.SetNewTxn(aG);if(!ax){this.NotifyNewRecord(aw);at.bAfterNotify=true;this.UpdateLinks(false)}$.callback(this,function(){this.SetExtObjProp("isNewRecord",false);aq[an]=r;W.InvokeRegisteredSvc(aq,ar);$.callback(this,function(aH){$.setReturnValue(aH)});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.NewRecordX")}})})})})})};function K(av){var at=this.GetParentBusComp();if(at){var ax=this.GetLinkDef();var aw=ax.interTableName;if(!aw){var au=ax.destFieldName;var ap=this.GetFieldDefn(au);var ar;var aq=[];if(!ap){ar="SSASqlErrLinkDestField";aq.push(ax.Name);aq.push(au);aq.push(this.GetName());SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrLinkDestField",aq,"","","",0,78);O.call(this,av)}else{if(ax.SrcFieldValue){this.SetFieldValueX(ax.destFieldName,ax.SrcFieldValue,true)}else{at.FieldValue(au);$.callback(this,function(az){var ay=az.retVal;this.SetFieldValueX(ax.destFieldName,ay,true)})}}}}}al.prototype.InsertWorkSet=function(aq,ap,at){ap=T.call(this,ap);var ar=(!at)?ap:this.CreateRecord("");if(aq===this.GetWS().length){this.AddWS(ar)}else{this.InsertRecordWS(aq,ar)}this.NotifyInsertWorkSet(aq,ar)};function T(ap){if(!ap){return ap}var aq=this.CreateRecord("");var ar=this.GetFieldMap();for(var aw in ar){if(ar.hasOwnProperty(aw)){var au=this.GetFieldDefn(aw);var av=k.RemoveNonAlphaChars(aw);if(ap.hasOwnProperty(av)){if(au.DataType===af){var at=k.UtcToLocal(ap[av]);aq[av]=k.ToTS(at)}else{aq[av]=ap[av]}}}}return aq}al.prototype.InsertRecordWS=function(aq,ap){this.GetWS().splice(aq,0,ap)
};al.prototype.CreateRecord=function(ap){if(!ap){ap=k.GetTempRowId()}var ar=ap;var au=this.GetFieldList();var ay=[];var aw=au.length;var at={};for(var av=0;av<aw;av++){var ax=au[av];var aq=SiebelApp.S_App.LookupStringCache(ax);aq=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aq);if(aq==="Id"){at[aq]=ar}else{at[aq]=""}}return at};al.prototype.SetDefaultValues=function(ap){var at=[];var ax;var aw;var ay;var av=this;at=this.GetFieldList();ay=this.GetName();var au=at.length;var ar=0;var aq=function(){ax=SiebelApp.S_App.LookupStringCache(at[ar]);var az=ap?av.GetFieldDefn(ax).PreDefault:av.GetFieldDefn(ax).PostDefault;if(az){av.GetDefaultValue(ay,ax,ap);$.callback(this,function(aA){aw=aA.retVal;if(aw){if(!ap){this.FieldValue(ax);$.callback(this,function(aB){retVal=aB.retVal;if(ao.IsEmpty(retVal)){k.CcfLogEvent([J,30,0,44,ax,aw]);av.SetFieldValueX(ax,aw,true)}})}else{av.SetFieldValueX(ax,aw,true)}}})}$.callback(this,function(){ar++;if(ar<au){$.callback(this,aq)}})};aq.call(this)};al.prototype.FieldValidation=function(ax,aq){var aC=[];var aA=this.GetFieldMap();var at=this.GetDefn().Fields;var aw=[];var ay={};var ap=false;ay.err=false;for(var au=0;au<ax.length;au++){aC[au]=SiebelApp.S_App.LookupStringCache(ax[au]);if(!ao.IsEmpty(at[aC[au]].ValidationSpec)){if(!(at[aC[au]].ValidationSpecast)){this.GetDefn().Fields[aC[au]].ValidationSpecast=SiebelApp.Query.Parse(at[aC[au]].ValidationSpec)}var aB=SiebelApp.Query.Evaluate(this.GetDefn().Fields[aC[au]].ValidationSpecast,this,SiebelApp.Query.Parse("["+aC[au]+"]"));if(aB===false){var av=SiebelApp.Query.GetFieldsFromExp("Calc",at[aC[au]].ValidationSpec);if(ao.IsEmpty(aq[au])){ap=true}for(var ar=0;ar<av.length;ar++){var az=this.GetWS()[this.GetActiveRow()][SiebelApp.OfflineUtils.RemoveNonAlphaChars(av[ar])];if(ao.IsEmpty(az)||ao.IsEmpty(aq[au])){ap=true}}if(ap===false){aw.push(aq[au]);aw.push(aC[au]);aw.push(at[aC[au]].ValidationSpec);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrValidation",aw,"","","",0,79);return{err:"SSASqlErrValidation",retVal:true}}}}}return{err:"SSASqlErrValidation",retVal:false}};function C(ap,au){var ax=this.GetFieldMap();var av=ap.length;for(var ar=0;ar<av;ar++){var aq=SiebelApp.S_App.LookupStringCache(ap[ar]);var at=au[ar];var aw=this.GetFieldDefn(aq);if(aw.DataType===af){if(at){au[ar]=k.ToTS(new Date(at),true)}}}}function H(ap,aq){var ar=this.GetFieldDefn(ap);if(ar.DataType===af){if(aq){return k.ToTS(new Date(aq),true)}}return aq}al.prototype.CheckRequiredFields=function(av,aq){var az=[];var au=[];var ay=SiebelApp.S_App.Model.GetSystemFields();var ax=this.GetFieldMap();var ar=this.GetDefn().Fields;var aw={};aw.err=false;for(var at=0;at<av.length;at++){az[at]=SiebelApp.S_App.LookupStringCache(av[at]);if(ay.indexOf(az[at])===-1&&ax[az[at]].IsRequired()){if(!aq[at]){if(!this.IsInsertPending()){var ap=this.GetOldFNm();if(ap.indexOf(az[at])===-1){continue}}au.push(az[at]);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAFReqFieldNotExist",au,"","","",0,69);aw.err="SSAFReqFieldNotExist";aw.retVal="";return aw}}}return aw};al.prototype.RemoveBindingToRow=function(){};al.prototype.OnActiveRowChanged=function(){this.FindWorkSet(e.call(this));this.RemoveBindingToRow(true)};al.prototype.EventChangeRecord=function(){if(this.CheckActiveRow()===false){return true}};al.prototype.GetRowNum=function(au,ar){var aq=this.GetWS();var ap=aq.length;if(au){for(var at=0;at<ap;at++){if(JSON.stringify(aq[at])===JSON.stringify(au)){return at}}}if(!isNaN(ar)){if(aq[ar]&&ar<ap){return aq[ar]}}SiebelJS.Log("Record Not Present .... ");return false};al.prototype.GetNumRows=function(){var ap=0;ap=this.GetWS().length;return ap};al.prototype.NotifyNewRecord=function(av){var ax;var az=false;var aq=this.GetNotifyInfoArray();var ay=aq.length;var aB=e.call(this);for(var au=0;au<ay;au++){ax=aq[au];var at=ax.GetAppletArray();var aw=at.length;var ap;for(var ar=0;ar<aw;ar++){ap=at[ar];if(ax&&((ax.GetBegRow(ap)+ax.GetSize()-1)<aB)&&!this.IsVBC()&&!this.GetIsRelatedBC()){ax.SetBegRow(ax.GetBegRow(ap)+1,ap);ax.SetCurrRow(ax.GetCurrRow(ap)+1,ap);az=true}else{az=false}}if(this.IsNotifyEnabled()&&ax){var aA=ax.GetBusCompNotify();if(aA){aA.NotifyNewRecord(av&&!az)}}}};al.prototype.NotifyDeleteRecord=function(aq,aA){var aB;var ax;if(!(this.IsNotifyEnabled())){return}var ar=this.GetNotifyInfoArray();var ay=ar.length;for(var av=0;av<ay;av++){ax=ar[av];var au=ax.GetAppletArray();var aw=au.length;var ap;for(var at=0;at<aw;at++){ap=au[at];if(!aq&&ax&&ax.GetBegRow(ap)!==0&&((ax.GetBegRow(ap)+ax.GetSize()>this.GetWS().length))){ax.SetBegRow(ax.GetBegRow(ap)-1);ax.SetCurrRow(ax.GetCurrRow(ap)-1);aB=true}else{aB=false}}if(ax){var az=ax.GetBusCompNotify();if(az){az.NotifyDeleteRecord(aq,aA&&!aB)}}}};al.prototype.Home=function(){k.CcfLogEvent([J,27,0,64,this.GetName()]);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.Home")}this.FinishRecord();this.ClearUpdates();if(!this.IsExecuted()){this.EmptyWorkSet();ag.call(this,-1);this.NotifyReset();return}if(e.call(this)!==-1){var aq=this.FindWorkSet(0);var ar=this.GetRowNum(aq);if(isNaN(ar)){$.setReturnValue({err:true});return}var ap=this.GetNumRows();if(ar<0&&ap){ar=ap+ar+1}if(ar===1){this.NotifyReset();$.callback(this,function(at){$.setReturnValue(at)});return}}ag.call(this,-1);this.NotifyReset();$.callback(this,function(at){$.setReturnValue(at);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.Home")}})};al.prototype.NotifyReset=function(){ag.call(this,(this.GetWS().length>0?0:-1));this.NotifyStateChanged("activeRow",e.call(this));this.OnActiveRowChanged();this.EventChangeRecord();this.NotifyNewData();$.callback(this,function(ap){if(ap.err){$.setReturnValue(ap)}else{this.UpdateLinks(false);$.callback(this,function(aq){$.setReturnValue(aq)})}})};al.prototype.EnumUserProps=function(){var aq=this.GetDefn();var ap=null;if(aq.userPropMap){ap=[];for(var ar in aq.userPropMap){if(aq.userPropMap[ar]){ap.push(ar)}}return ap}else{return null}};al.prototype.EnumFieldUserProps=function(ap){var ar=this.GetFieldDefn(ap);if(ar.userPropMap){var aq=[];for(var at in ar.userPropMap){if(ar.userPropMap[at]){aq.push(at)}}return aq}else{return null}};al.prototype.GetFldPickMapDef=function(ap){var aq=this.GetFieldDefn(ap);return aq.pickMap};al.prototype.GetUserProperty=function(ap){if(this.GetDefn().userPropMap){return this.GetDefn().userPropMap[ap]}else{return""}};al.prototype.GetLinkDef=function(){var aq=SiebelApp.Metadata.GetBusObjDef(this.GetBusObj().GetName())[this.GetName()];if(aq){var ap=SiebelApp.Metadata.GetLinkDef(aq);if(!ap.interTableName&&!ap.srcFieldName){ap.srcFieldName=B.get("SWE_ROW_ID_FIELD")}return SiebelApp.Metadata.GetLinkDef(aq)}else{return null}};al.prototype.GetDefn=function(){var ap=SiebelApp.Metadata.GetBusCompDef(this.GetName());return ap};al.prototype.GetFieldDefn=function(ap){var aq=this.GetDefn().Fields[ap];if(!aq){k.CcfLogEvent([J,55,0,53,ap,this.GetName()])}return aq};al.prototype.PopulateWS=function(aM,au,at,aw){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.PopulateWS")
}var aL=au.length;var ax=SiebelApp.OfflineUtils.RemoveNonAlphaChars(this.GetName());var ap=this.GetDefn();var aC=[];var ay=0;var aE={};var aN=ap.Fields;for(var aO=0;aO<aL;aO++){var az=au[aO];var aA=SiebelApp.S_App.LookupStringCache(az);var aG=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aA);if(I.DoesFieldExist(ax,aG)){if((typeof(aM)!=="string")){var av=aM.length;for(var aD=1;aD<av;aD++){if(ap.InterFieldInfo.InterFieldArr.indexOf(aA)!==-1){var aF=aN[aA].ColName;if(I.DoesFieldExist(aM[aD],aF)){aG=aM[aD]+"."+aF;aE[aF]=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aA);continue}}if(I.DoesFieldExist(aM[aD],aG)){aG=ax+"."+aG}}}aC[ay]=aG;ay++}}var aI;var aH=this.GetCursor();var ar;this.SetQuerySearchSpec(at);this.SetQuerySortSpec(aw);this.SetQueryFieldList(aC);this.SetQueryOrder(aI);var aq="Count(*)";var aJ=0;var aK=SiebelApp.SqlBuilder.SelectRecordPopulateWS(aM,at,[aq],aw,aI);SiebelApp.BrowserCacheMgr.SelectRecord(aK);var aB=this.GetWorkSetSize();$.callback(this,function(aR){if(!aR.err){var aP=aR.retVal;aP=aP[aq];this.SetRecordCount(aP);if(!(aH.length)){aH.push(aJ)}if(aP>D.get("PAGE_SIZE")){if(aH.length>1){aH[1]=aB}else{aH.push(aB)}}else{if(aP<=aB){if(aH.length>1){aH[1]=aP}else{aH.push(aP)}}else{if(aP>aB){if(aH.length>1){aH[1]=aB}else{aH.push(aB)}}}}if(aP<(aH[0]+1)){aH[0]=0}if(this.CheckActivation()){ar=aH[0];aH[0]=this.GetScrollCount()}var aQ;k.CcfLogEvent([J,33,0,12,this.GetName(),aP,aH[1]]);aQ=SiebelApp.SqlBuilder.SelectRecordPopulateWS(aM,at,aC,aw,aI,aH);SiebelApp.BrowserCacheMgr.SelectRecord(aQ,true);$.callback(this,function(aY){if(!aY.err){var aW=aY.retVal;var aT=aW.length;var aZ;this.EmptyWorkSet();if(aW){if((aW.length>0)){var aX=aW.length;for(var aU=0;aU<aX;aU++){var aS=aW[aU];if((typeof(aM)!=="string")){for(var aV in aE){if(aE[aV]){aS[aE[aV]]=aS[aV];delete aS[aV]}}}this.InsertWorkSet(aU,aS)}if(!aH[0]){aH[0]=0}aH[1]=1;this.SetCursor(aH);if(ar){aH[0]=ar}}}}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.PopulateWS")}})}else{$.setReturnValue({err:true})}})};al.prototype.Execute=function(){k.CcfLogEvent([J,27,0,12,this.GetName()]);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.Execute")}var at;var ar;var au=CCFMiscUtil_CreatePropSet();var aq={},ap=false;aq[N]=this.GetName();aq[u]=A;aq[R]="Execute";aq[f]=this;aq[an]=a;W.InvokeRegisteredSvc(aq,au);$.callback(this,function(aB){at=aB.retVal;ar=aB.err;if(at.Outputargs&&(at.Outputargs).GetProperty("Invoked")&&(at.Outputargs).GetProperty("Invoked").toString()==="true"){$.setReturnValue({err:ar,retVal:at.Outputargs});return}if(at.Outputargs&&au){(at.Outputargs).SetType(a);au.AddChild(at.Outputargs)}if(this.IsVBC()){this.SetExecuted(true);return}this.SetInQueryState(false);this.SetExecuted(false);var aJ=SiebelApp.OfflineUtils.RemoveNonAlphaChars(this.GetName());var ay=[];var aI=[];var ax=this.SetSortSpecification();var aD=this.SetFullSearchSpec();var aC=this.GetFieldList();var aE=this.GetLinkDef();var aA;var aG;var av;var aH;var aF;var az=this.GetParentBusComp();if(az){if(!(az.IsExecuted())||(az.GetActiveRow()===-1)){$.setReturnValue({err:false,retVal:""});return}else{av=aE.srcFieldName;ap=true;az.FieldValue(av);$.callback(this,function(aL){var aK=aL.retVal;aF=aE.Name;if(this.IsVBC()){}else{this.SetLinkSpec(aF,av,aK,aE)}aA=this.GetExtObjProp("m_pCurLinkQueryDef")})}}else{var aw=l.call(this,aJ);if(aw){aD.push(aw)}}$.callback(this,function(){var aR=this.GetFieldMap();var aV;for(var aW in aR){if(aR[aW]){var aT=aR[aW].GetSearchSpec();if(ao.IsEmpty(aT)){continue}var aM=" ";aM+=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aW);var aZ=aT.indexOf(Z);var aU=aT.indexOf(c);var aQ=aT.indexOf(g);if(aZ>=0){aV=aT.substring(aZ+1);aM+=(" "+Z+" ");aM+=('"'+aV+'" ')}else{if(aU>=0){aV=aT.substring(aU+1);aM+=(" "+c+" ");aM+=('"'+aV+'" ')}else{if(aQ>=0){if(aA){if(!ao.IsEmpty(aA.Defn.interTableName)){aM=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aM);aM=aJ+"."+aM}}aV=aT.substring(aQ+g.length);aM+=(" "+g+" ");aM+=('"'+aV+'" ')}else{aM+=(" "+Z+" ");aM+=('"'+aT+'" ')}}}aD.push(aM)}}var aY={};if(aA){var aS;if(!ao.IsEmpty(aA.Defn.interTableName)){aY={};var aK=aJ;aJ=[];aJ.push(aK);var aP=aA.Defn.interTableName;aP=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aP);aJ.push(aP);aS=aK+"."+SiebelApp.OfflineUtils.RemoveNonAlphaChars(aA.Defn.destFieldName);aS=aS+" = "+aP+"."+aA.Defn.interChildColName;aS=aS+" AND "+aP+"."+SiebelApp.OfflineUtils.RemoveNonAlphaChars(aA.Defn.interParentColName);aS=aS+' = "'+aA.Defn.SrcFieldValue+'"';aD.push(aS)}else{aS=SiebelApp.OfflineUtils.RemoveNonAlphaChars(aA.Defn.destFieldName)+' = "'+aA.Defn.SrcFieldValue+'"';aD.push(aS)}}if(az&&aE){if(!(ao.IsEmpty(aE.interTableName))){ax.push(aE.interTableName+"."+SiebelApp.OfflineUtils.RemoveNonAlphaChars(aE.interChildColName))}else{ax.push(SiebelApp.OfflineUtils.RemoveNonAlphaChars(aE.destFieldName))}}if(!this.IsVBC){ax.push(SiebelApp.OfflineUtils.RemoveNonAlphaChars(aE.srcFieldName))}var aL=this.GetAppletSearchSpec();if(aL.length>0){var aN=aL.length;var aX;for(var aO=0;aO<aN;aO++){aX=SiebelApp.Query.GetSearchSpec(aL[aO],this);if(aX.length>0){aD.push(aX[0])}}}this.SetExecutionState(true);k.CcfLogEvent([J,31,0,45,this.GetName(),"SearchSpec: ",aD]);k.CcfLogEvent([J,31,0,46,this.GetName(),"SortSpec: ",ax]);this.PopulateWS(aJ,aC,aD,ax);$.callback(this,function(a0){if(!a0.err){this.SetExecutionState(false);this.SetExecuted(true);$.callback(this,function(){aq[an]=r;au.SetProperty("RetVal",true);W.InvokeRegisteredSvc(aq,au);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.Execute")}})}else{$.setReturnValue({err:true})}})})})};al.prototype.ClearLinkDef=function(){this.SetExtObjProp("m_pCurLinkQueryDef","")};function l(aA){var au=this.GetViewMode();var at={};var az=this.GetUIState();if(ao.IsEmpty(au)){if(!az){return null}else{var ay=SiebelApp.S_App.GetActiveView().GetName();au=SiebelApp.S_App.Model.GetViewMode(ay);if(au!=="4"){au=au.toString();this.SetViewMode(au)}else{var ar=this.GetDefn();var ax=ar.Visibility;var av=ax.length;if(av>0){for(var aq=0;aq<av;aq++){if(ax[aq].mode==="0"){au=0;break}else{if(ax[aq].mode==="2"){au=2;break}else{au=5}}}}au=au.toString();this.SetViewMode(au)}}}if(au==="5"){return null}var ap=Math.pow(2,au);if(au==="3"){ap=15}var aw="("+aA+'._PDAVisibilityTypes & "'+ap+'") OR('+aA+"._PDAVisibilityTypes IS NULL )";return aw}al.prototype.SetLinkSpec=function(au,ar,ap,aq){this.ActivateField(aq.destFieldName);var at=this.GetExtObjProp("m_pCurLinkQueryDef");if(at&&at.Defn.SrcFieldValue===ap){return}at={};at.Defn=aq;at.Defn.SrcFieldValue=ap;at.Data={};at.Data.srcFieldValue=ap;this.SetExtObjProp("m_pCurLinkQueryDef",at)};al.prototype.IsExecuted=function(){var ap=this.GetExtObjProp("m_bExecuted");if(!ap){this.SetExtObjProp("m_bExecuted",false)}return(this.GetExtObjProp("m_bExecuted"))};al.prototype.IsPagination=function(ap){switch(ap){case D.get("POSITION_ON_ROW"):case D.get("SCROLL_NEXT_DATA"):case D.get("SCROLL_PREV_DATA"):case D.get("GO_TO_NEXT_SET"):case D.get("GO_TO_PREV_SET"):return true;
default:return false}};al.prototype.SetExecuted=function(aq){var ap=this.IsExecuted();if(ap===aq){return}if(!aq){this.UndoRecord();$.callback(this,function(ar){this.SetExtObjProp("m_bExecuted",aq);this.NotifyStateChanged("bExecuted",aq)})}else{this.SetExtObjProp("m_bExecuted",aq);this.NotifyStateChanged("bExecuted",aq)}};al.prototype.SetDelRecPending=function(ap){if(this.deletePending&&(this.deletePending===ap)){return}this.deletePending=ap;this.NotifyStateChanged("dp",ap)};al.prototype.IsParCommitPen=function(){if(!((this.GetExtObj).hasOwnProperty("m_isParentCommit"))){this.GetExtObj.m_isParentCommit=false}return this.GetExtObj.m_isParentCommit};al.prototype.SetParCommitPen=function(ap){if(this.GetExtObj.m_isParentCommit&&(this.GetExtObj.m_isParentCommit===ap)){return}this.GetExtObj.m_isParentCommit=ap};al.prototype.SetNewRecPending=function(ap){if(this.insertPending&&(this.insertPending===ap)){return}this.insertPending=ap;if(ap){ap=1}else{ap=0}this.NotifyStateChanged("np",ap)};al.prototype.IsNewRecordPending=function(){return this.insertPending};al.prototype.GetDefaultValue=function(aq,at,ar){var ap=this.GetDefaultExpr(at,ar);this.EvaluateFieldExpr(ap,at,ar);$.callback(this,function(au){$.setReturnValue(au)})};al.prototype.GetDefaultExpr=function(ar,ap){var aq=ap?this.GetFieldDefn(ar).PreDefault:this.GetFieldDefn(ar).PostDefault;return aq};al.prototype.EvaluateFieldExpr=function(ay,aF,at){var aB="";var aA=ay;var ar=ay.indexOf("Parent:");var aw=ay.indexOf("Field:");var ax=ay.indexOf("Expr:");var aG=ay.indexOf("System:");if(ao.IsEmpty(ay)){$.setReturnValue({err:false,retVal:aB});return}if(ay.toUpperCase()==="SYSTEM: CREATORID"){aB=W.GetLoginId();$.setReturnValue({err:false,retVal:aB});return}if(ay.toUpperCase()==="SYSTEM: TIMESTAMP"){aB="";if(this.GetFieldMap()[aF].GetDataType()==="date"){aB=SiebelApp.OfflineUtils.GetTS()}else{aB=SiebelApp.OfflineUtils.GetTS()}$.setReturnValue({err:false,retVal:aB});return}if(aG===0){aA=aA.replace("System:","");aA=aA.replace("()","");aA=aA.trim();switch(aA.toUpperCase()){case"CREATOR":aB=W.GetLoginName();break;case"CREATORID":case"LOGINID":aB=W.GetLoginId();break;case"CURRENCY":aB=W.GetCurrencyCode();break;case"POSITIONID":aB=W.GetPositionId();break;case"DIVISIONNAME":aB=W.GetDivisionId();break;case"ORGANIZATIONID":aB=W.GetOrganizationId();break;case"ORGANIZATIONNAME":aB=W.GetOrganizationName();break;case"CONTACTLOGINID":aB=W.GetLoginId();break;case"CONTACTLOGINNAME":aB=W.GetLoginName();break;case"TODAY":aB=SiebelApp.OfflineUtils.GetDate();break}$.setReturnValue({err:false,retVal:aB});return}if(ar===0){var au=0;var aq=aA.split(",");var av=aq.length;var aE=false;var aD=function(){if(this.GetParentBusComp()){var aJ=this.GetParentBusComp().GetName();if(aJ){aq[au]=aq[au].replace("Parent:","");aq[au]=aq[au].replace(/["']{1}/gi,"");aq[au]=aq[au].replace(/['"]/g,"");var aH=(aq[au].slice(0,aq[au].indexOf("."))).trim();var aI=(aq[au].slice(aq[au].indexOf(".")+1));if(aJ===aH){this.GetParentBusComp().FieldValue(aI);$.callback(this,function(aK){$.setReturnValue(aK)});return}}}else{$.setReturnValue({err:false,retVal:""})}};var aC={};var az=function(){aq[au]=aq[au].trim();if(aq[au].indexOf("Parent:")===0||aq[au].indexOf("Field:")===0||aq[au].indexOf("Expr:")===0||aq[au].indexOf("System:")===0){if(au===0){aD.call(this)}else{this.EvaluateFieldExpr(aq[au].trim(),aF,at)}}else{aD.call(this)}$.callback(this,function(aH){if(!ao.IsEmpty(aH.retVal)){aE=true;aC=aH;$.setReturnValue(aC)}if(!aE){au++;if(au<av){az.call(this)}else{aE=true;aC={err:false,retVal:""};$.setReturnValue(aC)}}})};if(au<av){az.call(this)}$.callback(this,function(){if(aE){$.setReturnValue(aC);return}});if(aE){return}}if(aw===0){aA=aA.replace("Field:","");aA=aA.replace(/["']{1}/gi,"");aA=aA.replace(/['"]/g,"");aA=aA.trim(aA);this.FieldValue(aA);$.callback(this,function(aH){$.setReturnValue(aH)});return}if(ax===0){aA=aA.replace("Expr:","");aA=aA.trim();aA=aA.slice(1,aA.length-1);if(!this.GetFieldDefn(aF).PreQuery){var ap=SiebelApp.Query.Parse(aA);this.GetFieldDefn(aF).PreQuery=ap}aB=SiebelApp.Query.Evaluate(this.GetFieldDefn(aF).PreQuery,this);$.setReturnValue({err:false,retVal:aB});return}if(!isNaN(aA)){$.setReturnValue({err:false,retVal:aA});return}if((ar===-1)&&(aw===-1)){$.setReturnValue({err:false,retVal:aA});return}};al.prototype.IsRequired=function(){return false};al.prototype.HasDefaultValue=function(){return false};al.prototype.NotifyNewRecordDataWS=function(){var ar;if(!this.IsNotifySysEnabled()){return}if(!this.CheckActiveRow()){return}var au=this.GetNotifyInfoArray();var ap=au.length;for(var aq=0;aq<ap;aq++){ar=au[aq];if(ar){var at=ar.GetBusCompNotify();if(at){at.NotifyNewRecordDataWS()}}}};al.prototype.NotifyNewRecordData=function(){var ar;if(!this.IsNotifySysEnabled()){return}this.NotifyNewRecordDataWS();if(!(this.IsNotifyEnabled())){return}var au=this.GetNotifyInfoArray();var ap=au.length;for(var aq=0;aq<ap;aq++){ar=au[aq];if(ar){var at=ar.GetBusCompNotify();if(at){at.NotifyNewRecordData()}}}};al.prototype.FillRecord=function(){return};al.prototype.OnWriteRecord=function(){return};al.prototype.UpdateSync=function(at,ap,aq){var av="";var aA=B.get("SWE_ROW_ID_FIELD");var ax;var ar=this.GetNewTxn();var aB=this.GetOpType();var aw=this.GetTxnId();if(aw===""){aw=k.GetTempId();this.SetTxnId(aw)}if(aB===D.get("ADDRECORD")){av=this.GetNewTxn()}else{if(aB!==D.get("DELETERECORD")){var ay=this.GetOldFNm();var au=this.GetOldfVal();for(var az=0;az<ay.length;az++){av=av+"OF_"+ay[az]+"="+au[az]+"&"}if(av!==""){this.SyncQRec(aq);$.callback(this,function(aC){var aD=aC.retVal;av=av+aD;if(ar!==""){av=ar+"~"+av}})}}else{if(aB===D.get("DELETERECORD")){av=this.GetNewTxn()}}}$.callback(this,function(){if(av!==""){var aC=ae.get("PRO_SYNCQUEUE_DB_TBL_COLS");var aD=SiebelApp.SqlBuilder.InsertRecord(ae.get("PRO_SYNCQUEUE_DB_TBL"),[aC.TransactionId,aC.Request],[aw,av]);SiebelApp.BrowserCacheMgr.Execute(aD.insertquery,aD.values);SiebelApp.OfflineAppSettings.SetSyncStatus(true);k.CcfLogEvent([J,38,0,49,aw,this.GetName()]);SiebelApp.S_App.CustomToolbar.Update("SyncPendng")}this.SetNewTxn("");this.SetTxnId("");this.SetEmptyFNm();this.SetOpType("")})};al.prototype.FldType=function(ap){var aq=this.GetFieldDefn(ap);if(aq&&!aq.ReadOnly){return true}return false};al.prototype.SetCommitPending=function(ap){if(this.IsCommitPending()===ap){return}k.CcfLogEvent([J,36,0,47,"CommitPending",ap,this.GetName()]);this.commitPending=ap;if(ap){ap=1}else{ap=0}if(!this.commitPending){this.ClearUpdates();this.GetCommitPending=function(){return false}}this.NotifyStateChanged("cp",ap)};al.prototype.GetChildBCArray=function(){var au=[];var ap=this.GetBusObj();var at=ap.GetBCMap();var aq;for(var ar in at){if(at[ar]){aq=at[ar].GetParentBusComp();if(!!aq&&this.GetVarName()===aq.GetVarName()){au.push(at[ar])}}}return(au)};al.prototype.ResetChildBCArr=function(){this.SetExtObjProp("m_childBCarr",[])};al.prototype.UpdateLinks=function(ap){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.UpdateLinks")}if(ap){}var ar=[];
var at=this.GetChildBCArray();if(at){var aq=at.length;var ax=this.GetExtObjProp("m_bDisNotChildOnUpdLnks");if(ao.IsEmpty(ax)){this.SetExtObjProp("m_bDisNotChildOnUpdLnks",true);ax=true}var av=0;var au;var ay=[];for(var aw=0;aw<aq;aw++){if(ax){at[aw].DisableNotify()}au=function(){var az=aw;return function(){at[az].EnableNotify()}};if(this.GetActiveRow()!==-1){ay=at[aw].GetCursor();ay[0]=0;at[aw].SetCursor(ay);ar[av]={execute:at[aw].Execute,executeScope:at[aw]};av++;ar[av]={execute:at[aw].Home,executeScope:at[aw],postExecute:au()};av++}else{at[aw].SetExtObjProp("m_bExecuted",false);ar[av]={execute:at[aw].UpdateLinks,executeScope:at[aw]};av++;ar[av]={execute:at[aw].Home,executeScope:at[aw],postExecute:au()};av++}}if(ar.length>0){$.eachAsyncOp(this,ar);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.UpdateLinks")}}}};al.prototype.DisableNotify=function(){if(!(this.IsNotifyEnabled())){return}this.SetNotifyEnabled(false);this.NotifyStateChanged(("bNotifyEnabled"),false)};al.prototype.NotifyInsertWorkSet=function(at,aq){var au;if(!this.IsNotifySysEnabled()){return}var aw=this.GetNotifyInfoArray();var ap=aw.length;for(var ar=0;ar<ap;ar++){au=aw[ar];if(au){var av=au.GetBusCompNotify();if(av){av.NotifyInsertWorkSet(at,aq)}}}};al.prototype.NotifyDeleteWorkSet=function(ar,aw,av){var at;if(!this.IsNotifySysEnabled()){return}var ax=this.GetNotifyInfoArray();var ap=ax.length;for(var aq=0;aq<ap;aq++){at=ax[aq];if(at){var au=at.GetBusCompNotify();if(au){au.NotifyDeleteWorkSet(ar,aw,av)}}}};al.prototype.GetNotifyInfo=function(ar,ap){var aq=this.GetNotifyInfoArray();ap=(ar<aq.length)?aq[ar]:null;return ap};al.prototype.EnableNotify=function(at){var ar;var ap;if(this.IsNotifyEnabled()){return}if(!(this.IsNotifySysEnabled())){this.SetNotifySysEnabled(true);this.NotifyDeleteWorkSet(0,-1,null);var aq=this.GetWorkSet().length;for(ar=0;ar<aq;ar++){ap=this.GetWorkSet()[ar];this.NotifyInsertWorkSet(ar,ap)}this.NotifyStateChanged(("bExecuted"),this.m_bExecuted);this.NotifyStateChanged(("activeRow"),this.m_activeRow);this.NotifyStateChanged(("cp"),this.IsCommitPending());this.NotifyStateChanged(("np"),this.IsNewRecordPending())}this.SetNotifyEnabled(true);this.NotifyStateChanged(("bNotifyEnabled"),true)};al.prototype.ExprEvav=function(ar){var ap=[];var aq={};aq.FieldName="";aq.Oper="";aq.Val="";aq.PreLogic="";ap.push(aq);return ap};al.prototype.GetQuickPickInfo=function(au,av){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.GetQuickPickInfo")}var aq=this.GetFieldDefn(av);var at;at=this.GetPickListInfo(au,av);if(aq.pickMap){var ap=aq.pickMap.length;for(var ar=0;ar<ap;ar++){if(aq.pickMap[ar].FldName===av){at.PFldName=aq.pickMap[ar].PFldName;break}}}SiebelApp.BrowserCacheMgr.GetPickListData(at,this,av);$.callback(this,function(aw){$.setReturnValue(aw);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.GetQuickPickInfo")}})};al.prototype.GetPickListInfo=function(ar,at){var ap;var aq;ap=this.ValidateFieldDef(at);if(ap){aq=SiebelApp.Metadata.GetPickListDef(ar);return aq}else{return aq}};al.prototype.GetIdValueX=function(){if(this.CheckActiveRow()){var ap=this.GetActiveRow();var aq=this.FindWorkSet(ap);this.FieldValue(B.get("SWE_ROW_ID_FIELD"),aq);$.callback(this,function(ar){$.setReturnValue({err:ar.err,retVal:ar.retVal});return})}else{$.setReturnValue({err:false,retVal:""});return}};function G(){var ar=[];var at=CCFMiscUtil_CreatePropSet();at.SetType(B.get("SWE_PST_REC_LIST"));var ap=this.GetWS();var aq;if(ap==="undefined"||ap.length<=0){aq=CCFMiscUtil_CreatePropSet();aq.SetType(B.get("SWE_PROP_LAST_RECORD"));aq.SetProperty("v","");at.AddChild(aq);$.setReturnValue({err:false,retVal:at})}else{at.SetProperty(B.get("SWE_PROP_ACTIVE_ROW"),e.call(this));at.SetProperty(B.get("SWE_PROP_CURR_RNUM"),1);at.SetProperty(B.get("SWE_PROP_NUM_ROWS"),10);ar=this.GetActivatedFieldList();this.PrepareOfflineRawRecord(ap.length,ar);$.callback(this,function(ax){var av=ax.retVal;for(var au=0;au<av.length;au++){var aw=av[au].value;var ay=av[au].id;aq=CCFMiscUtil_CreatePropSet();aq.SetType(B.get("SWE_PROP_RECORD"));aq.SetProperty("i",ay);aq.SetProperty("v",aw);at.AddChild(aq)}$.setReturnValue({err:false,retVal:at})})}}al.prototype.PickUpActiveFields=function(){var ar=[];var aq=this.GetFieldList();for(var ap=0;ap<aq.length;ap++){var at=aq[ap];at=SiebelApp.S_App.LookupStringCache(at);ar.push(SiebelApp.OfflineUtils.RemoveNonAlphaChars(at))}return ar};al.prototype.WSNextRecordX=function(at,ap){var ar={};ar.err="";var au=this.GetNotifyInfoArray();var aq=au[at];if(at>au.length||ao.IsEmpty(aq)){ar.err="SSAOMErrNotifyInfo";$.setReturnValue(ar);return ar}if(((aq.GetCurrRow(ap)+1)-(aq.GetBegRow(ap))<aq.GetSize())&&((aq.GetCurrRow(ap)+1)<this.GetWS().length)){aq.SetCurrRow(aq.GetCurrRow(ap)+1,ap)}else{if((this.IsVBC()||this.GetIsRelatedBC())&&((aq.GetCurrRow(ap)+1)<this.GetWS().length)){aq.SetCurrRow(aq.GetCurrRow(ap)+1,ap)}else{ar.err="SSAOMErrNotifyInfo"}}$.setReturnValue(ar);return ar};al.prototype.WSGetCurrRow=function(at,ap){var ar={};ar.err="";var au=this.GetNotifyInfoArray();var aq=au[at];if(at>au.length||ao.IsEmpty(aq)){ar.err="SSAOMErrNotifyInfo";return ar}ar.retVal=aq.GetCurrRow(ap);return ar};al.prototype.WSSetCurrRow=function(au,at,ap){var ar={};ar.err="";var av=this.GetNotifyInfoArray();var aq=av[au];if(au>av.length||ao.IsEmpty(aq)){ar.err="SSAOMErrNotifyInfo";return ar}aq.SetCurrRow(at,ap);return ar};al.prototype.NextRecord=function(){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.NextRecord")}this.FinishRecord();var aq;var ap;var ar;aq=e.call(this);if(aq<0){$.setReturnValue({err:true});return}if(aq<(this.GetWS().length-1)){this.SetActiveRow(aq+1);$.callback(this,function(at){$.setReturnValue(at)});return}if(this.GetWS().length===1){this.GetNextRecord();$.callback(this,function(au){if(!au.err){var at=au.retVal;this.InsertWorkSet(0,at);this.DeleteWorkSet(1);this.NotifyNewData()}else{$.setReturnValue(au)}})}else{if(this.GetWS().length===D.get("PAGE_SIZE")){ar=this.GetCursor();ar[0]=this.GetWS().length-1;this.SetCursor(ar);this.EmptyWorkSet();ag.call(this,0);$.callback(this,function(at){if(at.err){$.setReturnValue(at)}else{this.GetNextRecord();$.callback(this,function(au){if(au.err){ag.call(this,-1);$.setReturnValue(au)}else{ap=au.retVal;this.InsertWorkSet(0,ap);var av=this.GetCursor();if(av[0]<0){av[0]=0;this.SetCursor(av)}$.setReturnValue(au)}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.NextRecord")}})}})}else{$.setReturnValue({err:true});return}}};al.prototype.WSFieldValue=function(av,au,aq){var at={};at.err="";var aw=this.GetNotifyInfoArray();var ar=aw[au];if(au>aw.length||ao.IsEmpty(ar)){at.err="SSAOMErrNotifyInfo";$.setReturnValue(at);return}var ap=this.FindWorkSet(ar.GetCurrRow(aq));this.FieldValue(av,ap);$.callback(this,function(ax){$.setReturnValue(ax)})};al.prototype.PrepareOfflineRawRecord=function(aA,aw,ap){var at=aA;var ax=aw.length;
var av="";var au={};var ay=[];var az=e.call(this);var ar=0;var aB=0;var aq=function(){if(ar===0){this.WSHomeX(aB)}else{this.WSNextRecordX(aB)}$.callback(this,function(aE){var aD=0;var aC=function(){var aG="";var aF=0;this.WSFieldValue(aw[aD],aB);$.callback(this,function(aH){if(!aH.err){aG=aH.retVal;if(!aG){aG=""}aF=aG.length;if(av.length){av=av+aF+"*"+aG}else{av=aF+"*"+aG}if(aw[aD]==="Id"){au.id=aG}}aD++;if(aD<ax){aC.call(this)}else{au.value=av;ay.push(au);av="";au={}}})};if(ax>0){aC.call(this)}});$.callback(this,function(){ar++;if(ar<at){aq.call(this)}})};if(at>0){aq.call(this)}$.callback(this,function(){ag.call(this,az);$.setReturnValue({err:false,retVal:ay})})};al.prototype.SelectRow=function(){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.SelectRow")}var ar;var aq;var ap;var at=[];ar=this.GetSelection();aq=this.FindWorkSet(ar);at=this.GetSelRowIdArray();this.FieldValue(B.get("SWE_ROW_ID_FIELD"),aq);$.callback(this,function(ay){var av=ay.retVal;var ax=function(){this.SetSelRowIdArray(at);this.SetMultiSelectMode(true);k.CcfLogEvent([J,"36",0,48,"MultiSelect","true",this.GetName()]);this.NotifySelModeChange(true);this.NotifyChangeSelection();this.NotifyNewSelection(false)};if(!this.GetMultiSelectMode()){var au;var az;au=this.FindWorkSet(0);this.FieldValue(B.get("SWE_ROW_ID_FIELD"),au);$.callback(this,function(aA){var aB=aA.retVal;at.push(aB);ax.call(this)})}var aw;for(aw=0;aw<at.length;aw++){if(at[aw]===av){break}}if(aw===at.length){at.push(av)}else{at.splice(aw,1)}ax.call(this);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.SelectRow")}})};al.prototype.AssocSelection=function(){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.AssocSelection")}this.GetIdValueX();$.callback(this,function(au){if(!au.err){var aA=au.retVal;var aE=this.GetActiveRow();var ap=aE;var ay=this.GetMultiSelectMode();var ax=this.GetSelRowIdArray();if(ay&&(ax.length===1)&&(ax[0]===aA)){this.SetMultiSelectMode(false);ay=false;this.SetSelRowIdArray([]);this.NotifySelModeChange(ay)}if(!ay){return(aj.call(this,aE))}this.FinishRecord();this.DisableNotify();var aB=this.GetBaseBC();aB.DisableNotify();var ar=aB.GetParentBusComp();ar.DisableNotify();var aD=this.GetActiveRow();var aq=this.GetSelRowIdArray();var aF=aq.length;var aC=this.GetWorkSetSize();var aw="";var at;var av=0;var az=function(){for(at=0;at<aC;at++){aw=this.FindWorkSet(at);if(aq[av]===aw.Id){break}}if(at===aC){this.InsertWorkSet(aC,aw);this.PositionById(aq[av])}$.callback(this,function(){this.SetActiveRow(at);$.callback(this,function(){aj.call(this,at);$.callback(this,function(){this.SetActiveRow(ap);$.callback(this,function(){av++;if(av<aF){az.call(this)}})})})})};if(av<aF){az.call(this)}$.callback(this,function(){this.SetActiveRow(aD);$.callback(this,function(aG){if(!aG.err){if(at===aC){this.DeleteWorkSet(aC)}this.NotifySelModeChange(ay);this.SetMultiSelectMode(false);aB.EnableNotify();ar.EnableNotify();this.EnableNotify();this.SetSelRowIdArray([]);this.NotifySelModeChange(false);this.NotifyNewData();aB.Home();$.callback(this,function(){aB.NotifyExecute();aB.NotifyNewData();if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.AssocSelection")}})}})})}})};al.prototype.IsCurWSRecSelected=function(aw,ar){var aq;var av=false;var au;var at="";var ax;ax=this.GetSelRowIdArray();aq=e.call(this);if(aq<0){return}var ap=this.WSGetCurrRow(0,ar).retVal;if(!this.GetMultiSelectMode()){av=ap===aq?true:false}else{au=this.FindWorkSet(aq);if(au){this.FieldValue(B.get("SWE_ROW_ID_FIELD"),au)}$.callback(this,function(az){if(!az.err){at=az.retVal;var ay;for(ay=0;ay<ax.length;ay++){if(ax[ay]===at){break}}if(ay!==ax.length){av=true}else{av=false}}else{}})}$.callback(this,function(){$.setReturnValue({err:false,retVal:av})})};al.prototype.GetBaseBC=function(){var ar=this.GetExtObjProp("baseBC");if(!ar){var ap=SiebelApp.S_App.GetActiveView().GetActiveApplet();var aq=ap.GetParentApplet();if(aq){ar=aq.GetBusComp();this.SetExtObjProp("baseBC",ar)}else{this.SetExtObjProp("baseBC","NoBaseBC")}}else{if(ar==="NoBaseBC"){ar=""}}return ar};al.prototype.SetBaseBC=function(ap){this.SetExtObjProp("baseBC",ap)};function aj(ap){this.FinishRecord();$.callback(this,function(){if(ap<0){return}var aq=this.FindWorkSet(ap);this.PositionById(aq.Id);$.callback(this,function(){var ar=this.GetBaseBC();ar.SetAssocList(this);ar.AddAssociation();$.callback(this,function(){this.NotifyNewData("SSAAssocExistsField")})})})}al.prototype.PickCurrentRow=function(){var au;var ax=this.GetName();var az;var aA;var aF=this.GetMasterBC();var aD=aF.GetName();var aq=this.GetPickSrcField();var aC=aF.GetFieldDefn(aq);if(aC.PickListName){var ap=aC.pickMap;var ar=ap.length;var aE;var at;var aw=0;var av=true;var aB=this.GetPickSrcIdFName();var ay=aF.FindWorkSet(aF.GetActiveRow());if(aB){this.GetIdValueX();$.callback(this,function(aG){if(!aG.err){if(ay&&aG.retVal!==ay[aB]&&!aF.commitPending){aF.NotifyStateChanged("cp",1)}k.CcfLogEvent([J,75,0,83,"Master BC: ",aD,"BC: ",this.GetName(),aB,aG.retVal]);aF.SetFieldValueX(aB,aG.retVal,true)}else{$.setReturnValue(aG)}})}$.callback(this,function(){var aG=function(){av=true;if(ap[aw]){aE=ap[aw].FldName;this.FieldValue(ap[aw].PFldName);$.callback(this,function(aI){var aH=aF.GetFieldDefn(aE);if(ap[aw].IsConstrained&&ao.IsTrue(aH.IsCalculated)){av=false}if(av){if(!aI.err){if(ay&&aI.retVal!==ay[aE]&&!aF.commitPending){aF.NotifyStateChanged("cp",1)}k.CcfLogEvent([J,75,0,83,"Master BC: ",aD,"BC: ",this.GetName(),aE,aI.retVal]);aF.SetFieldValueX(aE,aI.retVal,true)}}})}aw++;if(aw<ar){$.callback(this,aG)}};if(aw<ar){aG.call(this)}$.callback(this,function(){$.setReturnValue({err:false,retVal:true});return})})}};al.prototype.AddAssociation=function(){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.AddAssociation")}var aq;var ar=CCFMiscUtil_CreatePropSet();var ap={};ap[N]=this.GetName();ap[u]=A;ap[R]="AddAssociation";ap[f]=this;ap[an]=a;SiebelApp.S_App.Model.InvokeRegisteredSvc(ap,ar);$.callback(this,function(ax){aq=ax.retVal;err=ax.err;if(err){$.setReturnValue({err:err,retVal:aq});return}if(!ax.err){aq=ax.retVal;if(aq.Outputargs&&(aq.Outputargs).GetProperty("Invoked")&&(aq.Outputargs).GetProperty("Invoked").toString()==="true"){var au=(aq.Outputargs).GetProperty("RetVal");if(au){$.setReturnValue({err:err,retVal:au})}else{$.setReturnValue({err:err,retVal:""})}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.AddAssociation")}return}}if(aq.Outputargs){(aq.Outputargs).SetType(a);ar.AddChild(aq.Outputargs)}var at=function(){this.FinishRecord();$.callback(this,function(){var aB=this.GetActiveRow();var az=this.FindWorkSet(aB);var aC=this.GetAssocList();if(aC){var aA=aC.FindWorkSet(aC.GetActiveRow());aB++;s.call(this,aA);$.callback(this,function(aG){if(aG.err){$.setReturnValue(aG)}else{var aE=aG.retVal.fieldList;var aF=aG.retVal.fieldVal;this.InsertWorkSet(aB,aA);var aD=this.GetWorkSetSize();
if(az&&aB>aD){if(aB!==aD-1){this.DeleteWorkSet(aD-1)}else{this.DeleteWorkSet(0);aB--}}this.SetActiveRow(aB);$.callback(this,function(){if(aE.length>0){var aH=function(aI){return[aE[aI],aF[aI],true]};$.eachAsyncOp(this,{execute:this.SetFieldValueX,executeScope:this,preExecute:aH,iteration:aE.length})}$.callback(this,function(){if(ay){this.FieldValue("Id");$.callback(this,function(aJ){var aI=aJ.retVal;aw.UpdateRecordX();$.callback(this,function(){aw.SetFieldValueX(av.primeIdFieldName,aI);$.callback(this,function(){aw.WriteRecord();this.NotifyNewRecord();this.OnAddAssociation();this.UpdateLinks(false);$.callback(this,function(){if(aw){aw.OnAddChildAssociation(this)}ap[an]=r;SiebelApp.S_App.Model.InvokeRegisteredSvc(ap,ar);$.callback(this,function(aL){aq=aL.retVal;var aK=aL.err;if(aK){$.setReturnValue({err:aK,retVal:aq});return}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.AddAssociation")}})})})})})}else{this.NotifyNewRecord();this.OnAddAssociation();this.UpdateLinks(false);$.callback(this,function(){if(aw){aw.OnAddChildAssociation(this)}ap[an]=r;SiebelApp.S_App.Model.InvokeRegisteredSvc(ap,ar);$.callback(this,function(aJ){aq=aJ.retVal;var aI=aJ.err;if(aI){$.setReturnValue({err:aI,retVal:aq});return}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.AddAssociation")}})})}})})}})}})};var av=this.GetLinkDef();var ay=false;var aw=this.GetParentBusComp();if(av&&av.primeIdFieldName&&aw&&!(aw.GetDefn().Fields[(av.primeIdFieldName)].ReadOnly)){aw.CanUpdateField(av.primeIdFieldName);$.callback(this,function(az){if(az.retVal){aw.FieldValue(av.primeIdFieldName);$.callback(this,function(aB){var aA=aB.retVal;if(!aA){ay=true}at.call(this)})}else{at.call(this)}})}else{at.call(this)}})};al.prototype.GetWorkSetSize=function(){return this.GetWSSize()};al.prototype.DeleteWorkSet=function(at){var ap="";var aq=this.GetWS().length;if(aq===0){return}else{if(at!==aq){var ar=this.GetWS().splice(at,1);ap=ar[0]}}this.NotifyDeleteWorkSet(at,1,ap)};function s(aC){var ar=this.GetParentBusComp();if(ar){var aE="OnAddAssociation:"+ar.GetName();if(this.GetUserProperty(aE)){}aE="OnAddAssocUpdateParent:"+ar.GetName();if(this.GetUserProperty(aE)){}}var aI=aC.Id;var aw=this.GetWorkSetSize();var at;for(var aF=0;aF<aw;aF++){at=this.FindWorkSet(aF);if(at){if(aI===at.Id){$.setReturnValue({err:true});return}}}this.SetBCTableInsertState(D.get("INSMODE_ASSOCONLY"));var aM=this.GetLinkDef();var ax=aM.interTableName;var aD=[];var aK=[];aD.push(SiebelApp.OfflineUtils.RemoveNonAlphaChars(aM.interParentColName));aD.push(SiebelApp.OfflineUtils.RemoveNonAlphaChars(aM.interChildColName));aK.push((this.GetExtObjProp("m_pCurLinkQueryDef").Data.srcFieldValue));aK.push(aI);aD.push(SiebelApp.OfflineUtils.RemoveNonAlphaChars(B.get("SWE_ROW_ID_FIELD")));var aH=X.call(this,aK[0],aI);aK.push(aH);var aJ=this.GetDefn().Fields;var aA=0;var ap=[];var au=[];var ay={};ay.fieldList=[];ay.fieldVal=[];for(var aL in aJ){var az=aJ[aL].ColName;if(aJ[aL].Join&&aJ[aL].JoinInfo.JoinType==="X"){if(I.DoesFieldExist(ax,az)){var aG=aJ[aL].PreDefault;if(aG){aD.push(az);au.push(aL);aA++}}}}if(aA>0){var av=this.GetName();var aq=function(aN){return[av,au[aN],true]};ay.fieldList=au;var aB=function(aN){ap.push(aN.retVal);aK.push(aN.retVal)};$.eachAsyncOp(this,{execute:this.GetDefaultValue,executeScope:this,postExecute:aB,preExecute:aq,iterations:aA})}$.callback(this,function(){ay.fieldVal=ap;var aN=SiebelApp.SqlBuilder.InsertRecord(ax,aD,aK);this.SetInsertStatement(aN);this.SetOpType(D.get("ADDRECORD"));this.SyncQRec(aI);k.CcfLogEvent([J,34,0,52,"interTable: ",ax,aN.insertquery]);$.callback(this,function(aO){var aP=aO.retVal;this.SetNewTxn(aP);this.WriteRecord();$.callback(this,function(){$.setReturnValue({err:false,retVal:ay})})})})}function X(at,ar){var aq,ap;if(at<ar){aq=at;ap=ar}else{aq=ar;ap=at}return(aq+"."+ap)}al.prototype.OnAddAssociation=function(){};al.prototype.OnAddChildAssociation=function(){};al.prototype.DisableNotifySys=function(){if(!(this.IsNotifySysEnabled())){return}this.NotifyDeleteWorkSet(0,-1);this.DisableNotify();this.SetNotifySysEnabled(false)};al.prototype.NotifyGeneric=function(at,ar){var au;if(this.IsNotifyEnabled()){var aw=this.GetNotifyInfoArray();var ap=aw.length;for(var aq=0;aq<ap;aq++){au=aw[aq];if(au){var av=au.GetBusCompNotify();if(av){av.NotifyGeneric(at,ar)}}}}};al.prototype.NotifyExecute=function(aq,ap){};al.prototype.GetNumSelected=function(at){var aq=this.GetMultiSelectMode();var ar=this.GetSelRowIdArray();if(!this.GetMultiSelectMode()){at=1}else{if(!this.GetInverseSelection()){at=ar.length}else{var ap;ap=this.GetNumRows();at=ap-ar.length;return at}}return at};al.prototype.CheckActivation=function(){var at=false;var ax=this.GetActivatedFieldList();var ap=this.GetSavedFieldArray();var aw=ap.length;var av;var aq=ax.length;for(var au=0;au<aq;au++){av=this.GetFieldDefn(ax[au]);if(!at&&av&&!(ao.IsTrue(av.IsCalculated))){for(var ar=0;ar<aw;ar++){if(ax[au]===ap[ar]){break}}if(ax[au]===ap[au]){continue}at=true}}return at};al.prototype.SaveFieldArray=function(){var ap=this.GetActivatedFieldList().splice(0);this.SetSavedFieldArray(ap)};al.prototype.SaveCanMethodStates=function(av){var aC;var aB;var ay;var ax;var ap;var au;var at;var ar;var aA;var aq;var az=this.IsActiveFieldListDirty();var aw=this.GetBCState();if(av===ad){return}if(av===aa){aC=az;if(aC!==aw.m_bActiveFieldListDirty){if(this.NotifyStateChanged("bActiveFieldListDirty",aC)){aw.m_bActiveFieldListDirty=aC}}}if(av===aa){aB=this.CanAssociate();if(aB!==aw.m_bCanAssociate){if(this.NotifyStateChanged("bCanAssociate",aB)){aw.m_bCanAssociate=aB}}}if(av===aa||av==="SAVE_BC_STATE_CANDELETE"){this.CanDelete();$.callback(this,function(aD){ay=aD.retVal;if(ay!==aw.m_bCanDelete){if(this.NotifyStateChanged("bCanDelete",ay)){aw.m_bCanDelete=ay}}})}$.callback(this,function(){if(av===aa){ax=this.CanInsert(false);ap=this.CanInsert(true);if(ax!==aw.m_bCanInsert){if(this.NotifyStateChanged("bCanInsert",ax)){aw.m_bCanInsert=ax}}if(ap!==aw.m_bCanInsertDynamic){if(this.NotifyStateChanged("bCanInsertDynamic",ap)){aw.m_bCanInsertDynamic=ap}}}if(av===aa){au=this.CanMergeRecords();if(au!==aw.m_bCanMergeRecords){if(this.NotifyStateChanged("bCanMergeRecords",au)){aw.m_bCanMergeRecords=au}}}if(av===aa){at=this.CanQuery();if(at!==aw.m_bCanQuery){if(this.NotifyStateChanged("bCanQuery",at)){aw.m_bCanQuery=at}}}if(av===aa){this.CanUpdateX(false);$.callback(this,function(aD){ar=aD.retVal;this.CanUpdateX(true);$.callback(this,function(aE){aA=aE.retVal;if(ar!==aw.m_bCanUpdate){if(this.NotifyStateChanged("bCanUpdate",ar)){aw.m_bCanUpdate=ar}}if(aA!==aw.m_bCanUpdateDynamic){if(aA){aA=1}else{aA=0}if(this.NotifyStateChanged("bCanUpdateDynamic",aA)){aw.m_bCanUpdateDynamic=aA}}})})}$.callback(this,function(){if(av===aa){aq=this.HasAssocList();if(aq!==aw.m_bHasAssocList){if(this.NotifyStateChanged("bHasAssocList",aq)){aw.m_bHasAssocList=aq}}}this.SetBCState(aw)})})};al.prototype.HasPickList=function(ar){var aq=this.GetFieldDefn(ar);var ap=false;
if(aq&&!ao.IsEmpty(aq.PickListName)){ap=true}return ap};al.prototype.IsPickAssocField=function(){};al.prototype.GetNextTokenConst=function(aw){var at=0;var av;var ar=0;var ap=0;var au={};au.token="";au.next="";if(ao.IsEmpty(aw)){return au}var aq=aw.charAt(0);while(aq===" "||aq=="\t"||aq=="\n"){aw=aw.substring(1);aq=aw.charAt(0)}aq=aw.charAt(ar);if(aq=='"'||aq=="'"){av=aq;aq=aw.charAt(++ar);while((aq!=av||aw.charAt(ar+1)==av)&&aq!="\0"){if(aq==av&&aw.charAt(ar+1)==av){aq=aw.charAt(++ar)}aq=aw.charAt(++ar)}aq=aw.charAt(ar);if(aq==av){ar++}}else{aq=aw.charAt(ar++);ap=aw.length;while(aq!=" "&&aq!="\t"&&aq!="\n"&&aq!="\0"&&ar<ap){aq=aw.charAt(ar++)}}au.token=aw.substring(at,ar-at);au.next=aw.substring(ar);return au};function v(ap,ay,av){var au;var aq;var ar="";var az=this.IsOnFieldUpdDisabled();var aD=this.GetOnUpdSrcFldArray();var aw=this.GetOnUpdConditionArray();var aE=this.GetOnUpdExprArray();var aA=this.GetOnUpdDstFldArray();if(az||this.LoadOnFieldUpdateSet(ap)!==true||(aq=aD.length)===0){return}var aB=[];var at=[];for(au=0;au<aq;au++){if(ap!==aD[au]){continue}if(aw.length>au&&aw[au]){ar=SiebelApp.Query.Evaluate(aw[au].m_pQuery.ast,this)}ar=SiebelApp.Query.Evaluate(aE[au].m_pQuery.ast,this);aB.push(aA[au]);at.push(ar)}var aC=0;var ax=function(){this.SetFieldValueX(aB[aC],at[aC]);$.callback(this,function(){aC++;if(aC<at.length){ax.call(this)}})};if(aC<at.length){ax.call(this)}}al.prototype.LoadUserPropN=function(az,av,aB,aA,ay,aw){var au;var ar;var ap;var ax;var aq;var at=null;ap=az;for(au=0,ar=0;au<100;au++,ar++){if(au>0){ap=az+" "+au}ax=this.GetUserProperty(ap);if(ao.IsEmpty(ax)){if((au===0)||(av.length&&(ar<10))){continue}else{break}}ar=0;if(!aB){av.push(ax)}else{at=ax;var aC=this.GetNextTokenConst(at);at=aC.next;aq=aC.token;aq=k.StripQuotes(aq);av.push(aq);aC=this.GetNextTokenConst(at);at=aC.next;aq=aC.token;aC=this.GetNextTokenConst(at);at=aC.next;aq=aC.token;aq=k.StripQuotes(aq);aB.push(aq);if(aA){if(aw){if(at.charAt(0)===","){aw.push("Y")}else{aw.push("N")}}aC=this.GetNextTokenConst(at);at=aC.next;aq=aC.token;aC=this.GetNextTokenConst(at);at=aC.next;aq=aC.token;aq=k.StripQuotes(aq);aA.push(aq)}if(ay){aC=this.GetNextTokenConst(at);at=aC.next;aq=aC.token;aC=this.GetNextTokenConst(at);at=aC.next;aq=aC.token;aq=k.StripQuotes(aq);ay.push(aq)}}}};al.prototype.LoadOnFieldUpdateSet=function(at){var aF;var aG;var aq;var ap;var au;var aE;var aC;var aw;var ar;var aA=[];var ay=[];var aI=[];var aB=[];var av=[];var aD=this.GetOnUpdSrcFldArray();var aJ=this.GetOnUpdDstFldArray();var ax=this.GetOnUpdExprArray();var aH=null;var az=this.GetOnUpdConditionArray();if(!this.IsLoadOnFldUpdSet()){this.SetLoadOnFldUpd(true);this.LoadUserPropN("On Field Update Set",aA,ay,aI,aB,av);aG=aA.length;for(aF=0;aF<aG;aF++){aq=aA[aF];ap=ay[aF];if(ao.IsEmpty(aq)||ao.IsEmpty(ap)){continue}aE=this.GetFieldDefn(aq);aC=this.GetFieldDefn(ap);if((aq!==ap)&&aE&&aC){au=null;if(ao.IsEmpty(aI[aF])){if(ao.IsEmpty(aB[aF])&&(av[aF]==="Y")){aI[aF]="["+aq+"]"}else{aI[aF]='"'+aI[aF]+'"'}}au={};au.m_expr=aI[aF];aD.push(aq);aJ.push(ap);ax.push(au);if(!ao.IsEmpty(aB[aF])){au={};au.m_expr=aB[aF];az.push(au)}else{az.push(null)}}}}aG=aD.length;for(aF=0;aF<aG;aF++){if(at===aD[aF]){au=null;au=ax[aF];if((au!=null)&&(au.m_pQuery==null)){aw={};aw.m_pSqlObj=aH;aw.ast=SiebelApp.Query.Parse(au.m_expr);au.m_pQuery=aw;aw=null}au=az[aF];if((au!=null)&&(au.m_pQuery==null)){ar={};ar.m_pSqlObj=aH;ar.ast=SiebelApp.Query.Parse(au.m_expr);au.m_pQuery=ar;ar=null}}}return true};al.prototype.ValidatePickValue=function(ar,av){if(!this.HasPickList(ar)){$.setReturnValue({err:"",retVal:false});return}var aC;var aI;var aF="";var az;var ay;var at=null;var aG=null;var aw=null;var aE=[];var aJ=null;ay=this.GetFieldDefn(ar);az=ay.PickListName;aG=SiebelApp.S_App.Model.GetPickListDef(az);if(!(aG)){$.setReturnValue({err:"",retVal:false});return}aI=aG.IsBounded;var aH=ay.pickMap;var ax=aH?aH.length:0;var aD=aG.NoInsert;var aA=z.call(this,aG,aH);if(!aI){$.setReturnValue({err:"",retVal:false});return}var au;if(aA||aD){var ap=SiebelApp.Metadata.GetBusCompDef(aG.BC);au=ay&&av&&
/*!pPickListDef->m_bLongList &&*/
aG.TypeFld&&aG.LOVType&&aG.NoInsert&&(ap.TableName===D.get("LIST_OF_VAL_TABLE"))}if(au){var aw;var aq;for(var aB=0;aB<ax;aB++){aw=aH[aB];if(aw.FldName===ar){aq=aw.PFldName;break}}for(aB=0;aB<ax;aB++){aw=aH[aB];if((aw.FldName!==ar)&&aw.PFldName&&(aq!==aw.PFldName)){au=false;break}}}if(au){I.GetPickListData(aG,this,ar);$.callback(this,function(aP){var aN=aP.retVal;var aK=aN.length;var aO;var aM=false;for(var aL=0;aL<aK;aL++){aO=aN[aL];if(av===aO){aM=true;break}}if(aM){this.SetFieldValueX(ar,av,true);aN=null;$.callback(this,function(aQ){if(aQ.err){$.setReturnValue(aQ)}else{$.setReturnValue({err:false,retVal:true})}})}else{aE.push(az);aE.push(ar);aE.push(this.GetName());SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrBoundedPick",aE,"","","",0,80);$.setReturnValue({err:"SSAOMErrBoundedPick",retVal:false})}})}else{this.GetPickList(ar);$.callback(this,function(aL){if(aL.err){$.setReturnValue(aL)}else{at=aL.retVal;if(!at){$.setReturnValue({err:"",retVal:false});return}aC=this.CheckSpecialPickValue(ar,av);if(aC){$.setReturnValue({err:"",retVal:false});at=null;return}if(ay.pickMap.length===0){SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrPickMapEmpty",aE,"","","",0,80);$.setReturnValue({err:"SSAOMErrPickMapEmpty",retVal:false});at=null;return}if(!ao.IsEmpty(av)){var aK=ay.pickMap.length;for(var aM=0;aM<aK;aM++){aw=ay.pickMap[aM];if(aw.IsConstrained){continue}if(aw.FldName===ar){aF=aw.PFldName;break}}at.SetFldSearchSpec(aF,av);at.Execute();$.callback(this,function(aN){if(aN.err){aE.push(az);aE.push(ar);aE.push(this.GetName());SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrBoundedPick",aE,"","","",0,80);$.setReturnValue({err:"SSAOMErrBoundedPick",retVal:false});at=null;return}else{at.Home();$.callback(this,function(aO){if(!aO.err&&at.GetActiveRow()>-1&&at.GetWS().length===1){at.PickCurrentRow();$.callback(this,function(aP){if(!aP.err){$.setReturnValue({err:false,retVal:true})}else{$.setReturnValue({err:true,retVal:false})}})}else{aE.push(az);aE.push(ar);aE.push(this.GetName());SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrBoundedPick",aE,"","","",0,80);$.setReturnValue({err:"SSAOMErrBoundedPick",retVal:false})}})}})}else{at.PickNoRow(this,ay);$.callback(this,function(aN){if(!aN.err){$.setReturnValue({err:"",retVal:true});return}else{$.setReturnValue(aN)}})}}})}};function z(au,at){var ar=false;if(!au){return ar}ar=au.IsStatic;if(ar){var ap=at.length;var aq;for(var av=0;av<ap;av++){aq=at[av];if(aq.IsConstrained){ar=false;break}}}return ar}al.prototype.CheckSpecialPickValue=function(ap,aq){return false};al.prototype.GetPickList=function(aB,aA){var au=false;var av;var ar="";var az=function(){var aD=false;if(!ar){aD=true;return}ar.SetMasterBC(this);var aK=ao.IsTrue(ap.TransPickList);if(aK&&!ao.IsEmpty(ar.GetDefn().LanguageField)){ar.SetFldSearchSpec(ar.GetDefn().LanguageField,SiebelApp.S_App.Model.GetLanguage())}ar.DeactivateFields();
var aI=ax?ax.length:0;var aH;var aJ=0;for(var aG=0;aG<aI;aG++){aH=ax[aG];if(aH.IsConstrained){aJ++}ar.ActivateField(aH.PFldName)}ar.SetSearchSpec("");var aC=at.SrchSpec;var aM;var aF;if(aJ>0){var aI=ax.length;var aE=0;if(aC){aC="("+aC+")"}aF=function(){aH=ax[aE];if(!aH.IsConstrained){aE++;if(aE<aI){aF.call(this)}}else{aM=function(aN){if(!aN.err){fieldData=aN.retVal;if(!ao.IsEmpty(fieldData)){if(aC){aC=aC+" AND (["+aH.PFldName+'] = "'+fieldData+'")'}else{aC="(["+aH.PFldName+'] ="'+fieldData+'")'}}}aE++;if(aE<aI){aF.call(this)}};this.FieldValue(aH.FldName);$.callback(this,aM)}};if(aE<aI){aF.call(this)}}var aL=function(){ar.SetSearchSpec(aC);ar.SetExecuted(false);aD=false;aF=null;aM=null};if(aJ>0){$.callback(this,aL)}else{aL.call(this)}};var aw=function(){az=null;$.setReturnValue({err:au,retVal:ar})};if(this.ValidateFieldDef(aB)){var ap=this.GetFieldDefn(aB);if(ap){var ay=ap.PickListName;var ax=ap.pickMap;if(!ay){az.call(this)}else{var at=SiebelApp.S_App.Model.GetPickListDef(ay);if(!at){av=[];au="SSASqlErrPickNotFound";av.push(pPickListName);SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSASqlErrPickNotFound",errParamArray,"","","",0,81);aw.call(this);return}else{var aq=SiebelApp.S_App.Model.GetBusObj(this.GetBusObj().GetName());var ar=aq.GetBusCompX(at.BC);if(ar===null){au="SSAOMErrGetPickListBusComp";av=[];av.push(at.BC);av.push(aB);av.push(this.GetName());SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("SSAOMErrGetPickListBusComp",errParamArray,"","","",0,81);aw.call(this)}else{ar.SetPickSrcField(aB);ar.SetSrcIdFld(aB,this);az.call(this);$.callback(this,aw)}}}}else{au=true;aw.call(this)}}else{au=true;aw.call(this)}};al.prototype.SetSrcIdFld=function(ap,ar){var at=ar.GetFieldDefn(ap).pickMap;for(var aq=0;aq<at.length;aq++){if(at[aq].PFldName===B.get("SWE_ROW_ID_FIELD")){this.SetPickSrcIdFName(at[aq].FldName);break}}};al.prototype.PickNoRow=function(au,at){var av=[];av=at.pickMap;var ap=av.length;var ar=0;var aq=function(){if(!ao.IsTrue(av[ar].IsConstrained)){au.SetFieldValueX(av[ar].FldName,"",true)}$.callback(this,function(aw){if(!aw.err){ar++;if(ar<ap){aq.call(this)}else{$.setReturnValue({err:true,retVal:false});return}}})};if(ap){aq.call(this)}};al.prototype.SaveBusCompStates=function(au){var aD;var ap;var at=false;var aA=this.GetActiveRow();var aB;var aC;var ar;var aq;var av=this.GetBCState();var ay;var az=this.GetSelRowIdArray();if(au===ad){return}if(au===aa||au==="SAVE_BC_STATE_ROWNUMINFO"){if(!this.GetRowNum(ay,this.GetActiveRow())){aA=-1}if(aA!==av.m_curRowNum){if(this.NotifyStateChanged("curRowNum",aA)){av.m_curRowNum=aA}}aB=this.GetNumRows(aB);aD=(aB>-1)?1:0;if(aD!==av.m_bNumRowsKnown){if(this.NotifyStateChanged("bNumRowsKnown",aD)){av.m_bNumRowsKnown=aD}}if(aB!==av.m_numRows){if(this.NotifyStateChanged("numRows",aB)){av.m_numRows=aB}}}if(au===aa||au==="SAVE_BC_STATE_SELINFO"){aC=this.GetNumSelected(aC);ap=(!isNaN(aC))?1:0;if(ap!==av.m_bNumSelectedKnown){if(this.NotifyStateChanged("bNumSelectedKnown",ap)){av.m_bNumSelectedKnown=ap}}if(aC!==av.m_numSelected){if(this.NotifyStateChanged("numSelected",aC)){av.m_numSelected=aC}}ar=az.length;av.m_selRowIdArray=[];aq=av.m_selRowIdArray.length;if(ar===aq){for(var ax=0;ax<ar;ax++){if(az[ax]!==av.m_selRowIdArray[ax]){break}}at=(ax===ar)?true:false}if(!at){av.m_selRowIdArray=[];this.NotifyNewSelIds();for(var aw=0;aw<ar;aw++){av.m_selRowIdArray.push(az[aw])}}}this.SetBCState(av)};al.prototype.WSGetBegRow=function(ap,aq){var at=this.GetNotifyInfoArray();var ar=at[ap];if(ar){return(ar.GetBegRow(aq))}return};al.prototype.BeginQuery=function(ap){this.SetInQueryState(true);this.NotifyBeginQuery()};function ab(ap){if(ap.length<2){return"0"+ap}else{return ap}}al.prototype.DoBldQueryText=function(ap,au){var aL=null;var az;if(!(ap&&au)){return aL}if((this.GetFieldDefn(ap.GetFieldName()).DataType==="10"||this.GetFieldDefn(ap.GetFieldName()).DataType==="13"||this.GetFieldDefn(ap.GetFieldName()).DataType==="12")){if(au.length>=8){var aG;var aJ="";var aF="";var av="";var aq=false;var aC=ao.IsEmpty(ap.GetDisplayFormat())?SiebelApp.S_App.LocaleObject.GetDateFormat().toUpperCase():ap.GetDisplayFormat().toUpperCase();aC=aC.indexOf(" ")===-1?aC:aC.slice(0,aC.indexOf(" "));switch(aC){case"M/D/YYYY":aG=au.split("/");if(aG.length!==3){aq=true;break}aJ=ab(aG[0]);aF=ab(aG[1]);av=aG[2];au=av+aJ+aF;break;case"DD/MM/YYYY":aG=au.split("/");if(aG.length!==3){aq=true;break}aF=ab(aG[0]);aJ=ab(aG[1]);av=aG[2];au=av+aJ+aF;break;case"YYYY/M/D":aG=au.split("/");if(aG.length!==3){aq=true;break}av=aG[0];aJ=ab(aG[1]);aF=ab(aG[2]);au=av+aJ+aF;break;case"D.M.YYYY":aG=au.split(".");if(aG.length!==3){aq=true;break}aF=ab(aG[0]);aJ=ab(aG[1]);av=aG[2];au=av+aJ+aF;break;case"DD-MM-YYYY":aG=au.split("-");if(aG.length!==3){aq=true;break}aF=ab(aG[0]);aJ=ab(aG[1]);av=aG[2];au=av+aJ+aF;break;case"DD.MM.YYYY":aG=au.split(".");if(aG.length!==3){aq=true;break}aF=ab(aG[0]);aJ=ab(aG[1]);av=aG[2];au=av+aJ+aF;break;case"D/M/YYYY":aG=au.split("/");if(aG.length!==3){aq=true;break}aF=ab(aG[0]);aJ=ab(aG[1]);av=aG[2];au=av+aJ+aF;break;case"D/MM/YYYY":aG=au.split("/");if(aG.length!==3){aq=true;break}aF=ab(aG[0]);aJ=ab(aG[1]);av=aG[2];au=av+aJ+aF;break;case"YYYY/MM/DD":aG=au.split("/");if(aG.length!==3){aq=true;break}av=ab(aG[0]);aJ=ab(aG[1]);aF=aG[2];au=av+aJ+aF;break;case"YYYY-MM-DD":aG=au.split("-");if(aG.length!==3){aq=true;break}av=ab(aG[0]);aJ=ab(aG[1]);aF=aG[2];au=av+aJ+aF;break;case"D-M-YYYY":aG=au.split("-");if(aG.length!==3){aq=true;break}aF=ab(aG[0]);aJ=ab(aG[1]);av=aG[2];au=av+aJ+aF;break;case"MM/DD/YYYY":aG=au.split("/");if(aG.length!==3){aq=true;break}aJ=ab(aG[0]);aF=ab(aG[1]);av=aG[2];au=av+aJ+aF;break}if(aq){k.CcfLogEvent([J,14,0,82]);az="["+ap.GetName()+"]="+au}var aH=new Date(au.substring(0,4),au.substring(4,6)-1,au.substring(6,8));var aI=new Date();var ay=aI.getTimezoneOffset();if(this.GetFieldDefn(ap.GetFieldName()).DataType==="13"){var aM=new Date(aH.getFullYear(),aH.getMonth(),aH.getDate());aM.setMinutes(aM.getMinutes()+ay);var aK=new Date(aM.getFullYear(),aM.getMonth(),aM.getDate(),aM.getHours(),aM.getMinutes());aK.setHours(aK.getHours()+24);var aB=aM.getDate()<10?"0"+aM.getDate():""+aM.getDate();var at=aM.getHours()<10?"0"+aM.getHours():""+aM.getHours();var aE=aM.getMonth()+1;aE=aE<10?"0"+aE:""+aE;var aA=aK.getDate()<10?"0"+aK.getDate():""+aK.getDate();var ar=aK.getHours()<10?"0"+aK.getHours():""+aK.getHours();var aD=aK.getMonth()+1;aD=aD<10?"0"+aD:""+aD;var ax=aM.getFullYear()+""+aE+""+aB+""+at;var aw=aK.getFullYear()+""+aD+""+aA+""+ar;az="["+ap.GetName()+'] >= "'+ax+'" && ['+ap.GetName()+'] <= "'+aw+'"'}else{az="["+ap.GetName()+"]="+au}}else{k.CcfLogEvent([J,14,0,82]);az="["+ap.GetName()+"]="+au}return az}if(au.indexOf("%")!==-1){au=au.replace(/\%/g,"[%]")}if(au.indexOf("_")!==-1){au=au.replace(/\_/g,"[_]")}if(au.indexOf("?")!==-1){au=au.replace(/\?/g,"_")}if(au.indexOf("*")!==-1){au=au.replace(/\*/g,"%")}else{if(au.indexOf("_")===-1){au=au.concat("%")}}aL=g+' "'+au+'"';az="[";az+=ap.GetFieldName();az+="]";az+=" "+aL;return az};al.prototype.NotifyBeginQuery=function(){var ar;
if(this.IsNotifyEnabled()){var au=this.GetNotifyInfoArray();var ap=au.length;for(var aq=0;aq<ap;aq++){ar=au[aq];if(ar){var at=ar.GetBusCompNotify();if(at){at.NotifyBeginQuery()}}}}};al.prototype.SetInQueryState=function(ap){if(SiebelApp.OfflineAppSettings.GetMode()===true){if(this.IsInQueryState()!==ap){this.NotifyStateChanged("bInQueryState",ap)}return(j.SetInQueryState.call(this))}};al.prototype.SqlDeleteRecord=function(at){if(this.IsVBC()){retObj=({err:false})}else{var ap=SiebelApp.OfflineUtils.RemoveNonAlphaChars(this.GetName());var aq=[];var ax=[];var av=this.GetLinkDef();if(av&&!ao.IsEmpty(av.interTableName)){var ay=this.GetParentBusComp();var aw=ay.GetActiveRow();var au=ay.FindWorkSet(aw);ap=av.interTableName;aq.push(av.interParentColName);aq.push(av.interChildColName);ax.push(au[av.srcFieldName]);ax.push(at[av.destFieldName])}else{aq.push("Id");ax.push(at.Id)}var ar=SiebelApp.SqlBuilder.DeleteRecords(ap,aq,"AND");SiebelApp.BrowserCacheMgr.Execute(ar,ax)}$.callback(this,function(az){$.setReturnValue(az)})};al.prototype.DeleteRecordX=function(aw,av){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.DeleteRecordX")}if(SiebelApp.OfflineAppSettings.GetMode()!==true){return}var au;var ar={};var at=[];var aq=CCFMiscUtil_CreatePropSet();ar[N]=this.GetName();ar[u]=A;ar[R]="DeleteRecord";ar[f]=this;var ap=ao.IsEmpty(av)?true:av;ar[an]=a;SiebelApp.S_App.Model.InvokeRegisteredSvc(ar,aq);$.callback(this,function(aB){if(!aB.err){au=aB.retVal;if(au.Outputargs&&(au.Outputargs).GetProperty("Invoked")&&(au.Outputargs).GetProperty("Invoked").toString()==="true"){var ay=(au.Outputargs).GetProperty("RetVal");if(ay){$.setReturnValue({err:err,retVal:ay})}else{$.setReturnValue({err:err,retVal:""})}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.DeleteRecordX")}return}if(au&&au.Outputargs){(au.Outputargs).SetType(a);var ax=au.Outputargs.GetPropertyAsStr("bAddSyncQ");if(!ao.IsEmpty(ax)){ap=ax}}var aA=true;var aC="";if(!this.CanDeferDelete()){av=false}if(!this.IsExecuted()||!this.CheckActiveRow()||!this.CanDeleteX()){$.setReturnValue({err:true})}if(this.IsDeleteRecordPending()){}this.NotifyDeleteRecord(true,aA);var az=e.call(this);aC=this.FindWorkSet(az);if(av){}else{if(this.IsNewRecordPending()){this.PostDeleteRecord(aw,av)}else{this.SqlDeleteRecord(aC);$.callback(this,function(aE){if(aE.err){$.setReturnValue(aE)}else{if(this.IsVBC()){this.PostDeleteRecord(aw,av);ar[an]=r;aq.SetProperty("Record",JSON.stringify(aC));SiebelApp.S_App.Model.InvokeRegisteredSvc(ar,aq);$.callback(this,function(aG){$.setReturnValue(aG)})}else{var aD=this.GetRecordCount();this.SetRecordCount(--aD);this.SetOpType(D.get("DELETERECORD"));var aF=this.FieldValue(B.get("SWE_ROW_ID_FIELD"),aC);$.callback(this,function(aG){if(aG.err){$.setreturnValue(aG);return}else{aF=aG.retVal;this.SetTxnId(k.GetTempId());this.SyncQRec(aF);$.callback(this,function(aH){var aI=aH.retVal;this.SetNewTxn(aI);if(ao.IsTrue(ap)){this.UpdateSync()}$.callback(this,function(){this.PostDeleteRecord(aw,av);ar[an]=r;aq.SetProperty("Record",JSON.stringify(aC));SiebelApp.S_App.Model.InvokeRegisteredSvc(ar,aq);$.callback(this,function(aJ){$.setReturnValue(aJ)})})})}})}}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.DeleteRecordX")}})}}}else{$.setReturnValue(aB)}})};al.prototype.ScrollWorkSetByNum=function(az,ax,ap){this.FinishRecord();var av=0;var ar=0;var aw=0;var aA=0;var aD=this.GetActiveRow();var au;var ay;var at;var aC=this.GetWS().length;var aq;var aB=this.GetNotifyInfoArray();if(az>=0){at=true}else{at=false}if(aA<aB.length){aq=aB[aA];if(aq){ay=aq.GetBegRow(ap);au=aq.GetSize();if(az>0){av=aC-(ay+au);ar=az-av}else{av=ay;ar=az+av}var aE=this.GetCursor();if(at){aE[0]=this.GetScrollCount()+this.GetWS().length-1;this.SetNextSet(false);this.SetPriorSet(true)}else{if(!at){aE=this.GetCursor();aE[0]=this.GetScrollCount();this.SetCursor(aE);this.SetPriorSet(false);this.SetNextSet(true)}}this.SetCursor(aE);this.ScrollWorkSet(ar,aw);$.callback(this,function(aH){if(aH.err){$.setReturnValue(aH)}else{var aI=aH.retVal;var aF=this.GetScrollCount();aF=aF+aI.actualScrolled;this.SetScrollCount(aF);if(aI.actualScrolled){if(az>0){if(av>az){ay=ay+az}else{ay=ay+av}}else{if(av>(-az)){ay=ay+az}else{ay=0}}aq.SetBegRow(ay,ap);this.DisableNotify();aD=aD-aI.actualScrolled;if(aD===this.GetActiveRow()){this.OnActiveRowChanged();this.EventChangeRecord()}else{var aG=false;this.SetActiveRow(aD);aG=true;if(aG){$.callback(this,function(aJ){this.EnableNotify();this.NotifyScrollData(at,aI.actualScrolled)})}else{this.NotifyScrollData(at,aI.actualScrolled)}}}else{aq.SetBegRow(((aC>aq.GetSize())?(aC-au):0),ap);aD=aC-1}aq.SetCurrRow(ay,ap)}})}}};al.prototype.NextSet=function(av,ap){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.NextSet")}var ay=0;var aq;var az=this.GetNotifyInfoArray();if(ay>=az.length){$.setReturnValue({err:true});return}aq=az[ay];if(aq){var aw=aq.GetBegRow(ap);var at=aq.GetSize();var aB=this.GetActiveRow();at=1;if(aw!==aB){aw=aB}var au=0;var aA=this.GetWS().length;var ax=aw+(2*at)-aA;if(ax<=0){ax=0;aB+=at-ax;var ar=false;if(aB>=0){this.SetActiveRow(aB);ar=true}var aC=function(){aw+=at-ax;aq.SetBegRow(aw,ap);aq.SetCurrRow(aw,ap);var aD={};aD.actualScrolled=au;$.setReturnValue({err:false,retVal:aD});return};if(ar){$.callback(this,function(){aC.call(this)})}else{aC.call(this)}}if(ax>0){this.ScrollWorkSet(ax,au);$.callback(this,function(aG){if(!aG.err){var aH=aG.retVal;var aE=this.GetScrollCount();aE=aE+aH.actualScrolled;this.SetScrollCount(aE);aw+=at-ax;aq.SetBegRow(aw,ap);aq.SetCurrRow(aw,ap);aB+=at-ax;var aF=function(){$.setReturnValue({err:false,retVal:aH});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.NextSet")}};var aD=false;if(aB>=0){if(aB!==this.GetActiveRow()){this.SetActiveRow(aB);aD=true;$.callback(this,function(){this.OnActiveRowChanged();this.EventChangeRecord();aF.call()})}else{this.UpdateLinks(false);$.callback(this,function(aI){if(!aI.err){}})}}else{aF.call(this)}}else{aq.SetBegRow(((aA>at)?(aA-at):0),ap);aB=aA-1;aq.SetCurrRow(aw,ap)}})}}};al.prototype.PriorSet=function(au,ap){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.PriorSet")}var ax=0;var aq;var ay=this.GetNotifyInfoArray();if(ax>=ay.length){$.setReturnValue({err:true});return}aq=ay[ax];if(aq){var av=aq.GetBegRow(ap);var ar=aq.GetSize();var aA=this.GetActiveRow();ar=1;if(av!==aA){av=aA}var at=0;var az=this.GetWS().length;var aw=av-ar;if(aw>=0){aw=0;av-=(ar-(-aw));aA-=(ar-(-aw));aq.SetCurrRow(av,ap);aq.SetBegRow(av,ap);if(aA!==this.GetActiveRow()){if(aA>=0){this.SetActiveRow(aA);$.callback(this,function(aB){$.setReturnValue(aB);if(aB.err){aq.SetBegRow((az>ar)?(az-ar):0,ap);aA=az-1;aq.SetCurrRow(av,ap)}});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.NextSet")}return}}}if(aw<0){this.ScrollWorkSet(aw,at);$.callback(this,function(aC){if(!aC.err){var aC=aC.retVal;
var aB=this.GetScrollCount();aB=aB+aC.actualScrolled;this.SetScrollCount(aB);av-=(ar-(-aw));aA-=(ar-(-aw));aq.SetCurrRow(av,ap);aq.SetBegRow(av,ap);if(aA!==this.GetActiveRow()){if(aA>=0){this.SetActiveRow(aA);$.callback(this,function(aD){$.setReturnValue(aD)})}}else{this.UpdateLinks(false)}}else{aq.SetBegRow(0,ap);aA=0;aq.SetBegRow((az>ar)?(az-ar):0,ap);aA=az-1;aq.SetCurrRow(av,ap)}if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.NextSet")}})}}};al.prototype.GetNextRecord=function(ar){var aw=this.GetCursor();var ay=this.GetQuerySearchSpec();var at=this.GetQuerySortSpec();var av=this.GetQueryFieldList();var ap=this.GetQueryOrder();aw[0]++;var ax=[];var aq=this.GetExtObjProp("m_pCurLinkQueryDef");ax.push(this.GetName());if(aq){if(!ao.IsEmpty(aq.Defn.interTableName)){ax.push(SiebelApp.OfflineUtils.RemoveNonAlphaChars(aq.Defn.interTableName))}}var au=SiebelApp.SqlBuilder.SelectRecordPopulateWS(ax,ay,av,at,ap,aw);SiebelApp.BrowserCacheMgr.SelectRecord(au);$.callback(this,function(aA){if(aA.err){$.setReturnValue({err:true});aw[0]--}else{var az=aA.retVal;if(!az){$.setReturnValue({err:true});aw[0]--}else{$.setReturnValue({err:false,retVal:az})}}})};al.prototype.GetPriorRecord=function(at){var az=this.GetCursor();var aA=this.GetQuerySearchSpec();var av=this.GetQuerySortSpec();var ax=this.GetQueryFieldList();var ap=this.GetQueryOrder();var au=this;var ar=this.GetRecordCount();if(az[0]<=0){$.setReturnValue({err:true});return}if(az[0]>=ar){az[0]=ar-1}az[0]--;var ay=[];var aq=this.GetExtObjProp("m_pCurLinkQueryDef");ay.push(au.GetName());if(aq){if(!ao.IsEmpty(aq.Defn.interTableName)){ay.push(SiebelApp.OfflineUtils.RemoveNonAlphaChars(aq.Defn.interTableName))}}var aw=SiebelApp.SqlBuilder.SelectRecordPopulateWS(ay,aA,ax,av,ap,az);SiebelApp.BrowserCacheMgr.SelectRecord(aw);$.callback(this,function(aC){if(aC.err){$.setReturnValue(aC);az[0]++}else{var aB=aC.retVal;if(!aB){$.setReturnValue({err:true});az[0]++}else{this.SetCursor(az);$.setReturnValue({err:false,retVal:aB})}}})};al.prototype.ScrollWorkSet=function(av,ap){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("BusComp.prototype.ScrollWorkSet")}if(av===0){$.setReturnValue({err:true});return}var at;var ax;var au;var ay=false,aw=0,aq;var ar;if(av>0){ax=this.GetWS().length;at=this.FindWorkSet(ax-1,at);if(!at){$.setReturnValue({err:true});return}ar=function(){var az=this.GetCursor();if(az[0]<0){az[0]=0;this.SetCursor(az)}this.GetNextRecord(at);$.callback(this,function(aA){aq=aA.err;at=aA.retVal;if(!at||aq){ay=true}else{this.InsertWorkSet(this.GetWS().length,at);ap++;this.DeleteWorkSet(0)}aw++;if(aw<av&&!ay){ar.call(this)}})};ar.call(this);$.callback(this,function(){var az={};az.actualScrolled=ap;$.setReturnValue({err:false,retVal:az})})}else{at=this.FindWorkSet(0,at);if(!at){$.setReturnValue({err:true});return}ar=function(){this.GetPriorRecord(at);$.callback(this,function(az){aq=az.err;at=az.retVal;if(!at||aq){ay=true}else{ap--;this.InsertWorkSet(0,at);this.DeleteWorkSet(this.GetWS().length-1)}aw++;if(aw<(-av)&&!ay){ar.call(this)}})};ar.call(this);$.callback(this,function(){var az={};az.actualScrolled=ap;$.setReturnValue({err:false,retVal:az});if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("BusComp.prototype.ScrollWorkSet")}})}};al.prototype.PostDeleteRecord=function(aq,az){var au=true;var av=e.call(this);this.DeleteWorkSet(av);var at=this.GetWorkSetSize();var ap=function(){if(this.GetWS().length===0){ag.call(this,-1)}else{if(av===-1){ag.call(this,0)}else{if(av===this.GetWS().length){ag.call(this,--av)}}}this.SetCommitPending(false);this.SetNewRecPending(false);this.SetDeleteRecordPending(false);this.NotifyDeleteRecord(false,au);this.UpdateLinks(false);$.callback(this,function(){this.OnActiveRowChanged()})};if(this.GetWS().length===(at-1)){if(at>0){var ay=this.GetCursor();var aw=ay[0];var ax=this.GetScrollCount();ay[0]=ax+this.GetWS().length-1;var ar;this.GetNextRecord();$.callback(this,function(aB){ar=aB.retVal;var aA=aB.err;if(!aA&&ar){this.InsertWorkSet(this.GetWS().length,ar)}else{if(aB.err||!ar){if(ax){ay[0]=ax;this.GetPriorRecord(ar);$.callback(this,function(aC){aA=aC.err;ar=aC.retVal;if(!ar||aA){}else{if(!aA&&ar){this.SetScrollCount(--ax);this.InsertWorkSet(0,ar)}}})}}}$.callback(this,function(aC){ap.call(this)})});$.callback(this,function(){ay[0]=aw;this.SetCursor(ay)})}}else{ap.call(this)}};al.prototype.GetCalcFields=function(){var ap;var ar=this.GetDefn().Fields;for(var aq in ar){if(ao.IsTrue(ar[aq].IsCalculated)){ap.push(ar[aq])}}};al.prototype.ClearToQuery=function(){this.SetSearchSpec("")};al.prototype.ActivateMultipleFields=function(aq,ap){if(aq){var ar=aq.EnumProperties(true);var at=[];while(!ao.IsEmpty(ar)){at.push(ar);ar=aq.EnumProperties(false)}if(ap){this.UpdateDeactivateableFldList(at)}this.ActivateFieldList(at)}};al.prototype.RefreshBusComp=function(){var aq=SiebelApp.S_App.Model.GetBusObj(this.GetBusObj().GetName());var ar=aq.GetBusCompX(this.GetName());var ap=ar.IsExecuted();if(ap){ar.Execute();$.callback(this,function(at){if(!at.err){ar.Home();$.callback(this,function(au){if(!au.err){this.NotifyExecute();this.NotifyNewData();$.setReturnValue({err:false,retVal:""});return}})}})}else{$.setReturnValue({err:false,retVal:""});return}};al.prototype.GetPicklistBusComp=function(ar){var aq=this.GetFieldDefn(ar);var ap=aq.PickListName;if(ap){aq=SiebelApp.S_App.Model.GetPickListDef(ap);if(aq){var at=SiebelApp.S_App.Model.GetBusObj(this.GetBusObj().GetName());var au=at.GetBusComp(aq.BC);au.SetMasterBC(this);au.SetPickSrcField(ar);au.SetSrcIdFld(ar,this);return au}else{return""}}else{return""}};al.prototype.RefreshRecord=function(){var ap=this.GetWS()[this.GetActiveRow()];this.FieldValue(B.get("SWE_ROW_ID_FIELD"),ap);$.callback(this,function(au){if(!au.err){var aq=au.retVal;if(aq){var at=SiebelApp.S_App.Model.GetBusObj(this.GetBusObj().GetName());var av=at.GetBusCompX(this.GetName());var ar;ar="[";ar+=B.get("SWE_ROW_ID_FIELD");ar+="] = ";ar+='"'+aq+'"';av.SetSearchSpec(ar);av.Execute();$.callback(this,function(aw){if(!aw.err){av.Home();$.callback(this,function(aB){if(!aB.err){var aA=av.FindWorkSet(0);if(!aA){$.setReturnValue({err:false,retVal:""});at.EndLife();at=null;av=null;return}var ax=av.GetActivatedFieldList();var az;for(var ay=0;ay<ax.length;ay++){var aC=ax[ay];ap[SiebelApp.OfflineUtils.RemoveNonAlphaChars(aC)]=aA[SiebelApp.OfflineUtils.RemoveNonAlphaChars(aC)]}$.setReturnValue({err:false,retVal:ap});W.ReleaseBO(at);av=null;return}})}})}}})};al.prototype.GetReqFieldsHasDefault=function(){var ar=this.GetDefn().Fields;var aq=[];for(var ap in ar){if((!ao.IsEmpty(ar[ap].PostDefault)||!ao.IsEmpty(ar[ap].PreDefault))){aq.push(ap)}}return aq};al.prototype.SetMultipleFieldValues=function(aq){if(aq){var au=aq.EnumProperties(true);var ap=[];var aw=[];while(!ao.IsEmpty(au)){ap.push(au);aw.push(aq.GetPropertyAsStr(au));au=aq.EnumProperties(false)}var av=ap.length;var at=0;var ar=function(){this.SetFieldValueX(ap[at],aw[at]);$.callback(this,function(ax){if(!ax.err){at++;
if(at<av){ar.call(this)}}else{$.setReturnValue(ax)}})};if(at<av){ar.call(this)}}};al.prototype.GetMultipleFieldValues=function(av,aq){if(av&&aq){var au=av.EnumProperties(true);var ap=[];while(!ao.IsEmpty(au)){ap.push(au);au=av.EnumProperties(false)}var aw=ap.length;var at=0;var ar=function(){this.FieldValue(ap[at]);$.callback(this,function(ax){if(!ax.err){aq.SetPropertyStr(ap[at],ax.retVal);at++;if(at<aw){ar.call(this)}}else{$.setReturnValue(ax)}})};if(at<aw){ar.call(this)}}};al.prototype.GetLastErrCode=function(){return b.OfflineErrorObject.GetErrorCode()};al.prototype.GetLastErrText=function(){return b.OfflineErrorObject.GetErrorText()}}());if(typeof(SiebelApp.S_App.OfflineBCInterface)==="undefined"){SiebelJS.Namespace("SiebelApp.S_App.OfflineBCInterface");SiebelApp.S_App.OfflineBCInterface=(function(){function a(f){var e=f;var c=this;var d={GetParentBusComp:1,GetBusObj:2};for(var b in f){(function(){var g=b;var h=f;if(typeof(f[g])==="function"&&!c[g]&&!d[g]){c[g]=function(){if(h.constructor.prototype[g]){return(h.constructor.prototype[g].apply(h,arguments))}else{return(h[g].apply(h,arguments))}}}return c[g]}())}this.GetOfflineBC=function(){return e};this.GetParentBusComp=function(){var g=e.GetParentBusComp();if(g){return g.GetInterface()}};this.GetBusObj=function(){var g=e.GetBusObj();if(g){return g.GetInterface()}};this.EndLife=function(){e=null;c=null;d=null}}a.prototype.SetFieldValue=function(f,e,c,d,b){return(this.GetOfflineBC().SetFieldValueX(f,e,c,d,b))};a.prototype.InvokeMethod=function(b,c){return(this.GetOfflineBC().InvokeMethodX(b,c))};a.prototype.CanInvokeMethod=function(b){return(this.GetOfflineBC().CanInvokeMethodX(b))};a.prototype.UpdateRecord=function(b){return(this.GetOfflineBC().UpdateRecordX(b))};a.prototype.CanUpdate=function(b,c){return(this.GetOfflineBC().CanUpdateX(b,c))};a.prototype.NewRecord=function(c,b,d){return(this.GetOfflineBC().NewRecordX(c,b,d))};a.prototype.GetIdValue=function(){return(this.GetOfflineBC().GetIdValueX())};a.prototype.WSNextRecord=function(){return(this.GetOfflineBC().WSNextRecordX())};a.prototype.WSHome=function(){return(this.GetOfflineBC().WSHomeX())};a.prototype.DeleteRecord=function(c,b){return(this.GetOfflineBC().DeleteRecordX(c,b))};a.prototype.Pick=function(){var b=this.GetOfflineBC().GetMasterBC();if(b){this.GetOfflineBC().PickCurrentRow()}else{$.setReturnValue({err:true})}};a.prototype.ActivateField=function(b){var c=this.GetOfflineBC();c.UpdateDeactivateableFldList([b]);return(c.ActivateField(b))};a.prototype.ActivateMultipleFields=function(b){return(this.GetOfflineBC().ActivateMultipleFields(b,true))};a.prototype.Associate=function(){return(this.GetOfflineBC().AddAssociation())};a.prototype.ExecuteQuery=function(){return(this.GetOfflineBC().Execute())};a.prototype.FirstRecord=function(){return(this.GetOfflineBC().Home())};a.prototype.GetAssocBusComp=function(){return(this.GetOfflineBC().GetAssocList())};a.prototype.GetFieldValue=function(c,b){return(this.GetOfflineBC().FieldValue(c,b))};a.prototype.GetSearchExpr=function(){return(this.GetOfflineBC().GetDefn().searchSpec)};a.prototype.Name=function(){return(this.GetOfflineBC().GetName())};a.prototype.BusObject=function(){return(this.GetOfflineBC().GetBusObj())};a.prototype.ParentBusComp=function(){return(this.GetOfflineBC().GetParentBusComp())};a.prototype.CountRecords=function(){return(this.GetOfflineBC().GetRecordCount())};a.prototype.SetSearchSpec=function(b,c){return(this.GetOfflineBC().SetFldSearchSpec(b,c))};a.prototype.GetSearchSpec=function(b){return(this.GetOfflineBC().GetFldSearchSpec(b))};return a}())}})};