/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2013 Oracle and/or its affiliates. All rights reserved.
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
if(typeof(SiebelAppFacade.JSTreeRenderer)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.JSTreeRenderer");define("siebel/jsTreeCtrl",[],function(){SiebelAppFacade.JSTreeRenderer=(function(){var g=SiebelJS.Dependency("SiebelApp.Constants");var e=g.get("SWE_SCREEN_NAV_CONTROL_STR");var f=g.get("SWE_AGGR_VIEW_NAV_CONTROL_STR");var b=g.get("SWE_DET_VIEW_NAV_CONTROL_STR");var c=g.get("SWE_DET_SUB_VIEW_NAV_CONTROL_STR");function a(l){var j=l;this.GetPM=function(){return j};var m={};this.GetDataSet=function(){return m};this.EmptyDataSet=function(){m={}};if(this.GetPM().Get("IsScreen")){this.GetPM().AttachPMBinding("Refresh",this.BindData,{scope:this})}this.GetPM().AttachPMBinding("FocusFirstTabElement",i,{scope:this});this.GetKey=function(){var o=g.get("SWE_PROP_NC_ID_SCREEN_CONTROL");var n=this.GetPM().Get("IsScreen")?"screenName":"viewName";this.GetKey=function(){return n};return n};var k=this;$(window).resize(function(){if(k.TreeLoaded){k.Refresh(true)}})}a.prototype.ShowUI=function(){var k=this.GetPM();var j=k.Get("GetType");var l=$("#"+j);SiebelJS.Log("[JSTreeRenderer] -> jqcontainer = "+l.length);if(j===g.get("SWE_PROP_NC_ID_VIEW_CONTROL")){if(($("div#"+g.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL"))).length!==0){j=g.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")}}k.SetProperty("LevelPlaceholder",j);d.call(this,l)};function d(m){var l=this;if(m.length===1){m.dynatree({autoCollapse:true,imagePath:" ",classNames:{nodeIcon:null},clickFolderMode:3,minExpandLevel:1,persist:false,expandOnAdd:true,onPostInit:function(o,n){this.reactivate()},onClick:function(q,p){var s;var n=l.GetPM();if(q&&q.getEventTargetType(p)==="title"&&q.data.key){var t;if(q.data.isFolder===true){if(l.GetDataSet()!==null){s=l.GetDataSet()[q.data.key];t=s[n.Get("IsScreen")?"defaultViewName":l.GetKey()];s.viewName=t;if(n.Get("GetType")===g.get("SWE_PROP_NC_ID_SCREEN_CONTROL")){s.level=e}else{s.level=b}}}else{var o=n.Get("GetSelectedTabKey");var r=null;if(o!==null&&o!==undefined){s=n.Get("GetTabInfo")[o]}t=s.links[q.data.key].viewName;s.viewName=t;if(n.Get("GetType")===g.get("SWE_PROP_NC_ID_SCREEN_CONTROL")){s.level=f}else{s.level=c}}if(!n.OnControlEvent("OnClick",s)){return false}return true}else{return false}}});var k=l.GetPM();var j=(k.Get("GetType")===g.get("SWE_PROP_NC_ID_SCREEN_CONTROL"))?"siebui-view-navs":"siebui-subview-navs";if(!m.hasClass(j)){m.addClass(j);m.addClass("clearfix-helper")}this.TreeLoaded=true}}a.prototype.BindEvents=function(){};a.prototype.BindData=function(){var k=this.GetPM();var r=k.Get("GetDataReload");var j=k.Get("GetTabInfo");var p=k.Get("GetSelectedTabLinkInfo");var q;var n;if(r){this.EmptyDataSet()}var m=this.GetDataSet();var l={};if(j!==null&&(r)){for(n in j){if(j.hasOwnProperty(n)){if(n.search("tabScreen")===-1){continue}q=j[n];m[q[this.GetKey()]]=q}}}var o=k.Get("GetSelectedTabKey");var u=null;if(o!==null&&o!==undefined&&j[o]!==undefined){u=j[o][this.GetKey()]}var s=false;if(p!==null&&m[u]!==undefined&&m[u].links===undefined){var t=false;for(n in p){if(p.hasOwnProperty(n)){if(n.search("tabView")===-1){continue}q=p[n];l[q.viewName]=q;t=true}}if(t){m[u].links=l;s=true}}if(r){s=true}this.Refresh(s)};a.prototype.Refresh=function(J){if(!J){return}var p=this.GetPM();if($("#"+p.Get("GetType")).dynatree("getRoot").length===0){return}$("#"+p.Get("GetType")).dynatree("getRoot").removeChildren();var l=p.Get("GetTabInfo")||{};if(!l.tabScreen0){return}var F=p.Get("GetSelectedTabLinkInfo")||{};var m=$("#"+p.Get("GetType")).dynatree("getRoot");var k;var v;var O;var y=true;if(p.Get("IsScreen")){k=m.addChild({title:"Screens",key:"AllScreens",addClass:"dynatree-root-tag",isFolder:true,expand:true,url:null})}else{k=m}var z=p.Get("GetSelectedTabKey");var R=null;R=(l[z]||l.tabScreen0)[this.GetKey()];R=String(R);var q=p.Get("GetSelectedLinkKey");var w=null;if(q!==null&&q!==undefined){w=F[q]?F[q].viewName:""}w=String(w);var o=($("#"+p.Get("GetType")).width())>($("#"+p.Get("GetType")).height())?1:0;var j=o?$("#"+p.Get("GetType")).width():$("#"+p.Get("GetType")).height();var n=45;var K=false;var C="j_"+p.Get("GetType");var D=(p.Get("IsScreen"))?"siebui-nav-screenlist":"siebui-nav-viewlist";var t='<select id="'+C+'" class="'+D+'"><option></option>';var Q=false;var N=(p.Get("GetTabInfo")[p.Get("GetSelectedTabKey")]||p.Get("GetTabInfo")["tabScreen0"]);var u=null;u=k.addChild({title:N.captionName,isFolder:true,url:N.captionName,icon:N.tabIcon,activate:(N.captionName===R),addClass:(N.captionName===R)?"screen-tab-selected":"screen-tab-deselected",expand:N.captionName===R,key:N});var B=$($(u)[0].li).outerWidth(true);n+=B;k.removeChildren();$("#"+C).remove();var x=0;var L=0;var P=this.GetDataSet();for(var S in P){if(P.hasOwnProperty(S)){if(!K){v=k.addChild({title:P[S].captionName,isFolder:true,url:P[S].captionName,icon:P[S].tabIcon,activate:(S===R),addClass:(S===R)?"screen-tab-selected":"screen-tab-deselected",expand:S===R,key:S});if(S===R){Q=true;n-=B}var G=this.GetDataSet()[S].links;for(O in G){if(G.hasOwnProperty(O)){if(y&&p.Get("LevelPlaceholder")===g.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")){d.call(this,$("#"+p.Get("LevelPlaceholder")));if($("#"+p.Get("LevelPlaceholder")).dynatree("getRoot").length===0){return}$("#"+p.Get("LevelPlaceholder")).dynatree("getRoot").removeChildren();v=$("#"+p.Get("LevelPlaceholder")).dynatree("getRoot");y=false}var E=v.addChild({title:G[O].captionName,isFolder:false,url:G[O].captionName,activate:O===w,addClass:(p.Get("LevelPlaceholder")===g.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")?((O===w)?"screen-tab-selected":"screen-tab-deselected"):((O===w)?"view-tab-selected":"view-tab-deselected")),key:O})}}var A=o?$($(v)[0].li).outerWidth(true):$($(v)[0].li).outerHeight(true);if((n+A)<=j){n+=A}else{if(o){K=true;v.remove();t+="<option value = "+(this.GetDataSet()[S].captionName)+">"+(this.GetDataSet()[S].captionName)+"</option>";L++}}}else{t+="<option value = "+(this.GetDataSet()[S].captionName)+">"+(this.GetDataSet()[S].captionName)+"</option>";L++}x++}}if(K){t+="</select>";$("#"+p.Get("GetType")).append(t);var r=this.GetDataSet()[R].captionName;$("#"+C).find("option").each(function(){if(String(r)===$(this).text()){$(this).remove()}})}if(!Q){var s=(p.Get("IsScreen"))?String(N.screenName):String(N.viewName);v=k.addChild({title:N.captionName,isFolder:true,url:N.captionName,icon:N.tabIcon,activate:(s===R),addClass:(s===R)?"screen-tab-selected":"screen-tab-deselected",expand:s===R,key:s});for(O in N.links){if(N.links.hasOwnProperty(O)){var H=v.addChild({title:N.links[O].captionName,isFolder:false,url:N.links[O].captionName,activate:O===w,key:O})}}}var I=this;$("#"+C).change(function(){var V=$("#"+C).find("option:selected").text();var T=I.GetDataSet();var W="";for(var U in T){if(T.hasOwnProperty(U)){if(V===String(T[U].captionName)){W=T[U].viewName;T[U]["level"]=b;if(!W){T[U]["viewName"]=T[U].defaultViewName}p.OnControlEvent("OnClick",T[U])}}}});var M={};M.comboContainer=C;M.chtotal=x;M.count=L;M.overflow=K;h.call(this,k,M)};function h(y,A){var p=this.GetPM();var r=p.Get("GetTabContainerQTPInfo");var k=p.Get("GetTabItemsQTPInfo");
var u=p.Get("IsScreen")?(p.Get("GetTabInfo")[p.Get("GetSelectedTabKey")]&&p.Get("GetTabInfo")[p.Get("GetSelectedTabKey")].screenName):(p.Get("GetTabInfo")[p.Get("GetSelectedTabKey")]&&p.Get("GetTabInfo")[p.Get("GetSelectedTabKey")].viewName);var x=p.Get("GetTabViewLinkContainerQTPInfo");var m=p.Get("GetTabViewLinkItemsQTPInfo");var q=g.get("SWE_PROP_QTP_OT");var w=g.get("SWE_PROP_QTP_RN");var v=g.get("SWE_PROP_QTP_UN");if(r&&(typeof(r.GetProperty)==="function")){y.ul.setAttribute("ot",r.GetProperty(q));y.ul.setAttribute("rn",r.GetProperty(w));y.ul.setAttribute("un",r.GetProperty(v))}for(var t=0;t<y.getChildren().length;t++){var l=y.getChildren()[t];if(k[t]&&(typeof(k[t].GetProperty)==="function")){l.li.setAttribute("ot",k[t].GetProperty(q));l.li.setAttribute("rn",k[t].GetProperty(w));l.li.setAttribute("un",k[t].GetProperty(v))}if((l.getChildren()!==null)&&(u===l.data.key)){if(x&&(typeof(x.GetProperty)==="function")){l.ul.setAttribute("ot",x.GetProperty(SiebelApp.Constants.get(q)));l.ul.setAttribute("rn",x.GetProperty(SiebelApp.Constants.get(w)));l.ul.setAttribute("un",x.GetProperty(SiebelApp.Constants.get(v)))}for(var s=0;s<l.getChildren().length;s++){var o=l.getChildren()[s];if(m[s]&&(typeof(m[s].GetProperty)==="function")){o.li.setAttribute("ot",m[s].GetProperty(q));o.li.setAttribute("rn",m[s].GetProperty(w));o.li.setAttribute("un",m[s].GetProperty(v))}}}}if(!A.overflow){return}var y=$("#"+A.comboContainer);var z=p.Get("GetJumpTabQTPInfo");var q=g.get("SWE_PROP_QTP_OT");var w=g.get("SWE_PROP_QTP_RN");var v=g.get("SWE_PROP_QTP_UN");var n=A.chtotal-A.count;if(z&&(typeof(z.GetProperty)==="function")){y.attr("ot",z.GetProperty(q));y.attr("rn",z.GetProperty(w));y.attr("un",z.GetProperty(v))}l=y.children("option");var s=1;for(t=n;t<A.chtotal&&l.length>0;t++){if(k[t]&&(typeof(k[t].GetProperty)==="function")){l.eq(s).attr("ot",k[t].GetProperty(q));l.eq(s).attr("rn",k[t].GetProperty(w));l.eq(s).attr("un",k[t].GetProperty(v));s++}}}function i(l){var k=g.get("SWE_PROP_NC_ID_SCREEN_CONTROL");var j=g.get("SWE_PROP_NC_ID_VIEW_CONTROL");switch(l){case e:if($("#"+k).dynatree("getRoot")){$("#"+k+" ul  li a").eq(1).focus()}else{$("#"+k+" ul  li a").eq(0).focus()}break;case b:$("#"+j+" ul  li a").eq(0).focus();break}}return a}());return"SiebelAppFacade.JSTreeRenderer"})};